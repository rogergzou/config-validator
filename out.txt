?   	github.com/GoogleCloudPlatform/config-validator	[no test files]
?   	github.com/GoogleCloudPlatform/config-validator/cmd/policy-tool	[no test files]
?   	github.com/GoogleCloudPlatform/config-validator/cmd/policy-tool/debug	[no test files]
?   	github.com/GoogleCloudPlatform/config-validator/cmd/policy-tool/lint	[no test files]
?   	github.com/GoogleCloudPlatform/config-validator/cmd/server	[no test files]
?   	github.com/GoogleCloudPlatform/config-validator/internal/fuzz	[no test files]
?   	github.com/GoogleCloudPlatform/config-validator/pkg/api/validator	[no test files]
=== RUN   TestTargetHandler
==========ARM GetName==========
========== newConstraintTemplate ==========
arm.policy.azure.com

package testconstraint

violation[{"msg": msg}] {
	input.parameters.kind == "VirtualMachine" 
    input.parameters.type == "Microsoft.Compute/virtualMachines"
	msg := input.parameters.msg
}

TESTING CONFIGURATION
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
=== RUN   TestTargetHandler/matching_constraints
==========TESTING: json Null match object (matches anything)==========
=== RUN   TestTargetHandler/matching_constraints/json_Null_match_object_(matches_anything)
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000893a40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000893a20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000893a60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000893a00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000893ee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000893ec0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000893f00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000893ea0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: asset Null match object (matches anything)==========
=== RUN   TestTargetHandler/matching_constraints/asset_Null_match_object_(matches_anything)
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00059d640 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00059d620 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00059d660 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00059d600 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00059dae0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00059dac0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00059db00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00059daa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: legacy spec match Null match object (matches anything)==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Null_match_object_(matches_anything)
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000380e60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000380e40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000380e80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000380e20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000381300 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0003812e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000381320 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0003812c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: json No match specified (matches anything)==========
=== RUN   TestTargetHandler/matching_constraints/json_No_match_specified_(matches_anything)
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070b060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070b040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070b080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070b020 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070b4e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070b4c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070b500 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070b4a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: asset No match specified (matches anything)==========
=== RUN   TestTargetHandler/matching_constraints/asset_No_match_specified_(matches_anything)
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008645a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000864580 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008645c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000864560 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000864a20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000864a00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000864a40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008649e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: legacy spec match No match specified (matches anything)==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_No_match_specified_(matches_anything)
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0aaa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0aa80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0aac0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0aa60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0af40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0af20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0af60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0af00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: json Only match once.==========
=== RUN   TestTargetHandler/matching_constraints/json_Only_match_once.
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00015e2e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00015e2c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00015e320 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00015e200 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00015eca0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00015ec80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00015ecc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00015ec60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: asset Only match once.==========
=== RUN   TestTargetHandler/matching_constraints/asset_Only_match_once.
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005c5320 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005c5300 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005c5340 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005c52e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005c57c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005c57a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005c57e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005c5780 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: legacy spec match Only match once.==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Only_match_once.
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008df1e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008df1c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008df200 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008df1a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008df760 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008df720 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008df780 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008df6c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: json organizations/** can match organizations/unknown==========
=== RUN   TestTargetHandler/matching_constraints/json_organizations/**_can_match_organizations/unknown
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000714a80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000714a60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000714aa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000714a40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000715140 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000715100 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000715160 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007150c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/unknown/folders/1221214 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: asset organizations/** can match organizations/unknown==========
=== RUN   TestTargetHandler/matching_constraints/asset_organizations/**_can_match_organizations/unknown
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008baf20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008baf00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008baf40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008baea0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008bb600 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008bb5e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008bb620 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008bb5c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/unknown/folders/1221214" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: legacy spec match organizations/** can match organizations/unknown==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_organizations/**_can_match_organizations/unknown
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007a6240 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007a6220 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007a6260 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007a6200 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007a66e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007a66c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007a6700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007a66a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/unknown/folders/1221214" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: json organizations/* can match organizations/unknown==========
=== RUN   TestTargetHandler/matching_constraints/json_organizations/*_can_match_organizations/unknown
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00084bdc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00084bda0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00084bde0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00084bd80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000874240 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000874220 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000874260 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000874200 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/unknown asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: asset organizations/* can match organizations/unknown==========
=== RUN   TestTargetHandler/matching_constraints/asset_organizations/*_can_match_organizations/unknown
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a043a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a04380 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a043e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a04360 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a04960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a04940 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a04980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a04920 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/unknown" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: legacy spec match organizations/* can match organizations/unknown==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_organizations/*_can_match_organizations/unknown
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00093f400 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00093f3e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00093f420 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00093f3c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00093f880 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00093f860 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00093f8a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00093f840 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/unknown" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: json organizations/* can NOT match organizations/unknown with descendents==========
=== RUN   TestTargetHandler/matching_constraints/json_organizations/*_can_NOT_match_organizations/unknown_with_descendents
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000481da0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000481d80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000481dc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000481d60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00015e640 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00015e5e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00015e6c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00015e4e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/unknown/folders/1221214 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========TESTING: asset organizations/* can NOT match organizations/unknown with descendents==========
=== RUN   TestTargetHandler/matching_constraints/asset_organizations/*_can_NOT_match_organizations/unknown_with_descendents
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093400 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000933e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093420 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000933c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000938c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000938a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000938e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093880 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/unknown/folders/1221214" resource:<> 
==========ARM HandleReview==========
==========TESTING: legacy spec match organizations/* can NOT match organizations/unknown with descendents==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_organizations/*_can_NOT_match_organizations/unknown_with_descendents
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004ec2a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004ec280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004ec2c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004ec240 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004ed0e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004ed0a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004ed2e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004ed040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/unknown/folders/1221214" resource:<> 
==========ARM HandleReview==========
==========TESTING: json ** can match organizations/unknown.==========
=== RUN   TestTargetHandler/matching_constraints/json_**_can_match_organizations/unknown.
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000879220 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000879200 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000879240 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008791e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008796c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008796a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008796e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000879680 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/unknown/folders/1221214 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: asset ** can match organizations/unknown.==========
=== RUN   TestTargetHandler/matching_constraints/asset_**_can_match_organizations/unknown.
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006ad660 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006ad640 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006ad680 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006ad620 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006adae0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006adac0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006adb00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006adaa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/unknown/folders/1221214" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: legacy spec match ** can match organizations/unknown.==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_**_can_match_organizations/unknown.
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008671c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008671a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008671e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000867180 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000867640 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000867620 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000867660 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000867600 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/unknown/folders/1221214" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: json * can NOT match organizations/unknown.==========
=== RUN   TestTargetHandler/matching_constraints/json_*_can_NOT_match_organizations/unknown.
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000092da0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000092d80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000092dc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000092d60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000932c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000932a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000932e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/unknown/folders/1221214 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========TESTING: asset * can NOT match organizations/unknown.==========
=== RUN   TestTargetHandler/matching_constraints/asset_*_can_NOT_match_organizations/unknown.
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093260 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000932a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093240 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093740 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093720 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093760 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/unknown/folders/1221214" resource:<> 
==========ARM HandleReview==========
==========TESTING: legacy spec match * can NOT match organizations/unknown.==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_*_can_NOT_match_organizations/unknown.
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00090b680 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00090b640 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00090b6a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00090b620 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000972560 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009724e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009725a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000972480 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/unknown/folders/1221214" resource:<> 
==========ARM HandleReview==========
==========TESTING: json Match org on exact ID==========
=== RUN   TestTargetHandler/matching_constraints/json_Match_org_on_exact_ID
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000935520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000935500 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000935540 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009354e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009359c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009359a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009359e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000935980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: asset Match org on exact ID==========
=== RUN   TestTargetHandler/matching_constraints/asset_Match_org_on_exact_ID
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007f4a60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007f4a40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007f4a80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007f4a20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007f4ee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007f4ec0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007f4f00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007f4ea0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: legacy spec match Match org on exact ID==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Match_org_on_exact_ID
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009194a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919480 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009194c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919460 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919940 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919920 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919900 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: json Does not match org for descendant match==========
=== RUN   TestTargetHandler/matching_constraints/json_Does_not_match_org_for_descendant_match
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000934bc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000934ba0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000934be0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000934b80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000935140 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000935120 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000935160 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009350a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========TESTING: asset Does not match org for descendant match==========
=== RUN   TestTargetHandler/matching_constraints/asset_Does_not_match_org_for_descendant_match
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006fa9a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006fa980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006fa9c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006fa960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006fae40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006fae20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006fae60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006fae00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321" resource:<> 
==========ARM HandleReview==========
==========TESTING: legacy spec match Does not match org for descendant match==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Does_not_match_org_for_descendant_match
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007da860 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007da840 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007da880 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007da820 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007dace0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007dacc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007dad00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007daca0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321" resource:<> 
==========ARM HandleReview==========
==========TESTING: json No match org on close ID==========
=== RUN   TestTargetHandler/matching_constraints/json_No_match_org_on_close_ID
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007b3840 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007b3800 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007b3880 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007b37e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007b3d00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007b3ce0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007b3d20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007b3cc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/1234543211 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========TESTING: asset No match org on close ID==========
=== RUN   TestTargetHandler/matching_constraints/asset_No_match_org_on_close_ID
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00095ba80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00095ba60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00095baa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00095ba40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00095bf20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00095bf00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00095bf40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00095bee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/1234543211" resource:<> 
==========ARM HandleReview==========
==========TESTING: legacy spec match No match org on close ID==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_No_match_org_on_close_ID
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009235c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009235a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009235e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000923580 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000923a40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000923a20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000923a60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000923a00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/1234543211" resource:<> 
==========ARM HandleReview==========
==========TESTING: json Match all under org ID - folder==========
=== RUN   TestTargetHandler/matching_constraints/json_Match_all_under_org_ID_-_folder
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000092720 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000092700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000092740 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000926e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000092ca0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000092c80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000092cc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000092c60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1242511 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: asset Match all under org ID - folder==========
=== RUN   TestTargetHandler/matching_constraints/asset_Match_all_under_org_ID_-_folder
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000933a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093380 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000933c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093360 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093860 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093840 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093880 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093820 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1242511" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: legacy spec match Match all under org ID - folder==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Match_all_under_org_ID_-_folder
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000972940 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000972920 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000972980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000972900 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000973120 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009730a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000973160 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000973080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1242511" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: json Match all under org ID - project==========
=== RUN   TestTargetHandler/matching_constraints/json_Match_all_under_org_ID_-_project
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000909da0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000909d80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000909dc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000909d60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000982220 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000982200 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000982240 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009821e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/projects/1242511 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: asset Match all under org ID - project==========
=== RUN   TestTargetHandler/matching_constraints/asset_Match_all_under_org_ID_-_project
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b2cec0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b2cea0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b2cee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b2ce80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b2d360 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b2d340 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b2d380 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b2d320 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/projects/1242511" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: legacy spec match Match all under org ID - project==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Match_all_under_org_ID_-_project
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000935b80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000935b60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000935ba0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000935b40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000972020 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000972000 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000972040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000935fe0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/projects/1242511" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: json Match all under org ID - folder, project==========
=== RUN   TestTargetHandler/matching_constraints/json_Match_all_under_org_ID_-_folder,_project
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000728bc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000728ba0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000728be0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000728b80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007290c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000729060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000729100 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000729040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/125896/projects/1242511 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: asset Match all under org ID - folder, project==========
=== RUN   TestTargetHandler/matching_constraints/asset_Match_all_under_org_ID_-_folder,_project
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00089a040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00089a020 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00089a060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00089a000 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008584a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000858480 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008584c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000858440 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/125896/projects/1242511" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: legacy spec match Match all under org ID - folder, project==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Match_all_under_org_ID_-_folder,_project
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009344a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000934480 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009344c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000934460 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000934940 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000934920 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000934960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000934900 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/125896/projects/1242511" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: json No match folder on descendants==========
=== RUN   TestTargetHandler/matching_constraints/json_No_match_folder_on_descendants
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007df960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007df940 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007df980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007df920 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007dfe80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007dfe60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007dfea0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007dfe40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========TESTING: asset No match folder on descendants==========
=== RUN   TestTargetHandler/matching_constraints/asset_No_match_folder_on_descendants
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064a800 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064a7e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064a820 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064a7c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064ac80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064ac60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064aca0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064ac40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214" resource:<> 
==========ARM HandleReview==========
==========TESTING: legacy spec match No match folder on descendants==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_No_match_folder_on_descendants
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00066b420 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00066b400 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00066b440 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00066b3e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00066b8a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00066b880 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00066b8c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00066b860 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214" resource:<> 
==========ARM HandleReview==========
==========TESTING: json No match folder==========
=== RUN   TestTargetHandler/matching_constraints/json_No_match_folder
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007337c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007337a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007337e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000733780 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000733c40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000733c20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000733c60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000733c00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221215 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========TESTING: asset No match folder==========
=== RUN   TestTargetHandler/matching_constraints/asset_No_match_folder
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008ba7a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008ba780 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008ba7c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008ba760 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008bac20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008bac00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008bac40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008babe0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221215" resource:<> 
==========ARM HandleReview==========
==========TESTING: legacy spec match No match folder==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_No_match_folder
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000860d60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000860d40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000860d80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000860d20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008611e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008611c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000861200 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008611a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221215" resource:<> 
==========ARM HandleReview==========
==========TESTING: json No match under folder==========
=== RUN   TestTargetHandler/matching_constraints/json_No_match_under_folder
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009099e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009099c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000909a00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009099a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000909e60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000909e40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000909e80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000909e20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/12212144/projects/1221214 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========TESTING: asset No match under folder==========
=== RUN   TestTargetHandler/matching_constraints/asset_No_match_under_folder
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a956c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a956a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a956e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a95680 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a95b60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a95b40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a95b80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a95b20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/12212144/projects/1221214" resource:<> 
==========ARM HandleReview==========
==========TESTING: legacy spec match No match under folder==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_No_match_under_folder
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005ea4a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005ea480 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005ea4c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005ea460 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005ea940 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005ea920 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005ea960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005ea900 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/12212144/projects/1221214" resource:<> 
==========ARM HandleReview==========
==========TESTING: json Match folder in folder==========
=== RUN   TestTargetHandler/matching_constraints/json_Match_folder_in_folder
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000814a20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000814a00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000814a40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008149e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00095a460 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00095a440 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00095a480 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00095a420 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/folders/557385378 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: asset Match folder in folder==========
=== RUN   TestTargetHandler/matching_constraints/asset_Match_folder_in_folder
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000934f60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000934f40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000934f80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000934f20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000935520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000935500 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000935540 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009354e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/folders/557385378" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: legacy spec match Match folder in folder==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Match_folder_in_folder
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008062c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008062a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008062e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000806280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000806740 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000806720 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000806760 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000806700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/folders/557385378" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: json Match project in folder==========
=== RUN   TestTargetHandler/matching_constraints/json_Match_project_in_folder
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000823bc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000823ba0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000823be0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000823b40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00089c080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00089c060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00089c0a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00089c040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/projects/557385378 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: asset Match project in folder==========
=== RUN   TestTargetHandler/matching_constraints/asset_Match_project_in_folder
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000092b60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000092b20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000092b80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000092b00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000930c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000930a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000930e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: legacy spec match Match project in folder==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Match_project_in_folder
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005f5180 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005f5160 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005f51a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005f5140 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005f5620 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005f5600 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005f5640 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005f55e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: json Match project==========
=== RUN   TestTargetHandler/matching_constraints/json_Match_project
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000801b80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000801b60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000801ba0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000801b40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000948000 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000801fe0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000948020 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000801fc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/projects/557385378 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: asset Match project==========
=== RUN   TestTargetHandler/matching_constraints/asset_Match_project
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009d9460 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009d9440 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009d9480 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009d9420 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009d9900 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009d98e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009d9920 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009d98c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: legacy spec match Match project==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Match_project
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000633700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006336e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000633720 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006336c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000633ba0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000633b80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000633bc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000633b60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: json Match project by ID, not number==========
=== RUN   TestTargetHandler/matching_constraints/json_Match_project_by_ID,_not_number
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008a4860 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008a4840 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008a4880 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008a4820 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008a4d00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008a4ce0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008a4d20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008a4cc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/projects/tfv-test-project asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: asset Match project by ID, not number==========
=== RUN   TestTargetHandler/matching_constraints/asset_Match_project_by_ID,_not_number
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000481900 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004818e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000481920 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004818c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000481de0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000481dc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000481e00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000481da0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/tfv-test-project" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: legacy spec match Match project by ID, not number==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Match_project_by_ID,_not_number
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005fe520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005fe500 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005fe540 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005fe4e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005fe9c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005fe9a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005fe9e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005fe980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/tfv-test-project" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: json Match any project==========
=== RUN   TestTargetHandler/matching_constraints/json_Match_any_project
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c85c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c85a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c85e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c8580 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c8a40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c8a20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c8a60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c8a00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/projects/557385378 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: asset Match any project==========
=== RUN   TestTargetHandler/matching_constraints/asset_Match_any_project
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000481be0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000481bc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000481c00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000481b80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00015e1e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00015e0e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00015e200 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00015e0a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: legacy spec match Match any project==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Match_any_project
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009b9060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009b9040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009b9080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009b9020 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009b9780 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009b9740 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009b98a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009b9700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: json Does not match project==========
=== RUN   TestTargetHandler/matching_constraints/json_Does_not_match_project
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000778c00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000778be0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000778c20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000778bc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007790c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007790a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007790e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000779080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/projects/557385378 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========TESTING: asset Does not match project==========
=== RUN   TestTargetHandler/matching_constraints/asset_Does_not_match_project
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000811400 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008113e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000811420 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008113c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000811880 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000811860 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008118a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000811840 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========ARM HandleReview==========
==========TESTING: legacy spec match Does not match project==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Does_not_match_project
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008d2fc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008d2fa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008d2fe0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008d2f80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008d3440 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008d3420 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008d3460 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008d3400 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========ARM HandleReview==========
==========TESTING: json Match project multiple==========
=== RUN   TestTargetHandler/matching_constraints/json_Match_project_multiple
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918e20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918e00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918e40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918de0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009192c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009192a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009192e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/projects/557385378 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: asset Match project multiple==========
=== RUN   TestTargetHandler/matching_constraints/asset_Match_project_multiple
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e0080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e0060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e00a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e0040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e0500 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e04e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e0520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e04c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: legacy spec match Match project multiple==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Match_project_multiple
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00096e040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00096e020 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00096e060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00096e000 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000aae0a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000aae080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000aae0c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000aae060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: json Match any project==========
=== RUN   TestTargetHandler/matching_constraints/json_Match_any_project#01
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b6c20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b6c00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b6c40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b6be0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b70c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b70a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b70e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b7080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/projects/557385378 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: asset Match any project==========
=== RUN   TestTargetHandler/matching_constraints/asset_Match_any_project#01
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007eff40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007eff20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007eff60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007eff00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008dc3c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008dc3a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008dc3e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008dc380 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: legacy spec match Match any project==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Match_any_project#01
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00073f120 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00073f100 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00073f140 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00073f0e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00073f5a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00073f580 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00073f5c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00073f560 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: json Exclude project==========
=== RUN   TestTargetHandler/matching_constraints/json_Exclude_project
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009190a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009190c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919540 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919560 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919500 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/projects/557385378 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========TESTING: asset Exclude project==========
=== RUN   TestTargetHandler/matching_constraints/asset_Exclude_project
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918600 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009185e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918620 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009185c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918aa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918a80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918ac0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918a60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========ARM HandleReview==========
==========TESTING: legacy spec match Exclude project==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Exclude_project
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000879a60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000879a40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000879a80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000879a20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000879f20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000879f00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000879f40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000879ee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========ARM HandleReview==========
==========TESTING: json Exclude project by ID, not number==========
=== RUN   TestTargetHandler/matching_constraints/json_Exclude_project_by_ID,_not_number
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000943800 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009437e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000943820 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009437c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000943ca0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000943c80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000943cc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000943c60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/projects/tfv-exclude-project asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========TESTING: asset Exclude project by ID, not number==========
=== RUN   TestTargetHandler/matching_constraints/asset_Exclude_project_by_ID,_not_number
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000942fa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000942f40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000943000 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000942f20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000943540 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000943520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000943560 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000943500 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/tfv-exclude-project" resource:<> 
==========ARM HandleReview==========
==========TESTING: legacy spec match Exclude project by ID, not number==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Exclude_project_by_ID,_not_number
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008ab040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008ab020 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008ab060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008ab000 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008ab4c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008ab4a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008ab4e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008ab480 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/tfv-exclude-project" resource:<> 
==========ARM HandleReview==========
==========TESTING: json Exclude project multiple==========
=== RUN   TestTargetHandler/matching_constraints/json_Exclude_project_multiple
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007da7e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007da7c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007da800 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007da7a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007dac80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007dac60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007daca0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007dac40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/projects/557385378 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========TESTING: asset Exclude project multiple==========
=== RUN   TestTargetHandler/matching_constraints/asset_Exclude_project_multiple
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0ba60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0ba40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0ba80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0ba20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0bf00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0bee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0bf20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0bec0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========ARM HandleReview==========
==========TESTING: legacy spec match Exclude project multiple==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Exclude_project_multiple
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000934b40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000934b20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000934b60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000934b00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000935040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000935020 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000935080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000935000 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========ARM HandleReview==========
==========TESTING: json Exclude project via wildcard on org==========
=== RUN   TestTargetHandler/matching_constraints/json_Exclude_project_via_wildcard_on_org
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000422f60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000422f40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000422f80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000422f20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000423400 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004233e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000423420 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004233c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/projects/557385378 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========TESTING: asset Exclude project via wildcard on org==========
=== RUN   TestTargetHandler/matching_constraints/asset_Exclude_project_via_wildcard_on_org
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006907e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006907c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000690800 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006907a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000690c80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000690c60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000690ca0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000690c40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/projects/557385378" resource:<> 
==========ARM HandleReview==========
==========TESTING: legacy spec match Exclude project via wildcard on org==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Exclude_project_via_wildcard_on_org
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009488e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009488c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000948900 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009488a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000948d60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000948d40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000948d80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000948d20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/projects/557385378" resource:<> 
==========ARM HandleReview==========
==========TESTING: json invalid target CRM type==========
=== RUN   TestTargetHandler/matching_constraints/json_invalid_target_CRM_type
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a12f00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a12ee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a12f20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a12ec0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a133a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a13380 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a133c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a13360 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
==========TESTING: asset invalid target CRM type==========
=== RUN   TestTargetHandler/matching_constraints/asset_invalid_target_CRM_type
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00094eb80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00094eb40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00094eba0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00094eb00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00094f340 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00094f320 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00094f360 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00094f300 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
==========TESTING: legacy spec match invalid target CRM type==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_invalid_target_CRM_type
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000abe900 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000abe8e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000abe920 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000abe8c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000abeda0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000abed80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000abedc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000abed60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
==========TESTING: json org after folder==========
=== RUN   TestTargetHandler/matching_constraints/json_org_after_folder
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a58380 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a01fe0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a583a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a01fc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a58820 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a58800 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a58840 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a587e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
==========TESTING: asset org after folder==========
=== RUN   TestTargetHandler/matching_constraints/asset_org_after_folder
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000994d20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000994d00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000994d40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000994ce0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009951c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009951a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009951e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000995180 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
==========TESTING: legacy spec match org after folder==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_org_after_folder
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a85a20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a85a00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a85a40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a859e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a85ec0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a85ea0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a85ee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a85e80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
==========TESTING: json org after project==========
=== RUN   TestTargetHandler/matching_constraints/json_org_after_project
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918fa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918f80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918fc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918f60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919440 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919420 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919460 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919400 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
==========TESTING: asset org after project==========
=== RUN   TestTargetHandler/matching_constraints/asset_org_after_project
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009124a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000912480 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009124c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000912460 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000912940 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000912920 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000912960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000912900 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
==========TESTING: legacy spec match org after project==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_org_after_project
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919020 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919000 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009194e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009194c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919500 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009194a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
==========TESTING: json folder after project==========
=== RUN   TestTargetHandler/matching_constraints/json_folder_after_project
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a5bd00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a5bce0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a5bd20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a5bcc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b002c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b002a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b002e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b00280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
==========TESTING: asset folder after project==========
=== RUN   TestTargetHandler/matching_constraints/asset_folder_after_project
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00087f580 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00087f560 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00087f5a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00087f540 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00087fa20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00087fa00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00087fa40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00087f9e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
==========TESTING: legacy spec match folder after project==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_folder_after_project
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000955bc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000955ba0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000955be0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000955b80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b04b00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b04ae0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b04b20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b04ac0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
==========TESTING: json allow unknown in match parameters==========
=== RUN   TestTargetHandler/matching_constraints/json_allow_unknown_in_match_parameters
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919220 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919200 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919240 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009191e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009196c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009196a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009196e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000919680 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/unknown asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: asset allow unknown in match parameters==========
=== RUN   TestTargetHandler/matching_constraints/asset_allow_unknown_in_match_parameters
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000878b40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000878b20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000878b60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000878b00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000878fe0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000878fc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000879000 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000878fa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/unknown" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: legacy spec match allow unknown in match parameters==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_allow_unknown_in_match_parameters
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006d20e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006d20c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006d2100 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006d20a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006d2560 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006d2540 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006d2580 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006d2520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/unknown" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: json organizations/unknown cannot match other random org string==========
=== RUN   TestTargetHandler/matching_constraints/json_organizations/unknown_cannot_match_other_random_org_string
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000888ee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000888ec0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000888f00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000888ea0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000889360 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000889340 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000889380 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000889320 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/whatever asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========TESTING: asset organizations/unknown cannot match other random org string==========
=== RUN   TestTargetHandler/matching_constraints/asset_organizations/unknown_cannot_match_other_random_org_string
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009c40c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009c40a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009c40e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009c4080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009c4560 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009c4540 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009c4580 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009c4520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/whatever" resource:<> 
==========ARM HandleReview==========
==========TESTING: legacy spec match organizations/unknown cannot match other random org string==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_organizations/unknown_cannot_match_other_random_org_string
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a3c200 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a3c1e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a3c220 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a3c1c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a3c6a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a3c680 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a3c6c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a3c660 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/whatever" resource:<> 
==========ARM HandleReview==========
==========TESTING: json only allows unknown as string in match parameter==========
=== RUN   TestTargetHandler/matching_constraints/json_only_allows_unknown_as_string_in_match_parameter
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007f6e60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007f6e40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007f6e80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007f6e20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007f76c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007f76a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007f76e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007f7680 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
==========TESTING: asset only allows unknown as string in match parameter==========
=== RUN   TestTargetHandler/matching_constraints/asset_only_allows_unknown_as_string_in_match_parameter
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ba8380 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ba8360 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ba83a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ba8340 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ba8820 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ba8800 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ba8840 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ba87e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
==========TESTING: legacy spec match only allows unknown as string in match parameter==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_only_allows_unknown_as_string_in_match_parameter
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918a00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009189e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918a20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009189c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918ea0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918e80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918ec0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918e60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
==========TESTING: json invalid exclude CRM name==========
=== RUN   TestTargetHandler/matching_constraints/json_invalid_exclude_CRM_name
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00087e180 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00087e160 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00087e1a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00087e140 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009f64c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009f64a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009f64e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009f6480 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
==========TESTING: asset invalid exclude CRM name==========
=== RUN   TestTargetHandler/matching_constraints/asset_invalid_exclude_CRM_name
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000860e80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000860e60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000860ea0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000860e40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000861320 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000861300 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000861340 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008612e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
==========TESTING: legacy spec match invalid exclude CRM name==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_invalid_exclude_CRM_name
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b71400 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b713e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b71420 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b713c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b718a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b71880 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b718c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b71860 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
==========TESTING: json Bad target type==========
=== RUN   TestTargetHandler/matching_constraints/json_Bad_target_type
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918b00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918ae0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918b20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918ac0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918fa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918f80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918fc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918f60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========TESTING: asset Bad target type==========
=== RUN   TestTargetHandler/matching_constraints/asset_Bad_target_type
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009aba00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009ab9e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009aba20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009ab9c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009aa280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009aa260 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009aa2a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009aa240 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========TESTING: legacy spec match Bad target type==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Bad_target_type
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093240 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093220 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093260 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093200 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000936e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093720 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000936c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========TESTING: json Bad target item type==========
=== RUN   TestTargetHandler/matching_constraints/json_Bad_target_item_type
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008158e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008158c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000815900 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008158a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000815d80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000815d60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000815da0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000815d40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========TESTING: asset Bad target item type==========
=== RUN   TestTargetHandler/matching_constraints/asset_Bad_target_item_type
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000395100 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0003950e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000395120 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0003950c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0003955a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000395580 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0003955c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000395560 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========TESTING: legacy spec match Bad target item type==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Bad_target_item_type
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006607c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006607a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006607e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000660780 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000660c40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000660c20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000660c60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000660c00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========TESTING: json Bad exclude type==========
=== RUN   TestTargetHandler/matching_constraints/json_Bad_exclude_type
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000661300 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006612e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000661320 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006612c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007360e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000736080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000736140 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000736040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========TESTING: asset Bad exclude type==========
=== RUN   TestTargetHandler/matching_constraints/asset_Bad_exclude_type
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000630300 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006302e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000630320 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006302c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000630780 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000630760 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006307a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000630740 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========TESTING: legacy spec match Bad exclude type==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Bad_exclude_type
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000633840 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000633820 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000633860 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000633800 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000633ce0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000633cc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000633d00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000633ca0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========TESTING: json Bad exclude item type==========
=== RUN   TestTargetHandler/matching_constraints/json_Bad_exclude_item_type
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006daa20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006daa00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006daaa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006da9e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006db1a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006db180 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006db1c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006db160 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========TESTING: asset Bad exclude item type==========
=== RUN   TestTargetHandler/matching_constraints/asset_Bad_exclude_item_type
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005e3540 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005e3520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005e3560 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005e3500 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005e39e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005e39c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005e3a00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005e39a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========TESTING: legacy spec match Bad exclude item type==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Bad_exclude_item_type
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064eb00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064eae0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064eb20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064eac0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064ef80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064ef60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064efa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064ef40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========TESTING: json target and ancestries should conflict==========
=== RUN   TestTargetHandler/matching_constraints/json_target_and_ancestries_should_conflict
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006afe40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006afe20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006afe60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006afe00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f42c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f42a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f42e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f4280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
==========TESTING: asset target and ancestries should conflict==========
=== RUN   TestTargetHandler/matching_constraints/asset_target_and_ancestries_should_conflict
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f4080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f4060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f40a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f4040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f4620 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f4600 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f4640 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f45e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
==========TESTING: json exclude and excludedAncestries should conflict==========
=== RUN   TestTargetHandler/matching_constraints/json_exclude_and_excludedAncestries_should_conflict
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008dd2c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008dd2a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008dd2e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008dd280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008dd760 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008dd740 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008dd780 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008dd720 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
==========TESTING: asset exclude and excludedAncestries should conflict==========
=== RUN   TestTargetHandler/matching_constraints/asset_exclude_and_excludedAncestries_should_conflict
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005c7700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005c76e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005c7720 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005c76c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005c7ba0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005c7b80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005c7bc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005c7b60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
==========TESTING: json target should warn==========
=== RUN   TestTargetHandler/matching_constraints/json_target_should_warn
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f17e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f17c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f1800 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f17a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f1c60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f1c40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f1c80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f1c20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/projects/557385378 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: asset target should warn==========
=== RUN   TestTargetHandler/matching_constraints/asset_target_should_warn
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008618c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008618a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008618e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000861880 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008609c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000860920 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008609e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000860900 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========ARM HandleReview==========
==========ARM HandleViolation==========
==========TESTING: json exclude should warn==========
=== RUN   TestTargetHandler/matching_constraints/json_exclude_should_warn
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a85c20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a85c00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a85c40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a85be0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009180c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009180a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009180e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000918080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/projects/557385378 asset_type:test-asset-type name:test-name resource:map[]]
==========ARM HandleReview==========
==========TESTING: asset exclude should warn==========
=== RUN   TestTargetHandler/matching_constraints/asset_exclude_should_warn
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008affa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008aff80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008de040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008aff40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008defc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008def80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008df000 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008deee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END ARM SCHEMA==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========ARM HandleReview==========
--- PASS: TestTargetHandler (1.43s)
    --- PASS: TestTargetHandler/matching_constraints (1.43s)
        --- PASS: TestTargetHandler/matching_constraints/json_Null_match_object_(matches_anything) (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Null_match_object_(matches_anything) (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Null_match_object_(matches_anything) (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_No_match_specified_(matches_anything) (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_No_match_specified_(matches_anything) (0.02s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_No_match_specified_(matches_anything) (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Only_match_once. (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Only_match_once. (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Only_match_once. (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_organizations/**_can_match_organizations/unknown (0.02s)
        --- PASS: TestTargetHandler/matching_constraints/asset_organizations/**_can_match_organizations/unknown (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_organizations/**_can_match_organizations/unknown (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_organizations/*_can_match_organizations/unknown (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_organizations/*_can_match_organizations/unknown (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_organizations/*_can_match_organizations/unknown (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_organizations/*_can_NOT_match_organizations/unknown_with_descendents (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_organizations/*_can_NOT_match_organizations/unknown_with_descendents (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_organizations/*_can_NOT_match_organizations/unknown_with_descendents (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_**_can_match_organizations/unknown. (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_**_can_match_organizations/unknown. (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_**_can_match_organizations/unknown. (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_*_can_NOT_match_organizations/unknown. (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_*_can_NOT_match_organizations/unknown. (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_*_can_NOT_match_organizations/unknown. (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Match_org_on_exact_ID (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Match_org_on_exact_ID (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Match_org_on_exact_ID (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Does_not_match_org_for_descendant_match (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Does_not_match_org_for_descendant_match (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Does_not_match_org_for_descendant_match (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_No_match_org_on_close_ID (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_No_match_org_on_close_ID (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_No_match_org_on_close_ID (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Match_all_under_org_ID_-_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Match_all_under_org_ID_-_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Match_all_under_org_ID_-_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Match_all_under_org_ID_-_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Match_all_under_org_ID_-_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Match_all_under_org_ID_-_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Match_all_under_org_ID_-_folder,_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Match_all_under_org_ID_-_folder,_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Match_all_under_org_ID_-_folder,_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_No_match_folder_on_descendants (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_No_match_folder_on_descendants (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_No_match_folder_on_descendants (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_No_match_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_No_match_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_No_match_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_No_match_under_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_No_match_under_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_No_match_under_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Match_folder_in_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Match_folder_in_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Match_folder_in_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Match_project_in_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Match_project_in_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Match_project_in_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Match_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Match_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Match_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Match_project_by_ID,_not_number (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Match_project_by_ID,_not_number (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Match_project_by_ID,_not_number (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Match_any_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Match_any_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Match_any_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Does_not_match_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Does_not_match_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Does_not_match_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Match_project_multiple (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Match_project_multiple (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Match_project_multiple (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Match_any_project#01 (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Match_any_project#01 (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Match_any_project#01 (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Exclude_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Exclude_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Exclude_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Exclude_project_by_ID,_not_number (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Exclude_project_by_ID,_not_number (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Exclude_project_by_ID,_not_number (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Exclude_project_multiple (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Exclude_project_multiple (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Exclude_project_multiple (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Exclude_project_via_wildcard_on_org (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Exclude_project_via_wildcard_on_org (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Exclude_project_via_wildcard_on_org (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_invalid_target_CRM_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_invalid_target_CRM_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_invalid_target_CRM_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_org_after_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_org_after_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_org_after_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_org_after_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_org_after_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_org_after_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_folder_after_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_folder_after_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_folder_after_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_allow_unknown_in_match_parameters (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_allow_unknown_in_match_parameters (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_allow_unknown_in_match_parameters (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_organizations/unknown_cannot_match_other_random_org_string (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_organizations/unknown_cannot_match_other_random_org_string (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_organizations/unknown_cannot_match_other_random_org_string (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_only_allows_unknown_as_string_in_match_parameter (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_only_allows_unknown_as_string_in_match_parameter (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_only_allows_unknown_as_string_in_match_parameter (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_invalid_exclude_CRM_name (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_invalid_exclude_CRM_name (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_invalid_exclude_CRM_name (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Bad_target_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Bad_target_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Bad_target_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Bad_target_item_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Bad_target_item_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Bad_target_item_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Bad_exclude_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Bad_exclude_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Bad_exclude_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Bad_exclude_item_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Bad_exclude_item_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Bad_exclude_item_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_target_and_ancestries_should_conflict (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_target_and_ancestries_should_conflict (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_exclude_and_excludedAncestries_should_conflict (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_exclude_and_excludedAncestries_should_conflict (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_target_should_warn (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_target_should_warn (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_exclude_should_warn (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_exclude_should_warn (0.01s)
PASS
ok  	github.com/GoogleCloudPlatform/config-validator/pkg/armtarget	1.451s
=== RUN   TestConvertResourceToInterface
=== RUN   TestConvertResourceToInterface/nil_input
=== RUN   TestConvertResourceToInterface/asset_proto_preserves_underscores
=== RUN   TestConvertResourceToInterface/resource_proto_preserves_underscores
=== RUN   TestConvertResourceToInterface/resource_proto's_data_preserves_underscores
--- PASS: TestConvertResourceToInterface (0.00s)
    --- PASS: TestConvertResourceToInterface/nil_input (0.00s)
    --- PASS: TestConvertResourceToInterface/asset_proto_preserves_underscores (0.00s)
    --- PASS: TestConvertResourceToInterface/resource_proto_preserves_underscores (0.00s)
    --- PASS: TestConvertResourceToInterface/resource_proto's_data_preserves_underscores (0.00s)
=== RUN   TestCleanProtoValues
=== RUN   TestCleanProtoValues/Empty
=== RUN   TestCleanProtoValues/Null
=== RUN   TestCleanProtoValues/Number
=== RUN   TestCleanProtoValues/String
=== RUN   TestCleanProtoValues/Bool
=== RUN   TestCleanProtoValues/ListNilListValue
=== RUN   TestCleanProtoValues/ListNilValues
=== RUN   TestCleanProtoValues/ListLen0
=== RUN   TestCleanProtoValues/ListWithBadValue
=== RUN   TestCleanProtoValues/StructNilStructValue
=== RUN   TestCleanProtoValues/StructNilValues
=== RUN   TestCleanProtoValues/StructLen0
=== RUN   TestCleanProtoValues/StructWithBadValue
--- PASS: TestCleanProtoValues (0.00s)
    --- PASS: TestCleanProtoValues/Empty (0.00s)
    --- PASS: TestCleanProtoValues/Null (0.00s)
    --- PASS: TestCleanProtoValues/Number (0.00s)
    --- PASS: TestCleanProtoValues/String (0.00s)
    --- PASS: TestCleanProtoValues/Bool (0.00s)
    --- PASS: TestCleanProtoValues/ListNilListValue (0.00s)
    --- PASS: TestCleanProtoValues/ListNilValues (0.00s)
    --- PASS: TestCleanProtoValues/ListLen0 (0.00s)
    --- PASS: TestCleanProtoValues/ListWithBadValue (0.00s)
    --- PASS: TestCleanProtoValues/StructNilStructValue (0.00s)
    --- PASS: TestCleanProtoValues/StructNilValues (0.00s)
    --- PASS: TestCleanProtoValues/StructLen0 (0.00s)
    --- PASS: TestCleanProtoValues/StructWithBadValue (0.00s)
PASS
ok  	github.com/GoogleCloudPlatform/config-validator/pkg/asset	(cached)
=== RUN   TestTargetHandler
==========GCP GetName==========
========== newConstraintTemplate ==========
validation.gcp.forsetisecurity.org

package testconstraint

violation[{"msg": msg}] {
	input.parameters.kind == "VirtualMachine" 
    input.parameters.type == "Microsoft.Compute/virtualMachines"
	msg := input.parameters.msg
}

TESTING CONFIGURATION
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
=== RUN   TestTargetHandler/matching_constraints
==========TESTING: json Null match object (matches anything)==========
=== RUN   TestTargetHandler/matching_constraints/json_Null_match_object_(matches_anything)
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00072f580 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00072f560 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00072f5a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00072f540 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00072fa20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00072fa00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00072fa40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00072f9e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: asset Null match object (matches anything)==========
=== RUN   TestTargetHandler/matching_constraints/asset_Null_match_object_(matches_anything)
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00086a380 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00086a360 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00086a3a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00086a340 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00086a820 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00086a800 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00086a840 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00086a7e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: legacy spec match Null match object (matches anything)==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Null_match_object_(matches_anything)
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006cc960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006cc940 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006cc980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006cc920 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006cce00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006ccde0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006cce20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006ccdc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: json No match specified (matches anything)==========
=== RUN   TestTargetHandler/matching_constraints/json_No_match_specified_(matches_anything)
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e39a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e3980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e39c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e3960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e3e20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e3e00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e3e40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e3de0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: asset No match specified (matches anything)==========
=== RUN   TestTargetHandler/matching_constraints/asset_No_match_specified_(matches_anything)
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009a78e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009a78c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009a7900 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009a78a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009a7d80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009a7d60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009a7da0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009a7d40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: legacy spec match No match specified (matches anything)==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_No_match_specified_(matches_anything)
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009fe660 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009fe640 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009fe680 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009fe620 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009feb80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009feb60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009feba0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009feb40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: json Only match once.==========
=== RUN   TestTargetHandler/matching_constraints/json_Only_match_once.
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a01360 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a01320 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a01380 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a01300 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a01aa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a01a80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a01ac0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a019e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: asset Only match once.==========
=== RUN   TestTargetHandler/matching_constraints/asset_Only_match_once.
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008fb6c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008fb6a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008fb6e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008fb680 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008fbb40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008fbb20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008fbb60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008fbb00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: legacy spec match Only match once.==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Only_match_once.
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00046ef60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00046ed60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00046f000 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00046ed20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000920a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000092080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000920c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000092060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: json organizations/** can match organizations/unknown==========
=== RUN   TestTargetHandler/matching_constraints/json_organizations/**_can_match_organizations/unknown
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000631560 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000631540 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000631580 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000631520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000631a00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006319e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000631a20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006319c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/unknown/folders/1221214 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: asset organizations/** can match organizations/unknown==========
=== RUN   TestTargetHandler/matching_constraints/asset_organizations/**_can_match_organizations/unknown
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008c87e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008c87c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008c8800 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008c87a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008c8c60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008c8c40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008c8c80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008c8c20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/unknown/folders/1221214" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: legacy spec match organizations/** can match organizations/unknown==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_organizations/**_can_match_organizations/unknown
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009feac0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009feaa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009feae0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009fea80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009fefa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009fef80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009fefc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009fef60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/unknown/folders/1221214" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: json organizations/* can match organizations/unknown==========
=== RUN   TestTargetHandler/matching_constraints/json_organizations/*_can_match_organizations/unknown
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00093aa20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00093aa00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00093aa40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00093a9e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00093aea0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00093ae80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00093aec0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00093ae60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/unknown asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: asset organizations/* can match organizations/unknown==========
=== RUN   TestTargetHandler/matching_constraints/asset_organizations/*_can_match_organizations/unknown
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004da5e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004da5c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004da600 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004da5a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004daaa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004daa80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004daac0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004daa60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/unknown" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: legacy spec match organizations/* can match organizations/unknown==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_organizations/*_can_match_organizations/unknown
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009fe600 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009fe5e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009fe620 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009fe5c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009feb20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009feb00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009feb40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009feae0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/unknown" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: json organizations/* can NOT match organizations/unknown with descendents==========
=== RUN   TestTargetHandler/matching_constraints/json_organizations/*_can_NOT_match_organizations/unknown_with_descendents
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00076f6a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00076f680 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00076f700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00076f660 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00076fbe0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00076fbc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00076fc00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00076fba0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/unknown/folders/1221214 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========TESTING: asset organizations/* can NOT match organizations/unknown with descendents==========
=== RUN   TestTargetHandler/matching_constraints/asset_organizations/*_can_NOT_match_organizations/unknown_with_descendents
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c9160 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c9140 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c9180 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c9120 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c9680 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c9660 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c96a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c9640 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/unknown/folders/1221214" resource:<> 
==========GCP HandleReview==========
==========TESTING: legacy spec match organizations/* can NOT match organizations/unknown with descendents==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_organizations/*_can_NOT_match_organizations/unknown_with_descendents
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009a7bc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009a7ba0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009a7be0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009a7b80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070e060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070e040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070e080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070e020 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/unknown/folders/1221214" resource:<> 
==========GCP HandleReview==========
==========TESTING: json ** can match organizations/unknown.==========
=== RUN   TestTargetHandler/matching_constraints/json_**_can_match_organizations/unknown.
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007282e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007282c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000728300 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007282a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000728760 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000728740 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000728780 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000728720 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/unknown/folders/1221214 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: asset ** can match organizations/unknown.==========
=== RUN   TestTargetHandler/matching_constraints/asset_**_can_match_organizations/unknown.
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078cc40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078cc20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078cc60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078cc00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d160 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d140 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d180 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d120 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/unknown/folders/1221214" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: legacy spec match ** can match organizations/unknown.==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_**_can_match_organizations/unknown.
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db6c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db6a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db6e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db680 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dbb80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dbb60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dbba0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dbb40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/unknown/folders/1221214" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: json * can NOT match organizations/unknown.==========
=== RUN   TestTargetHandler/matching_constraints/json_*_can_NOT_match_organizations/unknown.
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006a8840 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006a8820 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006a8860 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006a8800 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006a8cc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006a8ca0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006a8ce0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006a8c80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/unknown/folders/1221214 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========TESTING: asset * can NOT match organizations/unknown.==========
=== RUN   TestTargetHandler/matching_constraints/asset_*_can_NOT_match_organizations/unknown.
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000af8120 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000af8100 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000af8140 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000af80e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a342a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a34280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a342c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a34260 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/unknown/folders/1221214" resource:<> 
==========GCP HandleReview==========
==========TESTING: legacy spec match * can NOT match organizations/unknown.==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_*_can_NOT_match_organizations/unknown.
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00089b6a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00089b680 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00089b6c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00089b660 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00089bb40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00089bb20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00089bb60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00089bb00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/unknown/folders/1221214" resource:<> 
==========GCP HandleReview==========
==========TESTING: json Match org on exact ID==========
=== RUN   TestTargetHandler/matching_constraints/json_Match_org_on_exact_ID
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a48380 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a48360 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a483a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a48340 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a48820 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a48800 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a48840 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a487e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: asset Match org on exact ID==========
=== RUN   TestTargetHandler/matching_constraints/asset_Match_org_on_exact_ID
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000556100 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005560e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000556120 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005560c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000556580 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000556560 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005565a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000556540 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: legacy spec match Match org on exact ID==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Match_org_on_exact_ID
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070e420 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070e400 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070e440 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070e3e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070e8a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070e880 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070e8c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070e860 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: json Does not match org for descendant match==========
=== RUN   TestTargetHandler/matching_constraints/json_Does_not_match_org_for_descendant_match
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ac0f20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ac0f00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ac0f40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ac0ee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008be460 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008be440 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008be480 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008be420 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========TESTING: asset Does not match org for descendant match==========
=== RUN   TestTargetHandler/matching_constraints/asset_Does_not_match_org_for_descendant_match
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009ec560 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009ec540 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009ec580 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009ec520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009eca00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009ec9e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009eca20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009ec9c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321" resource:<> 
==========GCP HandleReview==========
==========TESTING: legacy spec match Does not match org for descendant match==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Does_not_match_org_for_descendant_match
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dbb20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dbb00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dbb40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dbae0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dbfc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dbfa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dbfe0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dbf80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321" resource:<> 
==========GCP HandleReview==========
==========TESTING: json No match org on close ID==========
=== RUN   TestTargetHandler/matching_constraints/json_No_match_org_on_close_ID
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00046fa20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00046f9e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00046fa60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00046f9c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000922c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000922a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000922e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000092280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/1234543211 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========TESTING: asset No match org on close ID==========
=== RUN   TestTargetHandler/matching_constraints/asset_No_match_org_on_close_ID
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dc7e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dc7c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dc800 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dc7a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dcc80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dcc60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dcca0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dcc40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/1234543211" resource:<> 
==========GCP HandleReview==========
==========TESTING: legacy spec match No match org on close ID==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_No_match_org_on_close_ID
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000791580 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000791560 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007915a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000791540 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000791a20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000791a00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000791a40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007919e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/1234543211" resource:<> 
==========GCP HandleReview==========
==========TESTING: json Match all under org ID - folder==========
=== RUN   TestTargetHandler/matching_constraints/json_Match_all_under_org_ID_-_folder
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00088b1e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00088b1c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00088b200 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00088b1a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00088b980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00088b960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00088b9a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00088b940 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1242511 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: asset Match all under org ID - folder==========
=== RUN   TestTargetHandler/matching_constraints/asset_Match_all_under_org_ID_-_folder
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000912d40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000912d20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000912d60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000912d00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009131e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009131c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000913200 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009131a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1242511" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: legacy spec match Match all under org ID - folder==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Match_all_under_org_ID_-_folder
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009ddf20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009ddf00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009ddf40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009ddee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009fe3c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009fe3a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009fe3e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009fe380 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1242511" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: json Match all under org ID - project==========
=== RUN   TestTargetHandler/matching_constraints/json_Match_all_under_org_ID_-_project
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00082c260 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00082c240 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00082c280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00082c220 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00082c980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00082c920 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00082c9a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00082c900 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/projects/1242511 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: asset Match all under org ID - project==========
=== RUN   TestTargetHandler/matching_constraints/asset_Match_all_under_org_ID_-_project
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008387c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008387a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008387e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000838780 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b1c220 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b1c200 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b1c240 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b1c1e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/projects/1242511" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: legacy spec match Match all under org ID - project==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Match_all_under_org_ID_-_project
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dc500 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dc4e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dc520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dc4c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dc9a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dc980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dc9c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dc960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/projects/1242511" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: json Match all under org ID - folder, project==========
=== RUN   TestTargetHandler/matching_constraints/json_Match_all_under_org_ID_-_folder,_project
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00065a540 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00065a520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00065a560 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00065a500 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00065a9c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00065a9a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00065a9e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00065a980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/125896/projects/1242511 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: asset Match all under org ID - folder, project==========
=== RUN   TestTargetHandler/matching_constraints/asset_Match_all_under_org_ID_-_folder,_project
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00089e7c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00089e7a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00089e7e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00089e780 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00089ec40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00089ec20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00089ec60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00089ec00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/125896/projects/1242511" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: legacy spec match Match all under org ID - folder, project==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Match_all_under_org_ID_-_folder,_project
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db2e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db2c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db300 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db2a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db8a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db880 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db8c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db860 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/125896/projects/1242511" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: json No match folder on descendants==========
=== RUN   TestTargetHandler/matching_constraints/json_No_match_folder_on_descendants
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008ffae0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008ffaa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008ffb40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008ffa40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00057a340 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00057a320 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00057a360 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00057a300 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========TESTING: asset No match folder on descendants==========
=== RUN   TestTargetHandler/matching_constraints/asset_No_match_folder_on_descendants
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000756760 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000756740 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000756780 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000756720 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c4e280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c4e260 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c4e2a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c4e240 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214" resource:<> 
==========GCP HandleReview==========
==========TESTING: legacy spec match No match folder on descendants==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_No_match_folder_on_descendants
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078df80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078df60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078dfa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078df40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004da580 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004da560 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004da5a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004da540 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214" resource:<> 
==========GCP HandleReview==========
==========TESTING: json No match folder==========
=== RUN   TestTargetHandler/matching_constraints/json_No_match_folder
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005d8dc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005d8da0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005d8de0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005d8d80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005d9260 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005d9240 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005d9280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005d9220 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221215 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========TESTING: asset No match folder==========
=== RUN   TestTargetHandler/matching_constraints/asset_No_match_folder
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009245e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009245c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000924600 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009245a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000924a60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000924a40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000924a80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000924a20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221215" resource:<> 
==========GCP HandleReview==========
==========TESTING: legacy spec match No match folder==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_No_match_folder
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000847e40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000847e20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000847e60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000847e00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008722c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008722a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008722e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000872280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221215" resource:<> 
==========GCP HandleReview==========
==========TESTING: json No match under folder==========
=== RUN   TestTargetHandler/matching_constraints/json_No_match_under_folder
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0a0c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0a0a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0a0e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0a080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008ba2e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008ba2c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008ba300 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008ba2a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/12212144/projects/1221214 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========TESTING: asset No match under folder==========
=== RUN   TestTargetHandler/matching_constraints/asset_No_match_under_folder
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006e71c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006e71a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006e71e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006e7180 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006e7660 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006e7640 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006e7680 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006e7620 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/12212144/projects/1221214" resource:<> 
==========GCP HandleReview==========
==========TESTING: legacy spec match No match under folder==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_No_match_under_folder
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004da3e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004da3c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004da400 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004da3a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004da880 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004da860 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004da8a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004da840 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/12212144/projects/1221214" resource:<> 
==========GCP HandleReview==========
==========TESTING: json Match folder in folder==========
=== RUN   TestTargetHandler/matching_constraints/json_Match_folder_in_folder
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db720 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db740 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db6e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dbbe0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dbbc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dbc00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dbba0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/folders/557385378 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: asset Match folder in folder==========
=== RUN   TestTargetHandler/matching_constraints/asset_Match_folder_in_folder
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00081b8a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00081b880 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00081b8c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00081b860 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00081bd20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00081bd00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00081bd40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00081bce0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/folders/557385378" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: legacy spec match Match folder in folder==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Match_folder_in_folder
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078caa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078ca80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078cac0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078ca60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d020 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d000 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/folders/557385378" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: json Match project in folder==========
=== RUN   TestTargetHandler/matching_constraints/json_Match_project_in_folder
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000696960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000696920 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000696a80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006968e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006979e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000697980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000697a20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000697940 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/projects/557385378 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: asset Match project in folder==========
=== RUN   TestTargetHandler/matching_constraints/asset_Match_project_in_folder
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006e5380 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006e5360 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006e53a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006e5340 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006e5800 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006e57e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006e5820 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006e57c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: legacy spec match Match project in folder==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Match_project_in_folder
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078cf20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078cf00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078cf40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078cee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d6e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d720 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d6c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: json Match project==========
=== RUN   TestTargetHandler/matching_constraints/json_Match_project
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e6ce0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e6cc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e6d00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e6ca0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e7180 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e7160 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e71a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e7140 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/projects/557385378 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: asset Match project==========
=== RUN   TestTargetHandler/matching_constraints/asset_Match_project
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006e8180 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006e8160 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006e81a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006e8140 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006e8600 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006e85e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006e8620 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006e85c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: legacy spec match Match project==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Match_project
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000998dc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000998da0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000998de0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000998d80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000999260 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000999240 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000999280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000999220 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: json Match project by ID, not number==========
=== RUN   TestTargetHandler/matching_constraints/json_Match_project_by_ID,_not_number
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001ccd40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001ccd20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001ccd60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001ccd00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001cd200 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001cd1e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001cd220 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001cd1c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/projects/tfv-test-project asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: asset Match project by ID, not number==========
=== RUN   TestTargetHandler/matching_constraints/asset_Match_project_by_ID,_not_number
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000688a00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006889e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000688a20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006889c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000688e80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000688e60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000688ea0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000688e40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/tfv-test-project" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: legacy spec match Match project by ID, not number==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Match_project_by_ID,_not_number
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064ea40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064ea20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064ea60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064ea00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064eec0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064eea0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064eee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064ee80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/tfv-test-project" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: json Match any project==========
=== RUN   TestTargetHandler/matching_constraints/json_Match_any_project
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000901840 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000901820 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000901860 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000901800 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000900360 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000900340 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000900380 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000900320 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/projects/557385378 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: asset Match any project==========
=== RUN   TestTargetHandler/matching_constraints/asset_Match_any_project
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00055e740 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00055e720 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00055e760 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00055e700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00055ef00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00055eee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00055ef20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00055eec0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: legacy spec match Match any project==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Match_any_project
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005c2160 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005c2060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005c21a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005c2000 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005c2ec0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005c2e80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005c2f20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005c2e00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: json Does not match project==========
=== RUN   TestTargetHandler/matching_constraints/json_Does_not_match_project
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009d52a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009d5280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009d52c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009d5260 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00085a260 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00085a240 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00085a280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00085a220 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/projects/557385378 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========TESTING: asset Does not match project==========
=== RUN   TestTargetHandler/matching_constraints/asset_Does_not_match_project
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c69260 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c69240 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c69280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c69220 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c69700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c696e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c69720 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c696c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========GCP HandleReview==========
==========TESTING: legacy spec match Does not match project==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Does_not_match_project
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a6ee80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a6ee60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a6eea0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a6ee40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a6f320 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a6f300 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a6f340 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a6f2e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========GCP HandleReview==========
==========TESTING: json Match project multiple==========
=== RUN   TestTargetHandler/matching_constraints/json_Match_project_multiple
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db5a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db560 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db5c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dba60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dba40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dba80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dba20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/projects/557385378 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: asset Match project multiple==========
=== RUN   TestTargetHandler/matching_constraints/asset_Match_project_multiple
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00056a980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00056a960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00056a9a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00056a940 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00056ae20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00056ae00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00056ae40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00056ade0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: legacy spec match Match project multiple==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Match_project_multiple
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000776260 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000776240 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000776280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000776220 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007766e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007766c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000776700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007766a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: json Match any project==========
=== RUN   TestTargetHandler/matching_constraints/json_Match_any_project#01
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093820 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093800 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093840 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000937e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093cc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093ca0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093ce0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093c80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/projects/557385378 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: asset Match any project==========
=== RUN   TestTargetHandler/matching_constraints/asset_Match_any_project#01
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009febc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009feba0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009febe0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009feb80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009ff0a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009ff080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009ff0c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009ff060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: legacy spec match Match any project==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Match_any_project#01
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070d240 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070d220 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070d260 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070d200 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070d800 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070d7e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070d820 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00070d7a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: json Exclude project==========
=== RUN   TestTargetHandler/matching_constraints/json_Exclude_project
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b06b40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b06b20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b06b60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b06b00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b06fe0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b06fc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b07000 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b06fa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/projects/557385378 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========TESTING: asset Exclude project==========
=== RUN   TestTargetHandler/matching_constraints/asset_Exclude_project
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008c1b20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008c1b00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008c1b40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008c1ae0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008c1fc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008c1fa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008c1fe0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008c1f80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========GCP HandleReview==========
==========TESTING: legacy spec match Exclude project==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Exclude_project
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dd2a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dd280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dd2c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dd260 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dd740 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dd720 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dd760 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dd700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========GCP HandleReview==========
==========TESTING: json Exclude project by ID, not number==========
=== RUN   TestTargetHandler/matching_constraints/json_Exclude_project_by_ID,_not_number
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077aae0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077aac0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077ab00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077aa80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077af80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077af60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077afa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077af40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/projects/tfv-exclude-project asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========TESTING: asset Exclude project by ID, not number==========
=== RUN   TestTargetHandler/matching_constraints/asset_Exclude_project_by_ID,_not_number
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000668780 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000668760 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006687a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000668740 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000668c00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000668be0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000668c20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000668bc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/tfv-exclude-project" resource:<> 
==========GCP HandleReview==========
==========TESTING: legacy spec match Exclude project by ID, not number==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Exclude_project_by_ID,_not_number
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000790160 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000790140 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000790180 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000790120 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007905e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007905c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000790600 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007905a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/tfv-exclude-project" resource:<> 
==========GCP HandleReview==========
==========TESTING: json Exclude project multiple==========
=== RUN   TestTargetHandler/matching_constraints/json_Exclude_project_multiple
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009d2660 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009d2640 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009d2680 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009d2620 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009d2b00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009d2ae0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009d2b20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009d2ac0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/projects/557385378 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========TESTING: asset Exclude project multiple==========
=== RUN   TestTargetHandler/matching_constraints/asset_Exclude_project_multiple
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001ccf00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001ccee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001ccf20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001ccec0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001cd540 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001cd520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001cd5c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001cd500 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========GCP HandleReview==========
==========TESTING: legacy spec match Exclude project multiple==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Exclude_project_multiple
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c9ca0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c9c40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c9ce0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c9c00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00083eba0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00083eb80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00083ebc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00083eb60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========GCP HandleReview==========
==========TESTING: json Exclude project via wildcard on org==========
=== RUN   TestTargetHandler/matching_constraints/json_Exclude_project_via_wildcard_on_org
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00036e380 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00036e360 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00036e3a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00036e340 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00036e9c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00036e9a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00036e9e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00036e980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/projects/557385378 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========TESTING: asset Exclude project via wildcard on org==========
=== RUN   TestTargetHandler/matching_constraints/asset_Exclude_project_via_wildcard_on_org
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006cd640 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006cd620 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006cd660 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006cd600 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006cdac0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006cdaa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006cdae0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006cda80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/projects/557385378" resource:<> 
==========GCP HandleReview==========
==========TESTING: legacy spec match Exclude project via wildcard on org==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Exclude_project_via_wildcard_on_org
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000878960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000878940 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000878980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000878920 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000878de0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000878dc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000878e00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000878da0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/projects/557385378" resource:<> 
==========GCP HandleReview==========
==========TESTING: json invalid target CRM type==========
=== RUN   TestTargetHandler/matching_constraints/json_invalid_target_CRM_type
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c6180 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c6160 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c61a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c6140 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c6620 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c6600 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c6640 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c65e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========TESTING: asset invalid target CRM type==========
=== RUN   TestTargetHandler/matching_constraints/asset_invalid_target_CRM_type
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b0fc40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b0fc20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b0fc60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b0fc00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a28400 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a283e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a28420 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a283c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========TESTING: legacy spec match invalid target CRM type==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_invalid_target_CRM_type
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a3edc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a3eda0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a3ede0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a3ed80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a3f260 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a3f240 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a3f280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a3f220 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========TESTING: json org after folder==========
=== RUN   TestTargetHandler/matching_constraints/json_org_after_folder
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008e69a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008e6980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008e69c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008e6960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008e6e40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008e6e20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008e6e60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008e6e00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========TESTING: asset org after folder==========
=== RUN   TestTargetHandler/matching_constraints/asset_org_after_folder
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d160 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d140 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d180 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d120 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d940 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d920 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d900 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========TESTING: legacy spec match org after folder==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_org_after_folder
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009c5900 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009c58e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009c5920 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009c58c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009c5da0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009c5d80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009c5dc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009c5d60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========TESTING: json org after project==========
=== RUN   TestTargetHandler/matching_constraints/json_org_after_project
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000838ea0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000838e80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000838ec0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000838e60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000839340 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000839320 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000839360 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000839300 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========TESTING: asset org after project==========
=== RUN   TestTargetHandler/matching_constraints/asset_org_after_project
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000930500 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009304e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000930520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009304c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009309a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000930980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009309c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000930960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========TESTING: legacy spec match org after project==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_org_after_project
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000870fe0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000870fc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000871000 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000870fa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000871480 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000871460 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008714a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000871440 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========TESTING: json folder after project==========
=== RUN   TestTargetHandler/matching_constraints/json_folder_after_project
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b82bc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b82ba0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b82be0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b82b80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b83060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b83040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b83080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b83020 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========TESTING: asset folder after project==========
=== RUN   TestTargetHandler/matching_constraints/asset_folder_after_project
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006df4a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006df480 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006df4c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006df460 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006df940 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006df920 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006df960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006df900 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========TESTING: legacy spec match folder after project==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_folder_after_project
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d000 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078cfe0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d020 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078cfc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d7e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d7c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d800 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d7a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========TESTING: json allow unknown in match parameters==========
=== RUN   TestTargetHandler/matching_constraints/json_allow_unknown_in_match_parameters
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db920 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db900 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db940 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db8e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dbdc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dbda0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dbde0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dbd80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/unknown asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: asset allow unknown in match parameters==========
=== RUN   TestTargetHandler/matching_constraints/asset_allow_unknown_in_match_parameters
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b2be0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b2ba0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b2ca0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b2b60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b3300 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b32e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b3320 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b32c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/unknown" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: legacy spec match allow unknown in match parameters==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_allow_unknown_in_match_parameters
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077a460 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077a440 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077a480 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077a420 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077a980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077a960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077a9a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077a940 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/unknown" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: json organizations/unknown cannot match other random org string==========
=== RUN   TestTargetHandler/matching_constraints/json_organizations/unknown_cannot_match_other_random_org_string
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d000 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078cfe0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d020 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078cfc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d7e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d7c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d800 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00078d7a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/whatever asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========TESTING: asset organizations/unknown cannot match other random org string==========
=== RUN   TestTargetHandler/matching_constraints/asset_organizations/unknown_cannot_match_other_random_org_string
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009568a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000956880 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009568c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000956860 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000956d40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000956d20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000956d60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000956d00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/whatever" resource:<> 
==========GCP HandleReview==========
==========TESTING: legacy spec match organizations/unknown cannot match other random org string==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_organizations/unknown_cannot_match_other_random_org_string
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008d3cc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008d3ca0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008d3ce0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008d3c80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009163c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009163a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009163e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000916380 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/whatever" resource:<> 
==========GCP HandleReview==========
==========TESTING: json only allows unknown as string in match parameter==========
=== RUN   TestTargetHandler/matching_constraints/json_only_allows_unknown_as_string_in_match_parameter
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db9a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db940 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dbe20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dbe00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dbe40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dbde0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========TESTING: asset only allows unknown as string in match parameter==========
=== RUN   TestTargetHandler/matching_constraints/asset_only_allows_unknown_as_string_in_match_parameter
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db320 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db300 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db340 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db2e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db8e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db8c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db900 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db8a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========TESTING: legacy spec match only allows unknown as string in match parameter==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_only_allows_unknown_as_string_in_match_parameter
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000092da0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000092d80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000092dc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000092d60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000936e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000936c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000093700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000936a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========TESTING: json invalid exclude CRM name==========
=== RUN   TestTargetHandler/matching_constraints/json_invalid_exclude_CRM_name
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dae20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dae00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dae40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004dade0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db2c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db2a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db2e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004db280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========TESTING: asset invalid exclude CRM name==========
=== RUN   TestTargetHandler/matching_constraints/asset_invalid_exclude_CRM_name
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e2f00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e2ee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e2f20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e2ec0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e33a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e3380 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e33c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007e3360 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========TESTING: legacy spec match invalid exclude CRM name==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_invalid_exclude_CRM_name
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dc500 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dc4e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dc520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dc4c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dc9a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dc980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dc9c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dc960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========TESTING: json Bad target type==========
=== RUN   TestTargetHandler/matching_constraints/json_Bad_target_type
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00055fa60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00055fa40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00055fa80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00055fa20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00055ff00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00055fee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00055ff20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00055fec0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========TESTING: asset Bad target type==========
=== RUN   TestTargetHandler/matching_constraints/asset_Bad_target_type
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005288c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005288a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005288e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000528880 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000528d60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000528d40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000528d80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000528d20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========TESTING: legacy spec match Bad target type==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Bad_target_type
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000528fc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000528fa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000528fe0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000528f80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000529440 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000529420 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000529480 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000529400 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========TESTING: json Bad target item type==========
=== RUN   TestTargetHandler/matching_constraints/json_Bad_target_item_type
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000647ca0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000647c60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000647cc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000647c20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000662480 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000662460 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006624a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000662440 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========TESTING: asset Bad target item type==========
=== RUN   TestTargetHandler/matching_constraints/asset_Bad_target_item_type
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008dc5c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008dc5a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008dc5e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008dc540 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008dcd40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008dcd20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008dcd60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008dcd00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========TESTING: legacy spec match Bad target item type==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Bad_target_item_type
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000691ba0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000691b80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000691bc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000691b60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00079a020 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00079a000 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00079a040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000691fe0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========TESTING: json Bad exclude type==========
=== RUN   TestTargetHandler/matching_constraints/json_Bad_exclude_type
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007ba660 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007ba640 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007ba680 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007ba620 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007bab00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007baae0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007bab20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007baac0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========TESTING: asset Bad exclude type==========
=== RUN   TestTargetHandler/matching_constraints/asset_Bad_exclude_type
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001cc400 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001cc3e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001cc420 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001cc3c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001ccd00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001ccce0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001ccd20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001cccc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========TESTING: legacy spec match Bad exclude type==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Bad_exclude_type
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000691840 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006917e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006918a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000691780 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00076e640 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00076e5e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00076e6e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00076e580 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========TESTING: json Bad exclude item type==========
=== RUN   TestTargetHandler/matching_constraints/json_Bad_exclude_item_type
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009fef20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009fef00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009fef40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009feee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009ff3c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009ff3a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009ff3e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009ff380 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========TESTING: asset Bad exclude item type==========
=== RUN   TestTargetHandler/matching_constraints/asset_Bad_exclude_item_type
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dd0e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dd0c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dd100 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dd0a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dd580 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dd560 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dd5a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dd540 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========TESTING: legacy spec match Bad exclude item type==========
=== RUN   TestTargetHandler/matching_constraints/legacy_spec_match_Bad_exclude_item_type
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000559540 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000559520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000559560 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000559500 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005599e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005599c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000559a00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005599a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========TESTING: json target and ancestries should conflict==========
=== RUN   TestTargetHandler/matching_constraints/json_target_and_ancestries_should_conflict
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00057aba0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00057ab80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00057abc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00057ab60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00057b020 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00057b000 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00057b040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00057afe0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========TESTING: asset target and ancestries should conflict==========
=== RUN   TestTargetHandler/matching_constraints/asset_target_and_ancestries_should_conflict
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00057a060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00057a040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00057a080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00057a020 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00057a5c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00057a5a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00057a600 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00057a580 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========TESTING: json exclude and excludedAncestries should conflict==========
=== RUN   TestTargetHandler/matching_constraints/json_exclude_and_excludedAncestries_should_conflict
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000824ee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000824ec0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000824f00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000824ea0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008255e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008255a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000825620 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000825560 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========TESTING: asset exclude and excludedAncestries should conflict==========
=== RUN   TestTargetHandler/matching_constraints/asset_exclude_and_excludedAncestries_should_conflict
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000794a80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000794a60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000794ac0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000794a40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000794f40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000794f20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000794f60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000794f00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========TESTING: json target should warn==========
=== RUN   TestTargetHandler/matching_constraints/json_target_should_warn
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000825800 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008257c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000825820 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008257a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000825e40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000825e20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000825e60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000825e00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/projects/557385378 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: asset target should warn==========
=== RUN   TestTargetHandler/matching_constraints/asset_target_should_warn
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c0440 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c0420 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c0460 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c0400 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c08c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c08a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c08e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007c0880 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========TESTING: json exclude should warn==========
=== RUN   TestTargetHandler/matching_constraints/json_exclude_should_warn
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b39ac0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b39aa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b39ae0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b39a80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b39f60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b39f40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b39f80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b39f20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
map[ancestry_path:organizations/123454321/folders/1221214/projects/557385378 asset_type:test-asset-type name:test-name resource:map[]]
==========GCP HandleReview==========
==========TESTING: asset exclude should warn==========
=== RUN   TestTargetHandler/matching_constraints/asset_exclude_should_warn
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dcae0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dcac0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dcb00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dcaa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dcf80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dcf60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dcfa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dcf40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
========== REVIEW OBJ ==========
ancestry_path:"organizations/123454321/folders/1221214/projects/557385378" resource:<> 
==========GCP HandleReview==========
--- PASS: TestTargetHandler (1.46s)
    --- PASS: TestTargetHandler/matching_constraints (1.45s)
        --- PASS: TestTargetHandler/matching_constraints/json_Null_match_object_(matches_anything) (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Null_match_object_(matches_anything) (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Null_match_object_(matches_anything) (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_No_match_specified_(matches_anything) (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_No_match_specified_(matches_anything) (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_No_match_specified_(matches_anything) (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Only_match_once. (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Only_match_once. (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Only_match_once. (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_organizations/**_can_match_organizations/unknown (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_organizations/**_can_match_organizations/unknown (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_organizations/**_can_match_organizations/unknown (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_organizations/*_can_match_organizations/unknown (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_organizations/*_can_match_organizations/unknown (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_organizations/*_can_match_organizations/unknown (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_organizations/*_can_NOT_match_organizations/unknown_with_descendents (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_organizations/*_can_NOT_match_organizations/unknown_with_descendents (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_organizations/*_can_NOT_match_organizations/unknown_with_descendents (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_**_can_match_organizations/unknown. (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_**_can_match_organizations/unknown. (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_**_can_match_organizations/unknown. (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_*_can_NOT_match_organizations/unknown. (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_*_can_NOT_match_organizations/unknown. (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_*_can_NOT_match_organizations/unknown. (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Match_org_on_exact_ID (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Match_org_on_exact_ID (0.02s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Match_org_on_exact_ID (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Does_not_match_org_for_descendant_match (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Does_not_match_org_for_descendant_match (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Does_not_match_org_for_descendant_match (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_No_match_org_on_close_ID (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_No_match_org_on_close_ID (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_No_match_org_on_close_ID (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Match_all_under_org_ID_-_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Match_all_under_org_ID_-_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Match_all_under_org_ID_-_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Match_all_under_org_ID_-_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Match_all_under_org_ID_-_project (0.02s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Match_all_under_org_ID_-_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Match_all_under_org_ID_-_folder,_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Match_all_under_org_ID_-_folder,_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Match_all_under_org_ID_-_folder,_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_No_match_folder_on_descendants (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_No_match_folder_on_descendants (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_No_match_folder_on_descendants (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_No_match_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_No_match_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_No_match_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_No_match_under_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_No_match_under_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_No_match_under_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Match_folder_in_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Match_folder_in_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Match_folder_in_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Match_project_in_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Match_project_in_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Match_project_in_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Match_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Match_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Match_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Match_project_by_ID,_not_number (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Match_project_by_ID,_not_number (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Match_project_by_ID,_not_number (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Match_any_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Match_any_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Match_any_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Does_not_match_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Does_not_match_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Does_not_match_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Match_project_multiple (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Match_project_multiple (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Match_project_multiple (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Match_any_project#01 (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Match_any_project#01 (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Match_any_project#01 (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Exclude_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Exclude_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Exclude_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Exclude_project_by_ID,_not_number (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Exclude_project_by_ID,_not_number (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Exclude_project_by_ID,_not_number (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Exclude_project_multiple (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Exclude_project_multiple (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Exclude_project_multiple (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Exclude_project_via_wildcard_on_org (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Exclude_project_via_wildcard_on_org (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Exclude_project_via_wildcard_on_org (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_invalid_target_CRM_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_invalid_target_CRM_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_invalid_target_CRM_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_org_after_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_org_after_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_org_after_folder (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_org_after_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_org_after_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_org_after_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_folder_after_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_folder_after_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_folder_after_project (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_allow_unknown_in_match_parameters (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_allow_unknown_in_match_parameters (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_allow_unknown_in_match_parameters (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_organizations/unknown_cannot_match_other_random_org_string (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_organizations/unknown_cannot_match_other_random_org_string (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_organizations/unknown_cannot_match_other_random_org_string (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_only_allows_unknown_as_string_in_match_parameter (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_only_allows_unknown_as_string_in_match_parameter (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_only_allows_unknown_as_string_in_match_parameter (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_invalid_exclude_CRM_name (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_invalid_exclude_CRM_name (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_invalid_exclude_CRM_name (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Bad_target_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Bad_target_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Bad_target_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Bad_target_item_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Bad_target_item_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Bad_target_item_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Bad_exclude_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Bad_exclude_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Bad_exclude_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_Bad_exclude_item_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_Bad_exclude_item_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/legacy_spec_match_Bad_exclude_item_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_target_and_ancestries_should_conflict (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_target_and_ancestries_should_conflict (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_exclude_and_excludedAncestries_should_conflict (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_exclude_and_excludedAncestries_should_conflict (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_target_should_warn (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_target_should_warn (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/json_exclude_should_warn (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/asset_exclude_should_warn (0.01s)
PASS
ok  	github.com/GoogleCloudPlatform/config-validator/pkg/gcptarget	1.477s
=== RUN   TestReview
=== RUN   TestReview/no_assets
=== RUN   TestReview/error
=== RUN   TestReview/single_call
=== RUN   TestReview/single_call_three_assets
=== RUN   TestReview/128_goroutines_x32_calls_x16_scale
=== RUN   TestReview/single_call_large_scale_deadlock_test
--- PASS: TestReview (0.00s)
    --- PASS: TestReview/no_assets (0.00s)
    --- PASS: TestReview/error (0.00s)
    --- PASS: TestReview/single_call (0.00s)
    --- PASS: TestReview/single_call_three_assets (0.00s)
    --- PASS: TestReview/128_goroutines_x32_calls_x16_scale (0.00s)
    --- PASS: TestReview/single_call_large_scale_deadlock_test (0.00s)
=== RUN   TestConversion
TESTING CONFIGURATION
constraints.gatekeeper.sh/v1beta1, Kind=K8sRequiredLabels
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=CFGCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=GCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1beta1, Kind=TFComputeInstanceMachineTypeAllowlistConstraintV1
CONSTRAINT GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {cfhttpsendv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:cf-http-send-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/invalid_templates/cf_http_send_v1.yaml] [] []  []} {{{{CFHttpSendV1 []} 0xc0000140d0}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.cf.HttpSendV1

deny[{
	"msg": message,
	"details": metadata,
}] {
	response := http.send({
		"method": "GET",
		"url": "https://compute.googleapis.com/compute/v1/projects",
		"headers": {"Accept": "application/json", "Content-Type": "application/json"},
	})

	message := sprintf("I'm doing something forbidden! %s", [input.asset.name])
	metadata := {}
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {cfgcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/cf_gcp_storage_logging_template.yaml] [] []  []} {{{{CFGCPStorageLoggingConstraint []} 0xc000014548}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

violation[{
	"msg": message,
	"details": metadata,
}] {
	asset := input.review
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := get_default(bucket, "logging", "default")
	destination_bucket := get_default(destination, "logBucket", "")
}

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
 	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
 []}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpbigquerydatasetlocationconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-bigquery-dataset-location-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_bq_dataset_location_v1.yaml] [] []  []} {{{{GCPBigQueryDatasetLocationConstraintV1 []} 0xc000286728}} [{validation.gcp.forsetisecurity.org #

# Copyright 2019 Google LLC

#

# Licensed under the Apache License, Version 2.0 (the "License");

# you may not use this file except in compliance with the License.

# You may obtain a copy of the License at

#

#      http://www.apache.org/licenses/LICENSE-2.0

#

# Unless required by applicable law or agreed to in writing, software

# distributed under the License is distributed on an "AS IS" BASIS,

# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

# See the License for the specific language governing permissions and

# limitations under the License.

#

package templates.gcp.GCPBigQueryDatasetLocationConstraintV1

import data.lib.validator.gcp.lib as lib

############################################

# Find BigQuery Dataset Location Violations

############################################

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint

	lib.get_constraint_params(constraint, params)

	# Verify that resource is BigQuery dataset

	asset := input.asset

	asset.asset_type == "bigquery.googleapis.com/Dataset"

	# Check if resource is in exempt list

	exempt_list := params.exemptions

	matches := {asset.name} & cast_set(exempt_list)

	count(matches) == 0

	# Check that location is in allowlist/denylist

	target_locations := params.locations

	asset_location := asset.resource.data.location

	location_matches := {asset_location} & cast_set(target_locations)

	target_location_match_count(params.mode, desired_count)

	count(location_matches) == desired_count

	message := sprintf("%v is in a disallowed location.", [asset.name])

	metadata := {"location": asset_location}
}

#################

# Rule Utilities

#################

# Determine the overlap between locations under test and constraint

# By default (allowlist), we violate if there isn't overlap

target_location_match_count(mode) = 0 {
	mode != "denylist"
}

target_location_match_count(mode) = 1 {
	mode == "denylist"
}

#ENDINLINE

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-storage-logging validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_storage_logging_template.yaml] [] []  []} {{{{GCPStorageLoggingConstraint []} 0xc000287310}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint
	asset := input.asset
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := object.get(bucket, "logging", "default")
	destination_bucket := object.get(destination, "logBucket", "")
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
Type of &{0xc000123770 0xc000014450 false} is *client.Backend
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
Type of &{0xc0004ec6a0 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00068d9c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00068d9a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00068d9e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00068d980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00068de60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00068de40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00068de80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00068de20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000aedf60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000aedf40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000aedf80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000aedf20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b1e3e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b1e3c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b1e400 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b1e3a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000357a60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000357a20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000357a80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000357a00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004ec280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004ec240 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004ec2a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004ec220 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b5f500 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b5f4e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b5f520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b5f4c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b5f980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b5f960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b5f9a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b5f940 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========GCP ValidateConstraint==========
2022/10/16 17:34:21 spec.match.target is deprecated and will be removed in a future release. Use spec.match.ancestries instead
2022/10/16 17:34:21 spec.match.exclude is deprecated and will be removed in a future release. Use spec.match.excludedAncestries instead
========== CFCLIENT ==========
&{0xc0004ec6a0 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[cfgcpstorageloggingconstraint:0xc000b6bc80 cfhttpsendv1:0xc000b10ff0 gcpbigquerydatasetlocationconstraintv1:0xc000ba6540 gcpstorageloggingconstraint:0xc000693f80] map[{constraints.gatekeeper.sh CFGCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/CFGCPStorageLoggingConstraint/require-storage-logging:0xc00011f9f8] {constraints.gatekeeper.sh CFHttpSendV1}:map[] {constraints.gatekeeper.sh GCPBigQueryDatasetLocationConstraintV1}:map[] {constraints.gatekeeper.sh GCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/GCPStorageLoggingConstraint/require-storage-logging-xx:0xc00011fa00]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {k8srequiredlabels      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/k8srequiredlabels_template.yaml] [] []  []} {{{{K8sRequiredLabels []} 0xc000287a58}} [{admission.k8s.gatekeeper.sh package k8srequiredlabels

violation[{"msg": msg, "details": {"missing_labels": missing}}] {
  provided := {label | input.review.object.metadata.labels[label]}
  required := {label | label := input.parameters.labels[_]}
  missing := required - provided
  count(missing) > 0
  msg := sprintf("you must provide labels: %v", [missing])
}
 []}]} {false []}}
Type of &{0xc000c2ba40 0xc00011fb58 false} is *client.Backend
Type of &{0xc000a862a0 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc000a862a0 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[k8srequiredlabels:0xc000cc8a50] map[{constraints.gatekeeper.sh K8sRequiredLabels}:map[/cluster/constraints.gatekeeper.sh/K8sRequiredLabels/namespace-cost-center-label:0xc000ef87b0]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {tfcomputeinstancemachinetypeallowlistconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/tf_compute_instance_machine_type.yaml] [] []  []} {{{{TFComputeInstanceMachineTypeAllowlistConstraintV1 []} 0xc0000142f0}} [{validation.resourcechange.terraform.cloud.google.com #
# Copyright 2019 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.terraform.TFComputeInstanceMachineTypeAllowlistConstraintV1

violation[{
	"msg": message,
	"details": metadata,
}] {
  resource := input.review
  resource.type == "google_compute_instance"

  action_types := {x | x := resource.change.actions[_]}
  validated_action_types := {"create", "update"}
  count(action_types & validated_action_types) >=1

  instance := resource.change.after

  allowlist := object.get(input.parameters, "allowlist", [])
  allowed_machine_types := {n | n = allowlist[_]}

  machine_type := instance.machine_type

  is_machine_type_allowlisted := count({machine_type} - allowed_machine_types) == 0

  is_machine_type_allowlisted == false

  message := sprintf("Compute instance %s has interface has invalid machine_type: %s", [resource.address, machine_type])
  metadata := {"resource": resource.name}

}
 []}]} {false []}}
Type of &{0xc000cfb450 0xc000ef8858 false} is *client.Backend
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
Type of &{0xc000a9a860 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ac3780 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ac37a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c540e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c54100 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TFComputeInstanceMachineTypeAllowlistConstraintV1 metadata:map[annotations:map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/constraints/tf_compute_instance_mt_constraint.yaml] name:must-have-machine-type-e2-medium] spec:map[match:map[addresses:[**]] parameters:map[allowlist:[e2-medium]] severity:medium]]
INCLUDES
[**]
FOUND
true
ERR
<nil>
========== CFCLIENT ==========
&{0xc000a9a860 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[tfcomputeinstancemachinetypeallowlistconstraintv1:0xc000e8ff20] map[{constraints.gatekeeper.sh TFComputeInstanceMachineTypeAllowlistConstraintV1}:map[/cluster/constraints.gatekeeper.sh/TFComputeInstanceMachineTypeAllowlistConstraintV1/must-have-machine-type-e2-medium:0xc000731238]] [inventory]}
========== TEMPLATES ==========

Type of &{0xc000c82320 0xc0007312e0 false} is *client.Backend
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
Type of &{0xc000e951c0 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc000e951c0 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]}
=== RUN   TestConversion/storageAssetNoLoggingJSON
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========GCP HandleViolation==========
--- PASS: TestConversion (0.10s)
    --- PASS: TestConversion/storageAssetNoLoggingJSON (0.00s)
=== RUN   TestCreateValidatorWithNoOptions
--- PASS: TestCreateValidatorWithNoOptions (0.00s)
=== RUN   TestDefaultTestDataCreatesValidator
TESTING CONFIGURATION
constraints.gatekeeper.sh/v1beta1, Kind=K8sRequiredLabels
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=CFGCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=GCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1beta1, Kind=TFComputeInstanceMachineTypeAllowlistConstraintV1
CONSTRAINT GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {cfhttpsendv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:cf-http-send-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/invalid_templates/cf_http_send_v1.yaml] [] []  []} {{{{CFHttpSendV1 []} 0xc0006eb1c8}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.cf.HttpSendV1

deny[{
	"msg": message,
	"details": metadata,
}] {
	response := http.send({
		"method": "GET",
		"url": "https://compute.googleapis.com/compute/v1/projects",
		"headers": {"Accept": "application/json", "Content-Type": "application/json"},
	})

	message := sprintf("I'm doing something forbidden! %s", [input.asset.name])
	metadata := {}
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {cfgcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/cf_gcp_storage_logging_template.yaml] [] []  []} {{{{CFGCPStorageLoggingConstraint []} 0xc0006eb4c8}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

violation[{
	"msg": message,
	"details": metadata,
}] {
	asset := input.review
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := get_default(bucket, "logging", "default")
	destination_bucket := get_default(destination, "logBucket", "")
}

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
 	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
 []}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpbigquerydatasetlocationconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-bigquery-dataset-location-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_bq_dataset_location_v1.yaml] [] []  []} {{{{GCPBigQueryDatasetLocationConstraintV1 []} 0xc0006eb720}} [{validation.gcp.forsetisecurity.org #

# Copyright 2019 Google LLC

#

# Licensed under the Apache License, Version 2.0 (the "License");

# you may not use this file except in compliance with the License.

# You may obtain a copy of the License at

#

#      http://www.apache.org/licenses/LICENSE-2.0

#

# Unless required by applicable law or agreed to in writing, software

# distributed under the License is distributed on an "AS IS" BASIS,

# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

# See the License for the specific language governing permissions and

# limitations under the License.

#

package templates.gcp.GCPBigQueryDatasetLocationConstraintV1

import data.lib.validator.gcp.lib as lib

############################################

# Find BigQuery Dataset Location Violations

############################################

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint

	lib.get_constraint_params(constraint, params)

	# Verify that resource is BigQuery dataset

	asset := input.asset

	asset.asset_type == "bigquery.googleapis.com/Dataset"

	# Check if resource is in exempt list

	exempt_list := params.exemptions

	matches := {asset.name} & cast_set(exempt_list)

	count(matches) == 0

	# Check that location is in allowlist/denylist

	target_locations := params.locations

	asset_location := asset.resource.data.location

	location_matches := {asset_location} & cast_set(target_locations)

	target_location_match_count(params.mode, desired_count)

	count(location_matches) == desired_count

	message := sprintf("%v is in a disallowed location.", [asset.name])

	metadata := {"location": asset_location}
}

#################

# Rule Utilities

#################

# Determine the overlap between locations under test and constraint

# By default (allowlist), we violate if there isn't overlap

target_location_match_count(mode) = 0 {
	mode != "denylist"
}

target_location_match_count(mode) = 1 {
	mode == "denylist"
}

#ENDINLINE

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-storage-logging validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_storage_logging_template.yaml] [] []  []} {{{{GCPStorageLoggingConstraint []} 0xc000ef8640}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint
	asset := input.asset
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := object.get(bucket, "logging", "default")
	destination_bucket := object.get(destination, "logBucket", "")
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
Type of &{0xc0004d1b80 0xc0007307c0 false} is *client.Backend
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
Type of &{0xc000ea8b00 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000af3fe0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000af3fc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b443a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000af3fa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b44820 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b44800 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b44840 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b447e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000636d60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000636d40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000636d80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000636d20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006371e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006371c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000637200 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006371a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c06de0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c06dc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c06e00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c06da0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c074a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c07480 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c074c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c07460 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008f2b60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008f2b20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008f2ba0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008f2b00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008f3220 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008f3200 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008f3280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008f31e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========GCP ValidateConstraint==========
2022/10/16 17:34:21 spec.match.target is deprecated and will be removed in a future release. Use spec.match.ancestries instead
2022/10/16 17:34:21 spec.match.exclude is deprecated and will be removed in a future release. Use spec.match.excludedAncestries instead
========== CFCLIENT ==========
&{0xc000ea8b00 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[cfgcpstorageloggingconstraint:0xc000c151d0 cfhttpsendv1:0xc0006bb2c0 gcpbigquerydatasetlocationconstraintv1:0xc00003fbc0 gcpstorageloggingconstraint:0xc0008b22d0] map[{constraints.gatekeeper.sh CFGCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/CFGCPStorageLoggingConstraint/require-storage-logging:0xc000731a28] {constraints.gatekeeper.sh CFHttpSendV1}:map[] {constraints.gatekeeper.sh GCPBigQueryDatasetLocationConstraintV1}:map[] {constraints.gatekeeper.sh GCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/GCPStorageLoggingConstraint/require-storage-logging-xx:0xc000731a30]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {k8srequiredlabels      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/k8srequiredlabels_template.yaml] [] []  []} {{{{K8sRequiredLabels []} 0xc000ef8d88}} [{admission.k8s.gatekeeper.sh package k8srequiredlabels

violation[{"msg": msg, "details": {"missing_labels": missing}}] {
  provided := {label | input.review.object.metadata.labels[label]}
  required := {label | label := input.parameters.labels[_]}
  missing := required - provided
  count(missing) > 0
  msg := sprintf("you must provide labels: %v", [missing])
}
 []}]} {false []}}
Type of &{0xc0006b7860 0xc000731ad8 false} is *client.Backend
Type of &{0xc0004eda80 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc0004eda80 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[k8srequiredlabels:0xc000d021b0] map[{constraints.gatekeeper.sh K8sRequiredLabels}:map[/cluster/constraints.gatekeeper.sh/K8sRequiredLabels/namespace-cost-center-label:0xc000014860]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {tfcomputeinstancemachinetypeallowlistconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/tf_compute_instance_machine_type.yaml] [] []  []} {{{{TFComputeInstanceMachineTypeAllowlistConstraintV1 []} 0xc0007306f8}} [{validation.resourcechange.terraform.cloud.google.com #
# Copyright 2019 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.terraform.TFComputeInstanceMachineTypeAllowlistConstraintV1

violation[{
	"msg": message,
	"details": metadata,
}] {
  resource := input.review
  resource.type == "google_compute_instance"

  action_types := {x | x := resource.change.actions[_]}
  validated_action_types := {"create", "update"}
  count(action_types & validated_action_types) >=1

  instance := resource.change.after

  allowlist := object.get(input.parameters, "allowlist", [])
  allowed_machine_types := {n | n = allowlist[_]}

  machine_type := instance.machine_type

  is_machine_type_allowlisted := count({machine_type} - allowed_machine_types) == 0

  is_machine_type_allowlisted == false

  message := sprintf("Compute instance %s has interface has invalid machine_type: %s", [resource.address, machine_type])
  metadata := {"resource": resource.name}

}
 []}]} {false []}}
Type of &{0xc0008b4be0 0xc000014908 false} is *client.Backend
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
Type of &{0xc000d10f20 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000357be0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000357c00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004ec080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004ec0a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TFComputeInstanceMachineTypeAllowlistConstraintV1 metadata:map[annotations:map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/constraints/tf_compute_instance_mt_constraint.yaml] name:must-have-machine-type-e2-medium] spec:map[match:map[addresses:[**]] parameters:map[allowlist:[e2-medium]] severity:medium]]
INCLUDES
[**]
FOUND
true
ERR
<nil>
========== CFCLIENT ==========
&{0xc000d10f20 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[tfcomputeinstancemachinetypeallowlistconstraintv1:0xc0009cc2d0] map[{constraints.gatekeeper.sh TFComputeInstanceMachineTypeAllowlistConstraintV1}:map[/cluster/constraints.gatekeeper.sh/TFComputeInstanceMachineTypeAllowlistConstraintV1/must-have-machine-type-e2-medium:0xc0006eb100]] [inventory]}
========== TEMPLATES ==========

Type of &{0xc000f92a00 0xc0006eb1a8 false} is *client.Backend
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
Type of &{0xc0008f3460 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc0008f3460 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]}
--- PASS: TestDefaultTestDataCreatesValidator (0.09s)
=== RUN   TestDefaultTestDataWithDisabledBuiltins
TESTING CONFIGURATION
constraints.gatekeeper.sh/v1beta1, Kind=K8sRequiredLabels
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=CFGCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=GCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1beta1, Kind=TFComputeInstanceMachineTypeAllowlistConstraintV1
CONSTRAINT GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {cfhttpsendv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:cf-http-send-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/invalid_templates/cf_http_send_v1.yaml] [] []  []} {{{{CFHttpSendV1 []} 0xc00042f8c8}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.cf.HttpSendV1

deny[{
	"msg": message,
	"details": metadata,
}] {
	response := http.send({
		"method": "GET",
		"url": "https://compute.googleapis.com/compute/v1/projects",
		"headers": {"Accept": "application/json", "Content-Type": "application/json"},
	})

	message := sprintf("I'm doing something forbidden! %s", [input.asset.name])
	metadata := {}
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {cfgcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/cf_gcp_storage_logging_template.yaml] [] []  []} {{{{CFGCPStorageLoggingConstraint []} 0xc00042fc98}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

violation[{
	"msg": message,
	"details": metadata,
}] {
	asset := input.review
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := get_default(bucket, "logging", "default")
	destination_bucket := get_default(destination, "logBucket", "")
}

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
 	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
 []}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpbigquerydatasetlocationconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-bigquery-dataset-location-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_bq_dataset_location_v1.yaml] [] []  []} {{{{GCPBigQueryDatasetLocationConstraintV1 []} 0xc000eeb7e8}} [{validation.gcp.forsetisecurity.org #

# Copyright 2019 Google LLC

#

# Licensed under the Apache License, Version 2.0 (the "License");

# you may not use this file except in compliance with the License.

# You may obtain a copy of the License at

#

#      http://www.apache.org/licenses/LICENSE-2.0

#

# Unless required by applicable law or agreed to in writing, software

# distributed under the License is distributed on an "AS IS" BASIS,

# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

# See the License for the specific language governing permissions and

# limitations under the License.

#

package templates.gcp.GCPBigQueryDatasetLocationConstraintV1

import data.lib.validator.gcp.lib as lib

############################################

# Find BigQuery Dataset Location Violations

############################################

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint

	lib.get_constraint_params(constraint, params)

	# Verify that resource is BigQuery dataset

	asset := input.asset

	asset.asset_type == "bigquery.googleapis.com/Dataset"

	# Check if resource is in exempt list

	exempt_list := params.exemptions

	matches := {asset.name} & cast_set(exempt_list)

	count(matches) == 0

	# Check that location is in allowlist/denylist

	target_locations := params.locations

	asset_location := asset.resource.data.location

	location_matches := {asset_location} & cast_set(target_locations)

	target_location_match_count(params.mode, desired_count)

	count(location_matches) == desired_count

	message := sprintf("%v is in a disallowed location.", [asset.name])

	metadata := {"location": asset_location}
}

#################

# Rule Utilities

#################

# Determine the overlap between locations under test and constraint

# By default (allowlist), we violate if there isn't overlap

target_location_match_count(mode) = 0 {
	mode != "denylist"
}

target_location_match_count(mode) = 1 {
	mode == "denylist"
}

#ENDINLINE

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-storage-logging validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_storage_logging_template.yaml] [] []  []} {{{{GCPStorageLoggingConstraint []} 0xc00011f288}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint
	asset := input.asset
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := object.get(bucket, "logging", "default")
	destination_bucket := object.get(destination, "logBucket", "")
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
Type of &{0xc0004d19a0 0xc000eeace0 false} is *client.Backend
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
Type of &{0xc000ed86c0 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c07400 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c073e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c07420 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c073c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c078c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c078a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c078e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c07880 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000966640 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000966620 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000966660 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000966600 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000966ae0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000966ac0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000966b00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000966aa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008dfba0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008dfb80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008dfbc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008dfb60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a3e260 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a3e240 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a3e280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a3e220 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000abfa40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000abfa20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000abfa60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000abfa00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000abfee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000abfec0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000abff00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000abfea0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
--- PASS: TestDefaultTestDataWithDisabledBuiltins (0.05s)
=== RUN   TestDefaultTestDataCreatesValidatorFromContents
TESTING CONFIGURATION
constraints.gatekeeper.sh/v1beta1, Kind=K8sRequiredLabels
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=CFGCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=GCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1beta1, Kind=TFComputeInstanceMachineTypeAllowlistConstraintV1
CONSTRAINT GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {cfhttpsendv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:cf-http-send-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/invalid_templates/cf_http_send_v1.yaml] [] []  []} {{{{CFHttpSendV1 []} 0xc0006eafd8}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.cf.HttpSendV1

deny[{
	"msg": message,
	"details": metadata,
}] {
	response := http.send({
		"method": "GET",
		"url": "https://compute.googleapis.com/compute/v1/projects",
		"headers": {"Accept": "application/json", "Content-Type": "application/json"},
	})

	message := sprintf("I'm doing something forbidden! %s", [input.asset.name])
	metadata := {}
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {cfgcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/cf_gcp_storage_logging_template.yaml] [] []  []} {{{{CFGCPStorageLoggingConstraint []} 0xc0006eb2e0}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

violation[{
	"msg": message,
	"details": metadata,
}] {
	asset := input.review
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := get_default(bucket, "logging", "default")
	destination_bucket := get_default(destination, "logBucket", "")
}

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
 	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
 []}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpbigquerydatasetlocationconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-bigquery-dataset-location-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_bq_dataset_location_v1.yaml] [] []  []} {{{{GCPBigQueryDatasetLocationConstraintV1 []} 0xc000730f60}} [{validation.gcp.forsetisecurity.org #

# Copyright 2019 Google LLC

#

# Licensed under the Apache License, Version 2.0 (the "License");

# you may not use this file except in compliance with the License.

# You may obtain a copy of the License at

#

#      http://www.apache.org/licenses/LICENSE-2.0

#

# Unless required by applicable law or agreed to in writing, software

# distributed under the License is distributed on an "AS IS" BASIS,

# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

# See the License for the specific language governing permissions and

# limitations under the License.

#

package templates.gcp.GCPBigQueryDatasetLocationConstraintV1

import data.lib.validator.gcp.lib as lib

############################################

# Find BigQuery Dataset Location Violations

############################################

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint

	lib.get_constraint_params(constraint, params)

	# Verify that resource is BigQuery dataset

	asset := input.asset

	asset.asset_type == "bigquery.googleapis.com/Dataset"

	# Check if resource is in exempt list

	exempt_list := params.exemptions

	matches := {asset.name} & cast_set(exempt_list)

	count(matches) == 0

	# Check that location is in allowlist/denylist

	target_locations := params.locations

	asset_location := asset.resource.data.location

	location_matches := {asset_location} & cast_set(target_locations)

	target_location_match_count(params.mode, desired_count)

	count(location_matches) == desired_count

	message := sprintf("%v is in a disallowed location.", [asset.name])

	metadata := {"location": asset_location}
}

#################

# Rule Utilities

#################

# Determine the overlap between locations under test and constraint

# By default (allowlist), we violate if there isn't overlap

target_location_match_count(mode) = 0 {
	mode != "denylist"
}

target_location_match_count(mode) = 1 {
	mode == "denylist"
}

#ENDINLINE

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-storage-logging validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_storage_logging_template.yaml] [] []  []} {{{{GCPStorageLoggingConstraint []} 0xc00042f9f0}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint
	asset := input.asset
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := object.get(bucket, "logging", "default")
	destination_bucket := object.get(destination, "logBucket", "")
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
Type of &{0xc0004d1400 0xc0007300e0 false} is *client.Backend
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
Type of &{0xc0004ecd80 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000634ae0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000634ac0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000634b00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000634aa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000634f60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000634f40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000634f80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000634f20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b41060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b41040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b41080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b41020 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b414e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b414c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b41500 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b414a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00071ae80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00071ae60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00071aea0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00071ae40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00071b540 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00071b520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00071b560 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00071b500 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000abfb00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000abfae0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000abfb20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000abfac0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000abffa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000abff80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000abffc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000abff60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========GCP ValidateConstraint==========
2022/10/16 17:34:22 spec.match.target is deprecated and will be removed in a future release. Use spec.match.ancestries instead
2022/10/16 17:34:22 spec.match.exclude is deprecated and will be removed in a future release. Use spec.match.excludedAncestries instead
========== CFCLIENT ==========
&{0xc0004ecd80 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[cfgcpstorageloggingconstraint:0xc0005a49c0 cfhttpsendv1:0xc000b5d6b0 gcpbigquerydatasetlocationconstraintv1:0xc000a414d0 gcpstorageloggingconstraint:0xc000ab1bf0] map[{constraints.gatekeeper.sh CFGCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/CFGCPStorageLoggingConstraint/require-storage-logging:0xc0008d3b08] {constraints.gatekeeper.sh CFHttpSendV1}:map[] {constraints.gatekeeper.sh GCPBigQueryDatasetLocationConstraintV1}:map[] {constraints.gatekeeper.sh GCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/GCPStorageLoggingConstraint/require-storage-logging-xx:0xc0008d3b10]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {k8srequiredlabels      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/k8srequiredlabels_template.yaml] [] []  []} {{{{K8sRequiredLabels []} 0xc000730170}} [{admission.k8s.gatekeeper.sh package k8srequiredlabels

violation[{"msg": msg, "details": {"missing_labels": missing}}] {
  provided := {label | input.review.object.metadata.labels[label]}
  required := {label | label := input.parameters.labels[_]}
  missing := required - provided
  count(missing) > 0
  msg := sprintf("you must provide labels: %v", [missing])
}
 []}]} {false []}}
Type of &{0xc000b3c410 0xc0008d3bb8 false} is *client.Backend
Type of &{0xc000b605a0 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc000b605a0 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[k8srequiredlabels:0xc000ca2b70] map[{constraints.gatekeeper.sh K8sRequiredLabels}:map[/cluster/constraints.gatekeeper.sh/K8sRequiredLabels/namespace-cost-center-label:0xc0007312d0]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {tfcomputeinstancemachinetypeallowlistconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/tf_compute_instance_machine_type.yaml] [] []  []} {{{{TFComputeInstanceMachineTypeAllowlistConstraintV1 []} 0xc000730018}} [{validation.resourcechange.terraform.cloud.google.com #
# Copyright 2019 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.terraform.TFComputeInstanceMachineTypeAllowlistConstraintV1

violation[{
	"msg": message,
	"details": metadata,
}] {
  resource := input.review
  resource.type == "google_compute_instance"

  action_types := {x | x := resource.change.actions[_]}
  validated_action_types := {"create", "update"}
  count(action_types & validated_action_types) >=1

  instance := resource.change.after

  allowlist := object.get(input.parameters, "allowlist", [])
  allowed_machine_types := {n | n = allowlist[_]}

  machine_type := instance.machine_type

  is_machine_type_allowlisted := count({machine_type} - allowed_machine_types) == 0

  is_machine_type_allowlisted == false

  message := sprintf("Compute instance %s has interface has invalid machine_type: %s", [resource.address, machine_type])
  metadata := {"resource": resource.name}

}
 []}]} {false []}}
Type of &{0xc000caa230 0xc000731398 false} is *client.Backend
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
Type of &{0xc000b9e860 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000f70c00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000f70c20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000f71060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000f710a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TFComputeInstanceMachineTypeAllowlistConstraintV1 metadata:map[annotations:map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/constraints/tf_compute_instance_mt_constraint.yaml] name:must-have-machine-type-e2-medium] spec:map[match:map[addresses:[**]] parameters:map[allowlist:[e2-medium]] severity:medium]]
INCLUDES
[**]
FOUND
true
ERR
<nil>
========== CFCLIENT ==========
&{0xc000b9e860 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[tfcomputeinstancemachinetypeallowlistconstraintv1:0xc000c10c60] map[{constraints.gatekeeper.sh TFComputeInstanceMachineTypeAllowlistConstraintV1}:map[/cluster/constraints.gatekeeper.sh/TFComputeInstanceMachineTypeAllowlistConstraintV1/must-have-machine-type-e2-medium:0xc000014778]] [inventory]}
========== TEMPLATES ==========

Type of &{0xc0012777c0 0xc000014820 false} is *client.Backend
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
Type of &{0xc000c06280 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc000c06280 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]}
--- PASS: TestDefaultTestDataCreatesValidatorFromContents (0.08s)
=== RUN   TestReviewAsset
=== RUN   TestReviewAsset/test_asset_with_no_logging
TESTING CONFIGURATION
constraints.gatekeeper.sh/v1beta1, Kind=K8sRequiredLabels
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=CFGCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=GCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1beta1, Kind=TFComputeInstanceMachineTypeAllowlistConstraintV1
CONSTRAINT GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {cfhttpsendv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:cf-http-send-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/invalid_templates/cf_http_send_v1.yaml] [] []  []} {{{{CFHttpSendV1 []} 0xc000730870}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.cf.HttpSendV1

deny[{
	"msg": message,
	"details": metadata,
}] {
	response := http.send({
		"method": "GET",
		"url": "https://compute.googleapis.com/compute/v1/projects",
		"headers": {"Accept": "application/json", "Content-Type": "application/json"},
	})

	message := sprintf("I'm doing something forbidden! %s", [input.asset.name])
	metadata := {}
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {cfgcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/cf_gcp_storage_logging_template.yaml] [] []  []} {{{{CFGCPStorageLoggingConstraint []} 0xc000730b70}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

violation[{
	"msg": message,
	"details": metadata,
}] {
	asset := input.review
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := get_default(bucket, "logging", "default")
	destination_bucket := get_default(destination, "logBucket", "")
}

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
 	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
 []}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpbigquerydatasetlocationconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-bigquery-dataset-location-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_bq_dataset_location_v1.yaml] [] []  []} {{{{GCPBigQueryDatasetLocationConstraintV1 []} 0xc00042f1a8}} [{validation.gcp.forsetisecurity.org #

# Copyright 2019 Google LLC

#

# Licensed under the Apache License, Version 2.0 (the "License");

# you may not use this file except in compliance with the License.

# You may obtain a copy of the License at

#

#      http://www.apache.org/licenses/LICENSE-2.0

#

# Unless required by applicable law or agreed to in writing, software

# distributed under the License is distributed on an "AS IS" BASIS,

# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

# See the License for the specific language governing permissions and

# limitations under the License.

#

package templates.gcp.GCPBigQueryDatasetLocationConstraintV1

import data.lib.validator.gcp.lib as lib

############################################

# Find BigQuery Dataset Location Violations

############################################

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint

	lib.get_constraint_params(constraint, params)

	# Verify that resource is BigQuery dataset

	asset := input.asset

	asset.asset_type == "bigquery.googleapis.com/Dataset"

	# Check if resource is in exempt list

	exempt_list := params.exemptions

	matches := {asset.name} & cast_set(exempt_list)

	count(matches) == 0

	# Check that location is in allowlist/denylist

	target_locations := params.locations

	asset_location := asset.resource.data.location

	location_matches := {asset_location} & cast_set(target_locations)

	target_location_match_count(params.mode, desired_count)

	count(location_matches) == desired_count

	message := sprintf("%v is in a disallowed location.", [asset.name])

	metadata := {"location": asset_location}
}

#################

# Rule Utilities

#################

# Determine the overlap between locations under test and constraint

# By default (allowlist), we violate if there isn't overlap

target_location_match_count(mode) = 0 {
	mode != "denylist"
}

target_location_match_count(mode) = 1 {
	mode == "denylist"
}

#ENDINLINE

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-storage-logging validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_storage_logging_template.yaml] [] []  []} {{{{GCPStorageLoggingConstraint []} 0xc000014ea8}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint
	asset := input.asset
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := object.get(bucket, "logging", "default")
	destination_bucket := object.get(destination, "logBucket", "")
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
Type of &{0xc000b3d6d0 0xc000015e08 false} is *client.Backend
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
Type of &{0xc000b9ef60 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005ee9c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005ee9a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005ee9e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005ee980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005eee60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005eee40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005eee80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005eee20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0cf60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0cf40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0cf80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0cf20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0d3e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0d3c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0d400 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0d3a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b607c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b607a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b607e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b60780 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b60ea0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b60e80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b60ec0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b60e60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000bae860 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000bae780 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000bae880 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000bae760 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000baf320 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000baf300 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000baf340 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000baf2e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========GCP ValidateConstraint==========
2022/10/16 17:34:22 spec.match.target is deprecated and will be removed in a future release. Use spec.match.ancestries instead
2022/10/16 17:34:22 spec.match.exclude is deprecated and will be removed in a future release. Use spec.match.excludedAncestries instead
========== CFCLIENT ==========
&{0xc000b9ef60 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[cfgcpstorageloggingconstraint:0xc0009f1da0 cfhttpsendv1:0xc000a1fcb0 gcpbigquerydatasetlocationconstraintv1:0xc000ac24e0 gcpstorageloggingconstraint:0xc00063eea0] map[{constraints.gatekeeper.sh CFGCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/CFGCPStorageLoggingConstraint/require-storage-logging:0xc0006eaca0] {constraints.gatekeeper.sh CFHttpSendV1}:map[] {constraints.gatekeeper.sh GCPBigQueryDatasetLocationConstraintV1}:map[] {constraints.gatekeeper.sh GCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/GCPStorageLoggingConstraint/require-storage-logging-xx:0xc0006eaca8]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {k8srequiredlabels      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/k8srequiredlabels_template.yaml] [] []  []} {{{{K8sRequiredLabels []} 0xc0000155f0}} [{admission.k8s.gatekeeper.sh package k8srequiredlabels

violation[{"msg": msg, "details": {"missing_labels": missing}}] {
  provided := {label | input.review.object.metadata.labels[label]}
  required := {label | label := input.parameters.labels[_]}
  missing := required - provided
  count(missing) > 0
  msg := sprintf("you must provide labels: %v", [missing])
}
 []}]} {false []}}
Type of &{0xc0001231d0 0xc0006ead50 false} is *client.Backend
Type of &{0xc000b93ce0 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc000b93ce0 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[k8srequiredlabels:0xc00062d050] map[{constraints.gatekeeper.sh K8sRequiredLabels}:map[/cluster/constraints.gatekeeper.sh/K8sRequiredLabels/namespace-cost-center-label:0xc000730e40]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {tfcomputeinstancemachinetypeallowlistconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/tf_compute_instance_machine_type.yaml] [] []  []} {{{{TFComputeInstanceMachineTypeAllowlistConstraintV1 []} 0xc000015d40}} [{validation.resourcechange.terraform.cloud.google.com #
# Copyright 2019 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.terraform.TFComputeInstanceMachineTypeAllowlistConstraintV1

violation[{
	"msg": message,
	"details": metadata,
}] {
  resource := input.review
  resource.type == "google_compute_instance"

  action_types := {x | x := resource.change.actions[_]}
  validated_action_types := {"create", "update"}
  count(action_types & validated_action_types) >=1

  instance := resource.change.after

  allowlist := object.get(input.parameters, "allowlist", [])
  allowed_machine_types := {n | n = allowlist[_]}

  machine_type := instance.machine_type

  is_machine_type_allowlisted := count({machine_type} - allowed_machine_types) == 0

  is_machine_type_allowlisted == false

  message := sprintf("Compute instance %s has interface has invalid machine_type: %s", [resource.address, machine_type])
  metadata := {"resource": resource.name}

}
 []}]} {false []}}
Type of &{0xc000041ae0 0xc000730ee8 false} is *client.Backend
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
Type of &{0xc000b93640 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000d426a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000d42700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000d434c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000d43520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TFComputeInstanceMachineTypeAllowlistConstraintV1 metadata:map[annotations:map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/constraints/tf_compute_instance_mt_constraint.yaml] name:must-have-machine-type-e2-medium] spec:map[match:map[addresses:[**]] parameters:map[allowlist:[e2-medium]] severity:medium]]
INCLUDES
[**]
FOUND
true
ERR
<nil>
========== CFCLIENT ==========
&{0xc000b93640 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[tfcomputeinstancemachinetypeallowlistconstraintv1:0xc000ac3ce0] map[{constraints.gatekeeper.sh TFComputeInstanceMachineTypeAllowlistConstraintV1}:map[/cluster/constraints.gatekeeper.sh/TFComputeInstanceMachineTypeAllowlistConstraintV1/must-have-machine-type-e2-medium:0xc00042ffa0]] [inventory]}
========== TEMPLATES ==========

Type of &{0xc000b11540 0xc000ad60b8 false} is *client.Backend
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
Type of &{0xc000d7a880 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc000d7a880 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]}
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========GCP HandleViolation==========
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========GCP HandleViolation==========
==========GCP HandleReview==========
==========GCP HandleViolation==========
==========GCP HandleViolation==========
=== RUN   TestReviewAsset/test_asset_with_logging
TESTING CONFIGURATION
constraints.gatekeeper.sh/v1beta1, Kind=K8sRequiredLabels
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=CFGCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=GCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1beta1, Kind=TFComputeInstanceMachineTypeAllowlistConstraintV1
CONSTRAINT GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {cfhttpsendv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:cf-http-send-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/invalid_templates/cf_http_send_v1.yaml] [] []  []} {{{{CFHttpSendV1 []} 0xc000d5e840}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.cf.HttpSendV1

deny[{
	"msg": message,
	"details": metadata,
}] {
	response := http.send({
		"method": "GET",
		"url": "https://compute.googleapis.com/compute/v1/projects",
		"headers": {"Accept": "application/json", "Content-Type": "application/json"},
	})

	message := sprintf("I'm doing something forbidden! %s", [input.asset.name])
	metadata := {}
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {cfgcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/cf_gcp_storage_logging_template.yaml] [] []  []} {{{{CFGCPStorageLoggingConstraint []} 0xc000d5eb40}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

violation[{
	"msg": message,
	"details": metadata,
}] {
	asset := input.review
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := get_default(bucket, "logging", "default")
	destination_bucket := get_default(destination, "logBucket", "")
}

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
 	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
 []}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpbigquerydatasetlocationconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-bigquery-dataset-location-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_bq_dataset_location_v1.yaml] [] []  []} {{{{GCPBigQueryDatasetLocationConstraintV1 []} 0xc000f00520}} [{validation.gcp.forsetisecurity.org #

# Copyright 2019 Google LLC

#

# Licensed under the Apache License, Version 2.0 (the "License");

# you may not use this file except in compliance with the License.

# You may obtain a copy of the License at

#

#      http://www.apache.org/licenses/LICENSE-2.0

#

# Unless required by applicable law or agreed to in writing, software

# distributed under the License is distributed on an "AS IS" BASIS,

# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

# See the License for the specific language governing permissions and

# limitations under the License.

#

package templates.gcp.GCPBigQueryDatasetLocationConstraintV1

import data.lib.validator.gcp.lib as lib

############################################

# Find BigQuery Dataset Location Violations

############################################

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint

	lib.get_constraint_params(constraint, params)

	# Verify that resource is BigQuery dataset

	asset := input.asset

	asset.asset_type == "bigquery.googleapis.com/Dataset"

	# Check if resource is in exempt list

	exempt_list := params.exemptions

	matches := {asset.name} & cast_set(exempt_list)

	count(matches) == 0

	# Check that location is in allowlist/denylist

	target_locations := params.locations

	asset_location := asset.resource.data.location

	location_matches := {asset_location} & cast_set(target_locations)

	target_location_match_count(params.mode, desired_count)

	count(location_matches) == desired_count

	message := sprintf("%v is in a disallowed location.", [asset.name])

	metadata := {"location": asset_location}
}

#################

# Rule Utilities

#################

# Determine the overlap between locations under test and constraint

# By default (allowlist), we violate if there isn't overlap

target_location_match_count(mode) = 0 {
	mode != "denylist"
}

target_location_match_count(mode) = 1 {
	mode == "denylist"
}

#ENDINLINE

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-storage-logging validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_storage_logging_template.yaml] [] []  []} {{{{GCPStorageLoggingConstraint []} 0xc00042f7f0}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint
	asset := input.asset
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := object.get(bucket, "logging", "default")
	destination_bucket := object.get(destination, "logBucket", "")
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
Type of &{0xc000041900 0xc000f00788 false} is *client.Backend
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
Type of &{0xc000baefa0 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000bafa40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000baf9e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000bafac0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000baf940 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0ea60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0e9a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0eaa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0e940 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077b740 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077b720 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077b760 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077b700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077bbc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077bba0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077bbe0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077bb80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b46820 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b46800 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b46840 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b467e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b46f20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b46f00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b46f40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b46ee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000920f20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000920f00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000920f40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000920ee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000920900 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000920840 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000920960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009207a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========GCP ValidateConstraint==========
2022/10/16 17:34:22 spec.match.target is deprecated and will be removed in a future release. Use spec.match.ancestries instead
2022/10/16 17:34:22 spec.match.exclude is deprecated and will be removed in a future release. Use spec.match.excludedAncestries instead
========== CFCLIENT ==========
&{0xc000baefa0 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[cfgcpstorageloggingconstraint:0xc000751290 cfhttpsendv1:0xc0007dfcb0 gcpbigquerydatasetlocationconstraintv1:0xc000ad0690 gcpstorageloggingconstraint:0xc0005fc4e0] map[{constraints.gatekeeper.sh CFGCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/CFGCPStorageLoggingConstraint/require-storage-logging:0xc000286e58] {constraints.gatekeeper.sh CFHttpSendV1}:map[] {constraints.gatekeeper.sh GCPBigQueryDatasetLocationConstraintV1}:map[] {constraints.gatekeeper.sh GCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/GCPStorageLoggingConstraint/require-storage-logging-xx:0xc000286e60]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {k8srequiredlabels      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/k8srequiredlabels_template.yaml] [] []  []} {{{{K8sRequiredLabels []} 0xc00042ff68}} [{admission.k8s.gatekeeper.sh package k8srequiredlabels

violation[{"msg": msg, "details": {"missing_labels": missing}}] {
  provided := {label | input.review.object.metadata.labels[label]}
  required := {label | label := input.parameters.labels[_]}
  missing := required - provided
  count(missing) > 0
  msg := sprintf("you must provide labels: %v", [missing])
}
 []}]} {false []}}
Type of &{0xc00066e3c0 0xc000286f18 false} is *client.Backend
Type of &{0xc000670c00 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc000670c00 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[k8srequiredlabels:0xc0005ba6c0] map[{constraints.gatekeeper.sh K8sRequiredLabels}:map[/cluster/constraints.gatekeeper.sh/K8sRequiredLabels/namespace-cost-center-label:0xc000730518]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {tfcomputeinstancemachinetypeallowlistconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/tf_compute_instance_machine_type.yaml] [] []  []} {{{{TFComputeInstanceMachineTypeAllowlistConstraintV1 []} 0xc000f006c0}} [{validation.resourcechange.terraform.cloud.google.com #
# Copyright 2019 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.terraform.TFComputeInstanceMachineTypeAllowlistConstraintV1

violation[{
	"msg": message,
	"details": metadata,
}] {
  resource := input.review
  resource.type == "google_compute_instance"

  action_types := {x | x := resource.change.actions[_]}
  validated_action_types := {"create", "update"}
  count(action_types & validated_action_types) >=1

  instance := resource.change.after

  allowlist := object.get(input.parameters, "allowlist", [])
  allowed_machine_types := {n | n = allowlist[_]}

  machine_type := instance.machine_type

  is_machine_type_allowlisted := count({machine_type} - allowed_machine_types) == 0

  is_machine_type_allowlisted == false

  message := sprintf("Compute instance %s has interface has invalid machine_type: %s", [resource.address, machine_type])
  metadata := {"resource": resource.name}

}
 []}]} {false []}}
Type of &{0xc000ad84b0 0xc000730668 false} is *client.Backend
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
Type of &{0xc000762c80 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c6ca80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c6caa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c6ce40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c6ce60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TFComputeInstanceMachineTypeAllowlistConstraintV1 metadata:map[annotations:map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/constraints/tf_compute_instance_mt_constraint.yaml] name:must-have-machine-type-e2-medium] spec:map[match:map[addresses:[**]] parameters:map[allowlist:[e2-medium]] severity:medium]]
INCLUDES
[**]
FOUND
true
ERR
<nil>
========== CFCLIENT ==========
&{0xc000762c80 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[tfcomputeinstancemachinetypeallowlistconstraintv1:0xc000388ed0] map[{constraints.gatekeeper.sh TFComputeInstanceMachineTypeAllowlistConstraintV1}:map[/cluster/constraints.gatekeeper.sh/TFComputeInstanceMachineTypeAllowlistConstraintV1/must-have-machine-type-e2-medium:0xc000b93a28]] [inventory]}
========== TEMPLATES ==========

Type of &{0xc0004192c0 0xc000b93ad0 false} is *client.Backend
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
Type of &{0xc000d7d740 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc000d7d740 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]}
==========GCP HandleReview==========
==========GCP HandleReview==========
==========GCP HandleReview==========
=== RUN   TestReviewAsset/test_asset_with_secure_logging
TESTING CONFIGURATION
constraints.gatekeeper.sh/v1beta1, Kind=K8sRequiredLabels
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=CFGCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=GCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1beta1, Kind=TFComputeInstanceMachineTypeAllowlistConstraintV1
CONSTRAINT GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {cfhttpsendv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:cf-http-send-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/invalid_templates/cf_http_send_v1.yaml] [] []  []} {{{{CFHttpSendV1 []} 0xc000d5ff10}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.cf.HttpSendV1

deny[{
	"msg": message,
	"details": metadata,
}] {
	response := http.send({
		"method": "GET",
		"url": "https://compute.googleapis.com/compute/v1/projects",
		"headers": {"Accept": "application/json", "Content-Type": "application/json"},
	})

	message := sprintf("I'm doing something forbidden! %s", [input.asset.name])
	metadata := {}
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {cfgcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/cf_gcp_storage_logging_template.yaml] [] []  []} {{{{CFGCPStorageLoggingConstraint []} 0xc000f4a028}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

violation[{
	"msg": message,
	"details": metadata,
}] {
	asset := input.review
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := get_default(bucket, "logging", "default")
	destination_bucket := get_default(destination, "logBucket", "")
}

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
 	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
 []}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpbigquerydatasetlocationconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-bigquery-dataset-location-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_bq_dataset_location_v1.yaml] [] []  []} {{{{GCPBigQueryDatasetLocationConstraintV1 []} 0xc000f4ba28}} [{validation.gcp.forsetisecurity.org #

# Copyright 2019 Google LLC

#

# Licensed under the Apache License, Version 2.0 (the "License");

# you may not use this file except in compliance with the License.

# You may obtain a copy of the License at

#

#      http://www.apache.org/licenses/LICENSE-2.0

#

# Unless required by applicable law or agreed to in writing, software

# distributed under the License is distributed on an "AS IS" BASIS,

# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

# See the License for the specific language governing permissions and

# limitations under the License.

#

package templates.gcp.GCPBigQueryDatasetLocationConstraintV1

import data.lib.validator.gcp.lib as lib

############################################

# Find BigQuery Dataset Location Violations

############################################

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint

	lib.get_constraint_params(constraint, params)

	# Verify that resource is BigQuery dataset

	asset := input.asset

	asset.asset_type == "bigquery.googleapis.com/Dataset"

	# Check if resource is in exempt list

	exempt_list := params.exemptions

	matches := {asset.name} & cast_set(exempt_list)

	count(matches) == 0

	# Check that location is in allowlist/denylist

	target_locations := params.locations

	asset_location := asset.resource.data.location

	location_matches := {asset_location} & cast_set(target_locations)

	target_location_match_count(params.mode, desired_count)

	count(location_matches) == desired_count

	message := sprintf("%v is in a disallowed location.", [asset.name])

	metadata := {"location": asset_location}
}

#################

# Rule Utilities

#################

# Determine the overlap between locations under test and constraint

# By default (allowlist), we violate if there isn't overlap

target_location_match_count(mode) = 0 {
	mode != "denylist"
}

target_location_match_count(mode) = 1 {
	mode == "denylist"
}

#ENDINLINE

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-storage-logging validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_storage_logging_template.yaml] [] []  []} {{{{GCPStorageLoggingConstraint []} 0xc00042f540}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint
	asset := input.asset
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := object.get(bucket, "logging", "default")
	destination_bucket := object.get(destination, "logBucket", "")
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
Type of &{0xc000b3d9a0 0xc000f00c78 false} is *client.Backend
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
Type of &{0xc0006705c0 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a117c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a117a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a117e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a11780 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a11c60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a11c40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a11c80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a11c20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00065c1c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00065c1a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00065c1e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00065c180 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00065c640 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00065c620 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00065c660 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00065c600 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a110a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a11080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a110c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a11060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a11780 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a11760 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a117a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a11740 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00066efe0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00066efc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00066f000 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00066efa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00066f460 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00066f440 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00066f480 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00066f420 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========GCP ValidateConstraint==========
2022/10/16 17:34:22 spec.match.target is deprecated and will be removed in a future release. Use spec.match.ancestries instead
2022/10/16 17:34:22 spec.match.exclude is deprecated and will be removed in a future release. Use spec.match.excludedAncestries instead
========== CFCLIENT ==========
&{0xc0006705c0 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[cfgcpstorageloggingconstraint:0xc00088d8f0 cfhttpsendv1:0xc000664720 gcpbigquerydatasetlocationconstraintv1:0xc000696960 gcpstorageloggingconstraint:0xc0005aac60] map[{constraints.gatekeeper.sh CFGCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/CFGCPStorageLoggingConstraint/require-storage-logging:0xc000731388] {constraints.gatekeeper.sh CFHttpSendV1}:map[] {constraints.gatekeeper.sh GCPBigQueryDatasetLocationConstraintV1}:map[] {constraints.gatekeeper.sh GCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/GCPStorageLoggingConstraint/require-storage-logging-xx:0xc000731390]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {k8srequiredlabels      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/k8srequiredlabels_template.yaml] [] []  []} {{{{K8sRequiredLabels []} 0xc000f00458}} [{admission.k8s.gatekeeper.sh package k8srequiredlabels

violation[{"msg": msg, "details": {"missing_labels": missing}}] {
  provided := {label | input.review.object.metadata.labels[label]}
  required := {label | label := input.parameters.labels[_]}
  missing := required - provided
  count(missing) > 0
  msg := sprintf("you must provide labels: %v", [missing])
}
 []}]} {false []}}
Type of &{0xc000eb1950 0xc000731438 false} is *client.Backend
Type of &{0xc00074d840 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc00074d840 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[k8srequiredlabels:0xc000a69230] map[{constraints.gatekeeper.sh K8sRequiredLabels}:map[/cluster/constraints.gatekeeper.sh/K8sRequiredLabels/namespace-cost-center-label:0xc00042e888]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {tfcomputeinstancemachinetypeallowlistconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/tf_compute_instance_machine_type.yaml] [] []  []} {{{{TFComputeInstanceMachineTypeAllowlistConstraintV1 []} 0xc000f00bb0}} [{validation.resourcechange.terraform.cloud.google.com #
# Copyright 2019 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.terraform.TFComputeInstanceMachineTypeAllowlistConstraintV1

violation[{
	"msg": message,
	"details": metadata,
}] {
  resource := input.review
  resource.type == "google_compute_instance"

  action_types := {x | x := resource.change.actions[_]}
  validated_action_types := {"create", "update"}
  count(action_types & validated_action_types) >=1

  instance := resource.change.after

  allowlist := object.get(input.parameters, "allowlist", [])
  allowed_machine_types := {n | n = allowlist[_]}

  machine_type := instance.machine_type

  is_machine_type_allowlisted := count({machine_type} - allowed_machine_types) == 0

  is_machine_type_allowlisted == false

  message := sprintf("Compute instance %s has interface has invalid machine_type: %s", [resource.address, machine_type])
  metadata := {"resource": resource.name}

}
 []}]} {false []}}
Type of &{0xc000419590 0xc00042ea58 false} is *client.Backend
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
Type of &{0xc00065cd60 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005ede00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005ede20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006741c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006741e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TFComputeInstanceMachineTypeAllowlistConstraintV1 metadata:map[annotations:map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/constraints/tf_compute_instance_mt_constraint.yaml] name:must-have-machine-type-e2-medium] spec:map[match:map[addresses:[**]] parameters:map[allowlist:[e2-medium]] severity:medium]]
INCLUDES
[**]
FOUND
true
ERR
<nil>
========== CFCLIENT ==========
&{0xc00065cd60 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[tfcomputeinstancemachinetypeallowlistconstraintv1:0xc000ddbce0] map[{constraints.gatekeeper.sh TFComputeInstanceMachineTypeAllowlistConstraintV1}:map[/cluster/constraints.gatekeeper.sh/TFComputeInstanceMachineTypeAllowlistConstraintV1/must-have-machine-type-e2-medium:0xc000287650]] [inventory]}
========== TEMPLATES ==========

Type of &{0xc0000419a0 0xc000287708 false} is *client.Backend
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
Type of &{0xc000e08180 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc000e08180 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]}
==========GCP HandleReview==========
==========GCP HandleReview==========
==========GCP HandleReview==========
=== RUN   TestReviewAsset/test_k8s_asset_violation
TESTING CONFIGURATION
constraints.gatekeeper.sh/v1beta1, Kind=K8sRequiredLabels
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=CFGCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=GCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1beta1, Kind=TFComputeInstanceMachineTypeAllowlistConstraintV1
CONSTRAINT GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {cfhttpsendv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:cf-http-send-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/invalid_templates/cf_http_send_v1.yaml] [] []  []} {{{{CFHttpSendV1 []} 0xc000d5e828}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.cf.HttpSendV1

deny[{
	"msg": message,
	"details": metadata,
}] {
	response := http.send({
		"method": "GET",
		"url": "https://compute.googleapis.com/compute/v1/projects",
		"headers": {"Accept": "application/json", "Content-Type": "application/json"},
	})

	message := sprintf("I'm doing something forbidden! %s", [input.asset.name])
	metadata := {}
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {cfgcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/cf_gcp_storage_logging_template.yaml] [] []  []} {{{{CFGCPStorageLoggingConstraint []} 0xc000d5eb28}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

violation[{
	"msg": message,
	"details": metadata,
}] {
	asset := input.review
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := get_default(bucket, "logging", "default")
	destination_bucket := get_default(destination, "logBucket", "")
}

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
 	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
 []}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpbigquerydatasetlocationconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-bigquery-dataset-location-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_bq_dataset_location_v1.yaml] [] []  []} {{{{GCPBigQueryDatasetLocationConstraintV1 []} 0xc000c5d600}} [{validation.gcp.forsetisecurity.org #

# Copyright 2019 Google LLC

#

# Licensed under the Apache License, Version 2.0 (the "License");

# you may not use this file except in compliance with the License.

# You may obtain a copy of the License at

#

#      http://www.apache.org/licenses/LICENSE-2.0

#

# Unless required by applicable law or agreed to in writing, software

# distributed under the License is distributed on an "AS IS" BASIS,

# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

# See the License for the specific language governing permissions and

# limitations under the License.

#

package templates.gcp.GCPBigQueryDatasetLocationConstraintV1

import data.lib.validator.gcp.lib as lib

############################################

# Find BigQuery Dataset Location Violations

############################################

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint

	lib.get_constraint_params(constraint, params)

	# Verify that resource is BigQuery dataset

	asset := input.asset

	asset.asset_type == "bigquery.googleapis.com/Dataset"

	# Check if resource is in exempt list

	exempt_list := params.exemptions

	matches := {asset.name} & cast_set(exempt_list)

	count(matches) == 0

	# Check that location is in allowlist/denylist

	target_locations := params.locations

	asset_location := asset.resource.data.location

	location_matches := {asset_location} & cast_set(target_locations)

	target_location_match_count(params.mode, desired_count)

	count(location_matches) == desired_count

	message := sprintf("%v is in a disallowed location.", [asset.name])

	metadata := {"location": asset_location}
}

#################

# Rule Utilities

#################

# Determine the overlap between locations under test and constraint

# By default (allowlist), we violate if there isn't overlap

target_location_match_count(mode) = 0 {
	mode != "denylist"
}

target_location_match_count(mode) = 1 {
	mode == "denylist"
}

#ENDINLINE

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-storage-logging validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_storage_logging_template.yaml] [] []  []} {{{{GCPStorageLoggingConstraint []} 0xc000f4a4a8}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint
	asset := input.asset
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := object.get(bucket, "logging", "default")
	destination_bucket := object.get(destination, "logBucket", "")
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
Type of &{0xc0006b79a0 0xc00042f498 false} is *client.Backend
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
Type of &{0xc0009df1c0 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a00f40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a00f20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a00f60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a00f00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a013c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a013a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a013e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a01380 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00065c540 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00065c520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00065c560 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00065c500 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00065c9e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00065c9c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00065ca00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00065c9a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008cac40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008cac20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008cac60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008cac00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000faa380 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000faa360 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000faa3a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000faa340 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007756c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007756a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007756e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000775680 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000775b40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000775b20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000775b60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000775b00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========GCP ValidateConstraint==========
2022/10/16 17:34:22 spec.match.target is deprecated and will be removed in a future release. Use spec.match.ancestries instead
2022/10/16 17:34:22 spec.match.exclude is deprecated and will be removed in a future release. Use spec.match.excludedAncestries instead
========== CFCLIENT ==========
&{0xc0009df1c0 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[cfgcpstorageloggingconstraint:0xc0008dc750 cfhttpsendv1:0xc000a104b0 gcpbigquerydatasetlocationconstraintv1:0xc0006d1080 gcpstorageloggingconstraint:0xc000afd1d0] map[{constraints.gatekeeper.sh CFGCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/CFGCPStorageLoggingConstraint/require-storage-logging:0xc000015a58] {constraints.gatekeeper.sh CFHttpSendV1}:map[] {constraints.gatekeeper.sh GCPBigQueryDatasetLocationConstraintV1}:map[] {constraints.gatekeeper.sh GCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/GCPStorageLoggingConstraint/require-storage-logging-xx:0xc000015a60]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {k8srequiredlabels      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/k8srequiredlabels_template.yaml] [] []  []} {{{{K8sRequiredLabels []} 0xc00042e6e0}} [{admission.k8s.gatekeeper.sh package k8srequiredlabels

violation[{"msg": msg, "details": {"missing_labels": missing}}] {
  provided := {label | input.review.object.metadata.labels[label]}
  required := {label | label := input.parameters.labels[_]}
  missing := required - provided
  count(missing) > 0
  msg := sprintf("you must provide labels: %v", [missing])
}
 []}]} {false []}}
Type of &{0xc000b3c1e0 0xc000015b08 false} is *client.Backend
Type of &{0xc000675620 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc000675620 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[k8srequiredlabels:0xc0003602a0] map[{constraints.gatekeeper.sh K8sRequiredLabels}:map[/cluster/constraints.gatekeeper.sh/K8sRequiredLabels/namespace-cost-center-label:0xc000d5f568]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {tfcomputeinstancemachinetypeallowlistconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/tf_compute_instance_machine_type.yaml] [] []  []} {{{{TFComputeInstanceMachineTypeAllowlistConstraintV1 []} 0xc00042f3d0}} [{validation.resourcechange.terraform.cloud.google.com #
# Copyright 2019 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.terraform.TFComputeInstanceMachineTypeAllowlistConstraintV1

violation[{
	"msg": message,
	"details": metadata,
}] {
  resource := input.review
  resource.type == "google_compute_instance"

  action_types := {x | x := resource.change.actions[_]}
  validated_action_types := {"create", "update"}
  count(action_types & validated_action_types) >=1

  instance := resource.change.after

  allowlist := object.get(input.parameters, "allowlist", [])
  allowed_machine_types := {n | n = allowlist[_]}

  machine_type := instance.machine_type

  is_machine_type_allowlisted := count({machine_type} - allowed_machine_types) == 0

  is_machine_type_allowlisted == false

  message := sprintf("Compute instance %s has interface has invalid machine_type: %s", [resource.address, machine_type])
  metadata := {"resource": resource.name}

}
 []}]} {false []}}
Type of &{0xc000419950 0xc000d5f680 false} is *client.Backend
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
Type of &{0xc000766720 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008e6580 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008e65a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008e6940 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008e6960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TFComputeInstanceMachineTypeAllowlistConstraintV1 metadata:map[annotations:map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/constraints/tf_compute_instance_mt_constraint.yaml] name:must-have-machine-type-e2-medium] spec:map[match:map[addresses:[**]] parameters:map[allowlist:[e2-medium]] severity:medium]]
INCLUDES
[**]
FOUND
true
ERR
<nil>
========== CFCLIENT ==========
&{0xc000766720 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[tfcomputeinstancemachinetypeallowlistconstraintv1:0xc000f23ec0] map[{constraints.gatekeeper.sh TFComputeInstanceMachineTypeAllowlistConstraintV1}:map[/cluster/constraints.gatekeeper.sh/TFComputeInstanceMachineTypeAllowlistConstraintV1/must-have-machine-type-e2-medium:0xc00042fcb0]] [inventory]}
========== TEMPLATES ==========

Type of &{0xc0006b6e60 0xc00042fd68 false} is *client.Backend
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
Type of &{0xc000f36900 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc000f36900 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]}
--- PASS: TestReviewAsset (0.34s)
    --- PASS: TestReviewAsset/test_asset_with_no_logging (0.08s)
    --- PASS: TestReviewAsset/test_asset_with_logging (0.08s)
    --- PASS: TestReviewAsset/test_asset_with_secure_logging (0.08s)
    --- PASS: TestReviewAsset/test_k8s_asset_violation (0.09s)
=== RUN   TestCreateNoDir
--- PASS: TestCreateNoDir (0.00s)
=== RUN   TestCreateNoReadAccess
--- PASS: TestCreateNoReadAccess (0.00s)
=== RUN   TestCreateEmptyDir
--- PASS: TestCreateEmptyDir (0.00s)
=== RUN   TestReviewTFResourceChangeBadInput
=== RUN   TestReviewTFResourceChangeBadInput/base_valid_scenario
TESTING CONFIGURATION
constraints.gatekeeper.sh/v1beta1, Kind=K8sRequiredLabels
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=CFGCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=GCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1beta1, Kind=TFComputeInstanceMachineTypeAllowlistConstraintV1
CONSTRAINT GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {cfhttpsendv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:cf-http-send-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/invalid_templates/cf_http_send_v1.yaml] [] []  []} {{{{CFHttpSendV1 []} 0xc000d5ed78}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.cf.HttpSendV1

deny[{
	"msg": message,
	"details": metadata,
}] {
	response := http.send({
		"method": "GET",
		"url": "https://compute.googleapis.com/compute/v1/projects",
		"headers": {"Accept": "application/json", "Content-Type": "application/json"},
	})

	message := sprintf("I'm doing something forbidden! %s", [input.asset.name])
	metadata := {}
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {cfgcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/cf_gcp_storage_logging_template.yaml] [] []  []} {{{{CFGCPStorageLoggingConstraint []} 0xc000d5e038}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

violation[{
	"msg": message,
	"details": metadata,
}] {
	asset := input.review
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := get_default(bucket, "logging", "default")
	destination_bucket := get_default(destination, "logBucket", "")
}

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
 	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
 []}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpbigquerydatasetlocationconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-bigquery-dataset-location-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_bq_dataset_location_v1.yaml] [] []  []} {{{{GCPBigQueryDatasetLocationConstraintV1 []} 0xc000d5fa58}} [{validation.gcp.forsetisecurity.org #

# Copyright 2019 Google LLC

#

# Licensed under the Apache License, Version 2.0 (the "License");

# you may not use this file except in compliance with the License.

# You may obtain a copy of the License at

#

#      http://www.apache.org/licenses/LICENSE-2.0

#

# Unless required by applicable law or agreed to in writing, software

# distributed under the License is distributed on an "AS IS" BASIS,

# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

# See the License for the specific language governing permissions and

# limitations under the License.

#

package templates.gcp.GCPBigQueryDatasetLocationConstraintV1

import data.lib.validator.gcp.lib as lib

############################################

# Find BigQuery Dataset Location Violations

############################################

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint

	lib.get_constraint_params(constraint, params)

	# Verify that resource is BigQuery dataset

	asset := input.asset

	asset.asset_type == "bigquery.googleapis.com/Dataset"

	# Check if resource is in exempt list

	exempt_list := params.exemptions

	matches := {asset.name} & cast_set(exempt_list)

	count(matches) == 0

	# Check that location is in allowlist/denylist

	target_locations := params.locations

	asset_location := asset.resource.data.location

	location_matches := {asset_location} & cast_set(target_locations)

	target_location_match_count(params.mode, desired_count)

	count(location_matches) == desired_count

	message := sprintf("%v is in a disallowed location.", [asset.name])

	metadata := {"location": asset_location}
}

#################

# Rule Utilities

#################

# Determine the overlap between locations under test and constraint

# By default (allowlist), we violate if there isn't overlap

target_location_match_count(mode) = 0 {
	mode != "denylist"
}

target_location_match_count(mode) = 1 {
	mode == "denylist"
}

#ENDINLINE

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-storage-logging validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_storage_logging_template.yaml] [] []  []} {{{{GCPStorageLoggingConstraint []} 0xc0007308f8}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint
	asset := input.asset
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := object.get(bucket, "logging", "default")
	destination_bucket := object.get(destination, "logBucket", "")
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
Type of &{0xc0001226e0 0xc000287218 false} is *client.Backend
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
Type of &{0xc0008bfd60 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00096bf00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00096bee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00096bf20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00096bec0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000d943a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000d94380 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000d943c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000d94360 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b85e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b85c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b8600 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b85a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b8a60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b8a40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b8a80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b8a20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008bf860 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008bf840 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008bf880 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008bf820 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc001022cc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc001022c80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc001022ce0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc001022c60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000666f20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000666f00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000666f40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000666ee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006673a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000667380 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006673c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000667360 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========GCP ValidateConstraint==========
2022/10/16 17:34:22 spec.match.target is deprecated and will be removed in a future release. Use spec.match.ancestries instead
2022/10/16 17:34:22 spec.match.exclude is deprecated and will be removed in a future release. Use spec.match.excludedAncestries instead
========== CFCLIENT ==========
&{0xc0008bfd60 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[cfgcpstorageloggingconstraint:0xc00088f1a0 cfhttpsendv1:0xc0008ce5a0 gcpbigquerydatasetlocationconstraintv1:0xc000675740 gcpstorageloggingconstraint:0xc0005acb40] map[{constraints.gatekeeper.sh CFGCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/CFGCPStorageLoggingConstraint/require-storage-logging:0xc0000150a8] {constraints.gatekeeper.sh CFHttpSendV1}:map[] {constraints.gatekeeper.sh GCPBigQueryDatasetLocationConstraintV1}:map[] {constraints.gatekeeper.sh GCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/GCPStorageLoggingConstraint/require-storage-logging-xx:0xc0000150b0]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {k8srequiredlabels      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/k8srequiredlabels_template.yaml] [] []  []} {{{{K8sRequiredLabels []} 0xc000286a00}} [{admission.k8s.gatekeeper.sh package k8srequiredlabels

violation[{"msg": msg, "details": {"missing_labels": missing}}] {
  provided := {label | input.review.object.metadata.labels[label]}
  required := {label | label := input.parameters.labels[_]}
  missing := required - provided
  count(missing) > 0
  msg := sprintf("you must provide labels: %v", [missing])
}
 []}]} {false []}}
Type of &{0xc0006f59a0 0xc000015158 false} is *client.Backend
Type of &{0xc0008b90c0 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc0008b90c0 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[k8srequiredlabels:0xc0004309c0] map[{constraints.gatekeeper.sh K8sRequiredLabels}:map[/cluster/constraints.gatekeeper.sh/K8sRequiredLabels/namespace-cost-center-label:0xc000b6c8a0]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {tfcomputeinstancemachinetypeallowlistconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/tf_compute_instance_machine_type.yaml] [] []  []} {{{{TFComputeInstanceMachineTypeAllowlistConstraintV1 []} 0xc000287150}} [{validation.resourcechange.terraform.cloud.google.com #
# Copyright 2019 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.terraform.TFComputeInstanceMachineTypeAllowlistConstraintV1

violation[{
	"msg": message,
	"details": metadata,
}] {
  resource := input.review
  resource.type == "google_compute_instance"

  action_types := {x | x := resource.change.actions[_]}
  validated_action_types := {"create", "update"}
  count(action_types & validated_action_types) >=1

  instance := resource.change.after

  allowlist := object.get(input.parameters, "allowlist", [])
  allowed_machine_types := {n | n = allowlist[_]}

  machine_type := instance.machine_type

  is_machine_type_allowlisted := count({machine_type} - allowed_machine_types) == 0

  is_machine_type_allowlisted == false

  message := sprintf("Compute instance %s has interface has invalid machine_type: %s", [resource.address, machine_type])
  metadata := {"resource": resource.name}

}
 []}]} {false []}}
Type of &{0xc00096aaf0 0xc000b6c948 false} is *client.Backend
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
Type of &{0xc0009de8e0 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c4bc00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c4bc20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ca20e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ca2120 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TFComputeInstanceMachineTypeAllowlistConstraintV1 metadata:map[annotations:map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/constraints/tf_compute_instance_mt_constraint.yaml] name:must-have-machine-type-e2-medium] spec:map[match:map[addresses:[**]] parameters:map[allowlist:[e2-medium]] severity:medium]]
INCLUDES
[**]
FOUND
true
ERR
<nil>
========== CFCLIENT ==========
&{0xc0009de8e0 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[tfcomputeinstancemachinetypeallowlistconstraintv1:0xc000cffe30] map[{constraints.gatekeeper.sh TFComputeInstanceMachineTypeAllowlistConstraintV1}:map[/cluster/constraints.gatekeeper.sh/TFComputeInstanceMachineTypeAllowlistConstraintV1/must-have-machine-type-e2-medium:0xc00042faa8]] [inventory]}
========== TEMPLATES ==========

Type of &{0xc000122640 0xc00042fb50 false} is *client.Backend
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
Type of &{0xc000cf9340 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc000cf9340 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]}
==========TF HandleReview==========
map[address:google_compute_instance.foobar change:map[actions:[create] after:map[advanced_machine_features:[] allow_stopping_for_update:<nil> attached_disk:[] boot_disk:[map[auto_delete:true disk_encryption_key_raw:<nil> initialize_params:[map[image:https://www.googleapis.com/compute/v1/projects/debian-cloud/global/images/debian-9-stretch-v20220118]] mode:READ_WRITE]] can_ip_forward:false deletion_protection:false description:<nil> desired_status:<nil> enable_display:<nil> hostname:<nil> labels:map[my_key:my_value my_other_key:my_other_value] machine_type:e2-medium metadata:map[baz:qux foo:bar startup-script:echo Hello] metadata_startup_script:<nil> name:meep-merp network_interface:[map[access_config:[] alias_ip_range:[] ipv6_access_config:[] network:default nic_type:<nil> queue_count:<nil>]] resource_policies:<nil> scratch_disk:[] service_account:[] shielded_instance_config:[] tags:[bar foo] timeouts:<nil> zone:us-central1-a] after_unknown:map[] before:<nil>] mode:managed name:foobar provider_name:registry.terraform.io/hashicorp/google type:google_compute_instance]
==========TF HandleReview==========
map[address:google_compute_instance.foobar change:map[actions:[create] after:map[advanced_machine_features:[] allow_stopping_for_update:<nil> attached_disk:[] boot_disk:[map[auto_delete:true disk_encryption_key_raw:<nil> initialize_params:[map[image:https://www.googleapis.com/compute/v1/projects/debian-cloud/global/images/debian-9-stretch-v20220118]] mode:READ_WRITE]] can_ip_forward:false deletion_protection:false description:<nil> desired_status:<nil> enable_display:<nil> hostname:<nil> labels:map[my_key:my_value my_other_key:my_other_value] machine_type:e2-medium metadata:map[baz:qux foo:bar startup-script:echo Hello] metadata_startup_script:<nil> name:meep-merp network_interface:[map[access_config:[] alias_ip_range:[] ipv6_access_config:[] network:default nic_type:<nil> queue_count:<nil>]] resource_policies:<nil> scratch_disk:[] service_account:[] shielded_instance_config:[] tags:[bar foo] timeouts:<nil> zone:us-central1-a] after_unknown:map[] before:<nil>] mode:managed name:foobar provider_name:registry.terraform.io/hashicorp/google type:google_compute_instance]
=== RUN   TestReviewTFResourceChangeBadInput/missing_name
TESTING CONFIGURATION
constraints.gatekeeper.sh/v1beta1, Kind=K8sRequiredLabels
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=CFGCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=GCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1beta1, Kind=TFComputeInstanceMachineTypeAllowlistConstraintV1
CONSTRAINT GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {cfhttpsendv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:cf-http-send-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/invalid_templates/cf_http_send_v1.yaml] [] []  []} {{{{CFHttpSendV1 []} 0xc000b6c628}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.cf.HttpSendV1

deny[{
	"msg": message,
	"details": metadata,
}] {
	response := http.send({
		"method": "GET",
		"url": "https://compute.googleapis.com/compute/v1/projects",
		"headers": {"Accept": "application/json", "Content-Type": "application/json"},
	})

	message := sprintf("I'm doing something forbidden! %s", [input.asset.name])
	metadata := {}
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {cfgcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/cf_gcp_storage_logging_template.yaml] [] []  []} {{{{CFGCPStorageLoggingConstraint []} 0xc000b6c950}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

violation[{
	"msg": message,
	"details": metadata,
}] {
	asset := input.review
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := get_default(bucket, "logging", "default")
	destination_bucket := get_default(destination, "logBucket", "")
}

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
 	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
 []}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpbigquerydatasetlocationconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-bigquery-dataset-location-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_bq_dataset_location_v1.yaml] [] []  []} {{{{GCPBigQueryDatasetLocationConstraintV1 []} 0xc000731320}} [{validation.gcp.forsetisecurity.org #

# Copyright 2019 Google LLC

#

# Licensed under the Apache License, Version 2.0 (the "License");

# you may not use this file except in compliance with the License.

# You may obtain a copy of the License at

#

#      http://www.apache.org/licenses/LICENSE-2.0

#

# Unless required by applicable law or agreed to in writing, software

# distributed under the License is distributed on an "AS IS" BASIS,

# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

# See the License for the specific language governing permissions and

# limitations under the License.

#

package templates.gcp.GCPBigQueryDatasetLocationConstraintV1

import data.lib.validator.gcp.lib as lib

############################################

# Find BigQuery Dataset Location Violations

############################################

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint

	lib.get_constraint_params(constraint, params)

	# Verify that resource is BigQuery dataset

	asset := input.asset

	asset.asset_type == "bigquery.googleapis.com/Dataset"

	# Check if resource is in exempt list

	exempt_list := params.exemptions

	matches := {asset.name} & cast_set(exempt_list)

	count(matches) == 0

	# Check that location is in allowlist/denylist

	target_locations := params.locations

	asset_location := asset.resource.data.location

	location_matches := {asset_location} & cast_set(target_locations)

	target_location_match_count(params.mode, desired_count)

	count(location_matches) == desired_count

	message := sprintf("%v is in a disallowed location.", [asset.name])

	metadata := {"location": asset_location}
}

#################

# Rule Utilities

#################

# Determine the overlap between locations under test and constraint

# By default (allowlist), we violate if there isn't overlap

target_location_match_count(mode) = 0 {
	mode != "denylist"
}

target_location_match_count(mode) = 1 {
	mode == "denylist"
}

#ENDINLINE

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-storage-logging validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_storage_logging_template.yaml] [] []  []} {{{{GCPStorageLoggingConstraint []} 0xc0010541e0}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint
	asset := input.asset
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := object.get(bucket, "logging", "default")
	destination_bucket := object.get(destination, "logBucket", "")
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
Type of &{0xc0004d1f40 0xc001054628 false} is *client.Backend
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
Type of &{0xc0007749a0 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000840380 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000840360 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008403a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000840340 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000840800 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008407e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000840820 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008407c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00015f7c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00015f7a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00015f900 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00015f700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004ec580 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004ec560 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004ec5a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004ec540 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f6b60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f6b40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f6b80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f6b20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f7220 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f7200 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f7240 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006f71e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009df500 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009df4e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009df520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009df480 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0003578a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000357760 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000357940 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000357700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========GCP ValidateConstraint==========
2022/10/16 17:34:22 spec.match.target is deprecated and will be removed in a future release. Use spec.match.ancestries instead
2022/10/16 17:34:22 spec.match.exclude is deprecated and will be removed in a future release. Use spec.match.excludedAncestries instead
========== CFCLIENT ==========
&{0xc0007749a0 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[cfgcpstorageloggingconstraint:0xc0007158f0 cfhttpsendv1:0xc000b29ad0 gcpbigquerydatasetlocationconstraintv1:0xc0006b9e00 gcpstorageloggingconstraint:0xc000bb8360] map[{constraints.gatekeeper.sh CFGCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/CFGCPStorageLoggingConstraint/require-storage-logging:0xc000b6d8f0] {constraints.gatekeeper.sh CFHttpSendV1}:map[] {constraints.gatekeeper.sh GCPBigQueryDatasetLocationConstraintV1}:map[] {constraints.gatekeeper.sh GCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/GCPStorageLoggingConstraint/require-storage-logging-xx:0xc000730010]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {k8srequiredlabels      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/k8srequiredlabels_template.yaml] [] []  []} {{{{K8sRequiredLabels []} 0xc001054928}} [{admission.k8s.gatekeeper.sh package k8srequiredlabels

violation[{"msg": msg, "details": {"missing_labels": missing}}] {
  provided := {label | input.review.object.metadata.labels[label]}
  required := {label | label := input.parameters.labels[_]}
  missing := required - provided
  count(missing) > 0
  msg := sprintf("you must provide labels: %v", [missing])
}
 []}]} {false []}}
Type of &{0xc000b3c140 0xc000b6c0a0 false} is *client.Backend
Type of &{0xc000be0f20 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc000be0f20 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[k8srequiredlabels:0xc000b22ab0] map[{constraints.gatekeeper.sh K8sRequiredLabels}:map[/cluster/constraints.gatekeeper.sh/K8sRequiredLabels/namespace-cost-center-label:0xc000015b28]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {tfcomputeinstancemachinetypeallowlistconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/tf_compute_instance_machine_type.yaml] [] []  []} {{{{TFComputeInstanceMachineTypeAllowlistConstraintV1 []} 0xc001054560}} [{validation.resourcechange.terraform.cloud.google.com #
# Copyright 2019 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.terraform.TFComputeInstanceMachineTypeAllowlistConstraintV1

violation[{
	"msg": message,
	"details": metadata,
}] {
  resource := input.review
  resource.type == "google_compute_instance"

  action_types := {x | x := resource.change.actions[_]}
  validated_action_types := {"create", "update"}
  count(action_types & validated_action_types) >=1

  instance := resource.change.after

  allowlist := object.get(input.parameters, "allowlist", [])
  allowed_machine_types := {n | n = allowlist[_]}

  machine_type := instance.machine_type

  is_machine_type_allowlisted := count({machine_type} - allowed_machine_types) == 0

  is_machine_type_allowlisted == false

  message := sprintf("Compute instance %s has interface has invalid machine_type: %s", [resource.address, machine_type])
  metadata := {"resource": resource.name}

}
 []}]} {false []}}
Type of &{0xc000123590 0xc000015bd8 false} is *client.Backend
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
Type of &{0xc0005f6fc0 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064d140 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064d160 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064d500 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064d520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TFComputeInstanceMachineTypeAllowlistConstraintV1 metadata:map[annotations:map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/constraints/tf_compute_instance_mt_constraint.yaml] name:must-have-machine-type-e2-medium] spec:map[match:map[addresses:[**]] parameters:map[allowlist:[e2-medium]] severity:medium]]
INCLUDES
[**]
FOUND
true
ERR
<nil>
========== CFCLIENT ==========
&{0xc0005f6fc0 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[tfcomputeinstancemachinetypeallowlistconstraintv1:0xc000ceb6b0] map[{constraints.gatekeeper.sh TFComputeInstanceMachineTypeAllowlistConstraintV1}:map[/cluster/constraints.gatekeeper.sh/TFComputeInstanceMachineTypeAllowlistConstraintV1/must-have-machine-type-e2-medium:0xc000c5d640]] [inventory]}
========== TEMPLATES ==========

Type of &{0xc000769770 0xc000c5d7a0 false} is *client.Backend
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
Type of &{0xc000cdd4c0 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc000cdd4c0 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]}
==========TF HandleReview==========
=== RUN   TestReviewTFResourceChangeBadInput/missing_address
TESTING CONFIGURATION
constraints.gatekeeper.sh/v1beta1, Kind=K8sRequiredLabels
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=CFGCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=GCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1beta1, Kind=TFComputeInstanceMachineTypeAllowlistConstraintV1
CONSTRAINT GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {cfhttpsendv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:cf-http-send-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/invalid_templates/cf_http_send_v1.yaml] [] []  []} {{{{CFHttpSendV1 []} 0xc000f00ed8}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.cf.HttpSendV1

deny[{
	"msg": message,
	"details": metadata,
}] {
	response := http.send({
		"method": "GET",
		"url": "https://compute.googleapis.com/compute/v1/projects",
		"headers": {"Accept": "application/json", "Content-Type": "application/json"},
	})

	message := sprintf("I'm doing something forbidden! %s", [input.asset.name])
	metadata := {}
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {cfgcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/cf_gcp_storage_logging_template.yaml] [] []  []} {{{{CFGCPStorageLoggingConstraint []} 0xc000f011d8}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

violation[{
	"msg": message,
	"details": metadata,
}] {
	asset := input.review
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := get_default(bucket, "logging", "default")
	destination_bucket := get_default(destination, "logBucket", "")
}

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
 	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
 []}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpbigquerydatasetlocationconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-bigquery-dataset-location-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_bq_dataset_location_v1.yaml] [] []  []} {{{{GCPBigQueryDatasetLocationConstraintV1 []} 0xc0000151e0}} [{validation.gcp.forsetisecurity.org #

# Copyright 2019 Google LLC

#

# Licensed under the Apache License, Version 2.0 (the "License");

# you may not use this file except in compliance with the License.

# You may obtain a copy of the License at

#

#      http://www.apache.org/licenses/LICENSE-2.0

#

# Unless required by applicable law or agreed to in writing, software

# distributed under the License is distributed on an "AS IS" BASIS,

# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

# See the License for the specific language governing permissions and

# limitations under the License.

#

package templates.gcp.GCPBigQueryDatasetLocationConstraintV1

import data.lib.validator.gcp.lib as lib

############################################

# Find BigQuery Dataset Location Violations

############################################

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint

	lib.get_constraint_params(constraint, params)

	# Verify that resource is BigQuery dataset

	asset := input.asset

	asset.asset_type == "bigquery.googleapis.com/Dataset"

	# Check if resource is in exempt list

	exempt_list := params.exemptions

	matches := {asset.name} & cast_set(exempt_list)

	count(matches) == 0

	# Check that location is in allowlist/denylist

	target_locations := params.locations

	asset_location := asset.resource.data.location

	location_matches := {asset_location} & cast_set(target_locations)

	target_location_match_count(params.mode, desired_count)

	count(location_matches) == desired_count

	message := sprintf("%v is in a disallowed location.", [asset.name])

	metadata := {"location": asset_location}
}

#################

# Rule Utilities

#################

# Determine the overlap between locations under test and constraint

# By default (allowlist), we violate if there isn't overlap

target_location_match_count(mode) = 0 {
	mode != "denylist"
}

target_location_match_count(mode) = 1 {
	mode == "denylist"
}

#ENDINLINE

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-storage-logging validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_storage_logging_template.yaml] [] []  []} {{{{GCPStorageLoggingConstraint []} 0xc000f000a0}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint
	asset := input.asset
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := object.get(bucket, "logging", "default")
	destination_bucket := object.get(destination, "logBucket", "")
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
Type of &{0xc000b3c730 0xc000f001e0 false} is *client.Backend
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
Type of &{0xc0009402c0 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00068c900 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00068c8e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00068c920 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00068c8c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00068cd80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00068cd60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00068cda0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00068cd40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009df060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009df040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009df080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009df020 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009df500 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009df4e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009df520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009df4c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000530000 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000383fe0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000530020 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000383fc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000530700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005306e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000530720 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005306c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009400e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009400c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000940100 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009400a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000940880 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000940840 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009408a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000940800 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========GCP ValidateConstraint==========
2022/10/16 17:34:22 spec.match.target is deprecated and will be removed in a future release. Use spec.match.ancestries instead
2022/10/16 17:34:22 spec.match.exclude is deprecated and will be removed in a future release. Use spec.match.excludedAncestries instead
========== CFCLIENT ==========
&{0xc0009402c0 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[cfgcpstorageloggingconstraint:0xc000c7d320 cfhttpsendv1:0xc000bc2a20 gcpbigquerydatasetlocationconstraintv1:0xc0009328a0 gcpstorageloggingconstraint:0xc000aec1e0] map[{constraints.gatekeeper.sh CFGCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/CFGCPStorageLoggingConstraint/require-storage-logging:0xc0008ecda0] {constraints.gatekeeper.sh CFHttpSendV1}:map[] {constraints.gatekeeper.sh GCPBigQueryDatasetLocationConstraintV1}:map[] {constraints.gatekeeper.sh GCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/GCPStorageLoggingConstraint/require-storage-logging-xx:0xc0008ecda8]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {k8srequiredlabels      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/k8srequiredlabels_template.yaml] [] []  []} {{{{K8sRequiredLabels []} 0xc000f007e8}} [{admission.k8s.gatekeeper.sh package k8srequiredlabels

violation[{"msg": msg, "details": {"missing_labels": missing}}] {
  provided := {label | input.review.object.metadata.labels[label]}
  required := {label | label := input.parameters.labels[_]}
  missing := required - provided
  count(missing) > 0
  msg := sprintf("you must provide labels: %v", [missing])
}
 []}]} {false []}}
Type of &{0xc000b5a460 0xc0008ece78 false} is *client.Backend
Type of &{0xc000ba2140 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc000ba2140 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[k8srequiredlabels:0xc000e06e10] map[{constraints.gatekeeper.sh K8sRequiredLabels}:map[/cluster/constraints.gatekeeper.sh/K8sRequiredLabels/namespace-cost-center-label:0xc00011ed80]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {tfcomputeinstancemachinetypeallowlistconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/tf_compute_instance_machine_type.yaml] [] []  []} {{{{TFComputeInstanceMachineTypeAllowlistConstraintV1 []} 0xc000f00118}} [{validation.resourcechange.terraform.cloud.google.com #
# Copyright 2019 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.terraform.TFComputeInstanceMachineTypeAllowlistConstraintV1

violation[{
	"msg": message,
	"details": metadata,
}] {
  resource := input.review
  resource.type == "google_compute_instance"

  action_types := {x | x := resource.change.actions[_]}
  validated_action_types := {"create", "update"}
  count(action_types & validated_action_types) >=1

  instance := resource.change.after

  allowlist := object.get(input.parameters, "allowlist", [])
  allowed_machine_types := {n | n = allowlist[_]}

  machine_type := instance.machine_type

  is_machine_type_allowlisted := count({machine_type} - allowed_machine_types) == 0

  is_machine_type_allowlisted == false

  message := sprintf("Compute instance %s has interface has invalid machine_type: %s", [resource.address, machine_type])
  metadata := {"resource": resource.name}

}
 []}]} {false []}}
Type of &{0xc000e10320 0xc00011ee88 false} is *client.Backend
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
Type of &{0xc000c23b40 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ff8500 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ff8520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ff8a00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ff8a60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TFComputeInstanceMachineTypeAllowlistConstraintV1 metadata:map[annotations:map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/constraints/tf_compute_instance_mt_constraint.yaml] name:must-have-machine-type-e2-medium] spec:map[match:map[addresses:[**]] parameters:map[allowlist:[e2-medium]] severity:medium]]
INCLUDES
[**]
FOUND
true
ERR
<nil>
========== CFCLIENT ==========
&{0xc000c23b40 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[tfcomputeinstancemachinetypeallowlistconstraintv1:0xc000b747b0] map[{constraints.gatekeeper.sh TFComputeInstanceMachineTypeAllowlistConstraintV1}:map[/cluster/constraints.gatekeeper.sh/TFComputeInstanceMachineTypeAllowlistConstraintV1/must-have-machine-type-e2-medium:0xc00042ef08]] [inventory]}
========== TEMPLATES ==========

Type of &{0xc000b3d310 0xc00042f030 false} is *client.Backend
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
Type of &{0xc000383fc0 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc000383fc0 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]}
==========TF HandleReview==========
=== RUN   TestReviewTFResourceChangeBadInput/missing_change
TESTING CONFIGURATION
constraints.gatekeeper.sh/v1beta1, Kind=K8sRequiredLabels
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=CFGCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=GCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1beta1, Kind=TFComputeInstanceMachineTypeAllowlistConstraintV1
CONSTRAINT GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {cfhttpsendv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:cf-http-send-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/invalid_templates/cf_http_send_v1.yaml] [] []  []} {{{{CFHttpSendV1 []} 0xc000287318}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.cf.HttpSendV1

deny[{
	"msg": message,
	"details": metadata,
}] {
	response := http.send({
		"method": "GET",
		"url": "https://compute.googleapis.com/compute/v1/projects",
		"headers": {"Accept": "application/json", "Content-Type": "application/json"},
	})

	message := sprintf("I'm doing something forbidden! %s", [input.asset.name])
	metadata := {}
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {cfgcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/cf_gcp_storage_logging_template.yaml] [] []  []} {{{{CFGCPStorageLoggingConstraint []} 0xc000287618}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

violation[{
	"msg": message,
	"details": metadata,
}] {
	asset := input.review
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := get_default(bucket, "logging", "default")
	destination_bucket := get_default(destination, "logBucket", "")
}

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
 	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
 []}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpbigquerydatasetlocationconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-bigquery-dataset-location-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_bq_dataset_location_v1.yaml] [] []  []} {{{{GCPBigQueryDatasetLocationConstraintV1 []} 0xc0006eac90}} [{validation.gcp.forsetisecurity.org #

# Copyright 2019 Google LLC

#

# Licensed under the Apache License, Version 2.0 (the "License");

# you may not use this file except in compliance with the License.

# You may obtain a copy of the License at

#

#      http://www.apache.org/licenses/LICENSE-2.0

#

# Unless required by applicable law or agreed to in writing, software

# distributed under the License is distributed on an "AS IS" BASIS,

# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

# See the License for the specific language governing permissions and

# limitations under the License.

#

package templates.gcp.GCPBigQueryDatasetLocationConstraintV1

import data.lib.validator.gcp.lib as lib

############################################

# Find BigQuery Dataset Location Violations

############################################

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint

	lib.get_constraint_params(constraint, params)

	# Verify that resource is BigQuery dataset

	asset := input.asset

	asset.asset_type == "bigquery.googleapis.com/Dataset"

	# Check if resource is in exempt list

	exempt_list := params.exemptions

	matches := {asset.name} & cast_set(exempt_list)

	count(matches) == 0

	# Check that location is in allowlist/denylist

	target_locations := params.locations

	asset_location := asset.resource.data.location

	location_matches := {asset_location} & cast_set(target_locations)

	target_location_match_count(params.mode, desired_count)

	count(location_matches) == desired_count

	message := sprintf("%v is in a disallowed location.", [asset.name])

	metadata := {"location": asset_location}
}

#################

# Rule Utilities

#################

# Determine the overlap between locations under test and constraint

# By default (allowlist), we violate if there isn't overlap

target_location_match_count(mode) = 0 {
	mode != "denylist"
}

target_location_match_count(mode) = 1 {
	mode == "denylist"
}

#ENDINLINE

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-storage-logging validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_storage_logging_template.yaml] [] []  []} {{{{GCPStorageLoggingConstraint []} 0xc0006ebb28}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint
	asset := input.asset
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := object.get(bucket, "logging", "default")
	destination_bucket := object.get(destination, "logBucket", "")
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
Type of &{0xc000b3c730 0xc000730150 false} is *client.Backend
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
Type of &{0xc0004ed140 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064ce60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064ce40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064ce80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064ce20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064d2e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064d2c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064d300 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00064d2a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009f0700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009f06e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009f0720 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009f06c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009f0ba0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009f0b80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009f0bc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009f0b60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004bfb40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004bfb20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004bfb60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004bfb00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005bc200 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005bc1e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005bc220 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005bc1c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000cce100 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000cce0e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000cce120 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000cce0c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000cceb20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000cceac0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ccebe0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ccea60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========GCP ValidateConstraint==========
2022/10/16 17:34:22 spec.match.target is deprecated and will be removed in a future release. Use spec.match.ancestries instead
2022/10/16 17:34:22 spec.match.exclude is deprecated and will be removed in a future release. Use spec.match.excludedAncestries instead
========== CFCLIENT ==========
&{0xc0004ed140 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[cfgcpstorageloggingconstraint:0xc0005ff7a0 cfhttpsendv1:0xc000cd2900 gcpbigquerydatasetlocationconstraintv1:0xc000782ae0 gcpstorageloggingconstraint:0xc00065d860] map[{constraints.gatekeeper.sh CFGCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/CFGCPStorageLoggingConstraint/require-storage-logging:0xc00042ff48] {constraints.gatekeeper.sh CFHttpSendV1}:map[] {constraints.gatekeeper.sh GCPBigQueryDatasetLocationConstraintV1}:map[] {constraints.gatekeeper.sh GCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/GCPStorageLoggingConstraint/require-storage-logging-xx:0xc00042ff50]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {k8srequiredlabels      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/k8srequiredlabels_template.yaml] [] []  []} {{{{K8sRequiredLabels []} 0xc000730530}} [{admission.k8s.gatekeeper.sh package k8srequiredlabels

violation[{"msg": msg, "details": {"missing_labels": missing}}] {
  provided := {label | input.review.object.metadata.labels[label]}
  required := {label | label := input.parameters.labels[_]}
  missing := required - provided
  count(missing) > 0
  msg := sprintf("you must provide labels: %v", [missing])
}
 []}]} {false []}}
Type of &{0xc0006ba460 0xc000730018 false} is *client.Backend
Type of &{0xc0006d6640 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc0006d6640 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[k8srequiredlabels:0xc000acf170] map[{constraints.gatekeeper.sh K8sRequiredLabels}:map[/cluster/constraints.gatekeeper.sh/K8sRequiredLabels/namespace-cost-center-label:0xc0002874a8]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {tfcomputeinstancemachinetypeallowlistconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/tf_compute_instance_machine_type.yaml] [] []  []} {{{{TFComputeInstanceMachineTypeAllowlistConstraintV1 []} 0xc000730088}} [{validation.resourcechange.terraform.cloud.google.com #
# Copyright 2019 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.terraform.TFComputeInstanceMachineTypeAllowlistConstraintV1

violation[{
	"msg": message,
	"details": metadata,
}] {
  resource := input.review
  resource.type == "google_compute_instance"

  action_types := {x | x := resource.change.actions[_]}
  validated_action_types := {"create", "update"}
  count(action_types & validated_action_types) >=1

  instance := resource.change.after

  allowlist := object.get(input.parameters, "allowlist", [])
  allowed_machine_types := {n | n = allowlist[_]}

  machine_type := instance.machine_type

  is_machine_type_allowlisted := count({machine_type} - allowed_machine_types) == 0

  is_machine_type_allowlisted == false

  message := sprintf("Compute instance %s has interface has invalid machine_type: %s", [resource.address, machine_type])
  metadata := {"resource": resource.name}

}
 []}]} {false []}}
Type of &{0xc000d1c140 0xc000287550 false} is *client.Backend
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
Type of &{0xc0008bfe00 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000cceda0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ccedc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ccf240 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ccf260 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TFComputeInstanceMachineTypeAllowlistConstraintV1 metadata:map[annotations:map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/constraints/tf_compute_instance_mt_constraint.yaml] name:must-have-machine-type-e2-medium] spec:map[match:map[addresses:[**]] parameters:map[allowlist:[e2-medium]] severity:medium]]
INCLUDES
[**]
FOUND
true
ERR
<nil>
========== CFCLIENT ==========
&{0xc0008bfe00 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[tfcomputeinstancemachinetypeallowlistconstraintv1:0xc0008a6c00] map[{constraints.gatekeeper.sh TFComputeInstanceMachineTypeAllowlistConstraintV1}:map[/cluster/constraints.gatekeeper.sh/TFComputeInstanceMachineTypeAllowlistConstraintV1/must-have-machine-type-e2-medium:0xc000014ae8]] [inventory]}
========== TEMPLATES ==========

Type of &{0xc000122e10 0xc000014b98 false} is *client.Backend
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
Type of &{0xc0005bcb60 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc0005bcb60 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]}
==========TF HandleReview==========
=== RUN   TestReviewTFResourceChangeBadInput/missing_type
TESTING CONFIGURATION
constraints.gatekeeper.sh/v1beta1, Kind=K8sRequiredLabels
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=CFGCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=GCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1beta1, Kind=TFComputeInstanceMachineTypeAllowlistConstraintV1
CONSTRAINT GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {cfhttpsendv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:cf-http-send-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/invalid_templates/cf_http_send_v1.yaml] [] []  []} {{{{CFHttpSendV1 []} 0xc000287180}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.cf.HttpSendV1

deny[{
	"msg": message,
	"details": metadata,
}] {
	response := http.send({
		"method": "GET",
		"url": "https://compute.googleapis.com/compute/v1/projects",
		"headers": {"Accept": "application/json", "Content-Type": "application/json"},
	})

	message := sprintf("I'm doing something forbidden! %s", [input.asset.name])
	metadata := {}
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {cfgcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/cf_gcp_storage_logging_template.yaml] [] []  []} {{{{CFGCPStorageLoggingConstraint []} 0xc000287480}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

violation[{
	"msg": message,
	"details": metadata,
}] {
	asset := input.review
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := get_default(bucket, "logging", "default")
	destination_bucket := get_default(destination, "logBucket", "")
}

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
 	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
 []}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpbigquerydatasetlocationconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-bigquery-dataset-location-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_bq_dataset_location_v1.yaml] [] []  []} {{{{GCPBigQueryDatasetLocationConstraintV1 []} 0xc000d93008}} [{validation.gcp.forsetisecurity.org #

# Copyright 2019 Google LLC

#

# Licensed under the Apache License, Version 2.0 (the "License");

# you may not use this file except in compliance with the License.

# You may obtain a copy of the License at

#

#      http://www.apache.org/licenses/LICENSE-2.0

#

# Unless required by applicable law or agreed to in writing, software

# distributed under the License is distributed on an "AS IS" BASIS,

# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

# See the License for the specific language governing permissions and

# limitations under the License.

#

package templates.gcp.GCPBigQueryDatasetLocationConstraintV1

import data.lib.validator.gcp.lib as lib

############################################

# Find BigQuery Dataset Location Violations

############################################

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint

	lib.get_constraint_params(constraint, params)

	# Verify that resource is BigQuery dataset

	asset := input.asset

	asset.asset_type == "bigquery.googleapis.com/Dataset"

	# Check if resource is in exempt list

	exempt_list := params.exemptions

	matches := {asset.name} & cast_set(exempt_list)

	count(matches) == 0

	# Check that location is in allowlist/denylist

	target_locations := params.locations

	asset_location := asset.resource.data.location

	location_matches := {asset_location} & cast_set(target_locations)

	target_location_match_count(params.mode, desired_count)

	count(location_matches) == desired_count

	message := sprintf("%v is in a disallowed location.", [asset.name])

	metadata := {"location": asset_location}
}

#################

# Rule Utilities

#################

# Determine the overlap between locations under test and constraint

# By default (allowlist), we violate if there isn't overlap

target_location_match_count(mode) = 0 {
	mode != "denylist"
}

target_location_match_count(mode) = 1 {
	mode == "denylist"
}

#ENDINLINE

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-storage-logging validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_storage_logging_template.yaml] [] []  []} {{{{GCPStorageLoggingConstraint []} 0xc000d93ea0}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint
	asset := input.asset
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := object.get(bucket, "logging", "default")
	destination_bucket := object.get(destination, "logBucket", "")
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
Type of &{0xc0006b6320 0xc000286850 false} is *client.Backend
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
Type of &{0xc000ab05e0 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005d8900 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005d88e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005d8920 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005d88c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005d8d80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005d8d60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005d8da0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005d8d40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009300c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009300a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009300e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000930080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000930560 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000930540 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000930580 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000930520 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006b1440 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006b1300 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006b1460 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006b12e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006b1b60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006b1b40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006b1b80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006b1b20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000f35400 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000f353e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000f35420 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000f353c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000f358a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000f35880 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000f358c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000f35860 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========GCP ValidateConstraint==========
2022/10/16 17:34:22 spec.match.target is deprecated and will be removed in a future release. Use spec.match.ancestries instead
2022/10/16 17:34:22 spec.match.exclude is deprecated and will be removed in a future release. Use spec.match.excludedAncestries instead
========== CFCLIENT ==========
&{0xc000ab05e0 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[cfgcpstorageloggingconstraint:0xc0005f4090 cfhttpsendv1:0xc000a406f0 gcpbigquerydatasetlocationconstraintv1:0xc000806f00 gcpstorageloggingconstraint:0xc0006e87e0] map[{constraints.gatekeeper.sh CFGCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/CFGCPStorageLoggingConstraint/require-storage-logging:0xc0006ebd58] {constraints.gatekeeper.sh CFHttpSendV1}:map[] {constraints.gatekeeper.sh GCPBigQueryDatasetLocationConstraintV1}:map[] {constraints.gatekeeper.sh GCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/GCPStorageLoggingConstraint/require-storage-logging-xx:0xc0006ea020]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {k8srequiredlabels      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/k8srequiredlabels_template.yaml] [] []  []} {{{{K8sRequiredLabels []} 0xc00042f2c8}} [{admission.k8s.gatekeeper.sh package k8srequiredlabels

violation[{"msg": msg, "details": {"missing_labels": missing}}] {
  provided := {label | input.review.object.metadata.labels[label]}
  required := {label | label := input.parameters.labels[_]}
  missing := required - provided
  count(missing) > 0
  msg := sprintf("you must provide labels: %v", [missing])
}
 []}]} {false []}}
Type of &{0xc000122b40 0xc0006ea178 false} is *client.Backend
Type of &{0xc000f444c0 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc000f444c0 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[k8srequiredlabels:0xc000d00bd0] map[{constraints.gatekeeper.sh K8sRequiredLabels}:map[/cluster/constraints.gatekeeper.sh/K8sRequiredLabels/namespace-cost-center-label:0xc0007312f8]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {tfcomputeinstancemachinetypeallowlistconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/tf_compute_instance_machine_type.yaml] [] []  []} {{{{TFComputeInstanceMachineTypeAllowlistConstraintV1 []} 0xc000286738}} [{validation.resourcechange.terraform.cloud.google.com #
# Copyright 2019 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.terraform.TFComputeInstanceMachineTypeAllowlistConstraintV1

violation[{
	"msg": message,
	"details": metadata,
}] {
  resource := input.review
  resource.type == "google_compute_instance"

  action_types := {x | x := resource.change.actions[_]}
  validated_action_types := {"create", "update"}
  count(action_types & validated_action_types) >=1

  instance := resource.change.after

  allowlist := object.get(input.parameters, "allowlist", [])
  allowed_machine_types := {n | n = allowlist[_]}

  machine_type := instance.machine_type

  is_machine_type_allowlisted := count({machine_type} - allowed_machine_types) == 0

  is_machine_type_allowlisted == false

  message := sprintf("Compute instance %s has interface has invalid machine_type: %s", [resource.address, machine_type])
  metadata := {"resource": resource.name}

}
 []}]} {false []}}
Type of &{0xc000d06320 0xc000f28030 false} is *client.Backend
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
Type of &{0xc000ee40a0 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dec00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dec60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009df180 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009df1a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TFComputeInstanceMachineTypeAllowlistConstraintV1 metadata:map[annotations:map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/constraints/tf_compute_instance_mt_constraint.yaml] name:must-have-machine-type-e2-medium] spec:map[match:map[addresses:[**]] parameters:map[allowlist:[e2-medium]] severity:medium]]
INCLUDES
[**]
FOUND
true
ERR
<nil>
========== CFCLIENT ==========
&{0xc000ee40a0 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[tfcomputeinstancemachinetypeallowlistconstraintv1:0xc00092bf80] map[{constraints.gatekeeper.sh TFComputeInstanceMachineTypeAllowlistConstraintV1}:map[/cluster/constraints.gatekeeper.sh/TFComputeInstanceMachineTypeAllowlistConstraintV1/must-have-machine-type-e2-medium:0xc000d937f0]] [inventory]}
========== TEMPLATES ==========

Type of &{0xc000edda90 0xc000d938a8 false} is *client.Backend
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
Type of &{0xc0008847c0 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc0008847c0 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]}
==========TF HandleReview==========
--- PASS: TestReviewTFResourceChangeBadInput (0.42s)
    --- PASS: TestReviewTFResourceChangeBadInput/base_valid_scenario (0.08s)
    --- PASS: TestReviewTFResourceChangeBadInput/missing_name (0.08s)
    --- PASS: TestReviewTFResourceChangeBadInput/missing_address (0.08s)
    --- PASS: TestReviewTFResourceChangeBadInput/missing_change (0.08s)
    --- PASS: TestReviewTFResourceChangeBadInput/missing_type (0.09s)
=== RUN   TestReviewTFResourceChange
=== RUN   TestReviewTFResourceChange/test_base_valid_scenario
TESTING CONFIGURATION
constraints.gatekeeper.sh/v1beta1, Kind=K8sRequiredLabels
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=CFGCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=GCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1beta1, Kind=TFComputeInstanceMachineTypeAllowlistConstraintV1
CONSTRAINT GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {cfhttpsendv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:cf-http-send-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/invalid_templates/cf_http_send_v1.yaml] [] []  []} {{{{CFHttpSendV1 []} 0xc000015638}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.cf.HttpSendV1

deny[{
	"msg": message,
	"details": metadata,
}] {
	response := http.send({
		"method": "GET",
		"url": "https://compute.googleapis.com/compute/v1/projects",
		"headers": {"Accept": "application/json", "Content-Type": "application/json"},
	})

	message := sprintf("I'm doing something forbidden! %s", [input.asset.name])
	metadata := {}
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {cfgcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/cf_gcp_storage_logging_template.yaml] [] []  []} {{{{CFGCPStorageLoggingConstraint []} 0xc000015940}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

violation[{
	"msg": message,
	"details": metadata,
}] {
	asset := input.review
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := get_default(bucket, "logging", "default")
	destination_bucket := get_default(destination, "logBucket", "")
}

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
 	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
 []}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpbigquerydatasetlocationconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-bigquery-dataset-location-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_bq_dataset_location_v1.yaml] [] []  []} {{{{GCPBigQueryDatasetLocationConstraintV1 []} 0xc0006ebbe0}} [{validation.gcp.forsetisecurity.org #

# Copyright 2019 Google LLC

#

# Licensed under the Apache License, Version 2.0 (the "License");

# you may not use this file except in compliance with the License.

# You may obtain a copy of the License at

#

#      http://www.apache.org/licenses/LICENSE-2.0

#

# Unless required by applicable law or agreed to in writing, software

# distributed under the License is distributed on an "AS IS" BASIS,

# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

# See the License for the specific language governing permissions and

# limitations under the License.

#

package templates.gcp.GCPBigQueryDatasetLocationConstraintV1

import data.lib.validator.gcp.lib as lib

############################################

# Find BigQuery Dataset Location Violations

############################################

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint

	lib.get_constraint_params(constraint, params)

	# Verify that resource is BigQuery dataset

	asset := input.asset

	asset.asset_type == "bigquery.googleapis.com/Dataset"

	# Check if resource is in exempt list

	exempt_list := params.exemptions

	matches := {asset.name} & cast_set(exempt_list)

	count(matches) == 0

	# Check that location is in allowlist/denylist

	target_locations := params.locations

	asset_location := asset.resource.data.location

	location_matches := {asset_location} & cast_set(target_locations)

	target_location_match_count(params.mode, desired_count)

	count(location_matches) == desired_count

	message := sprintf("%v is in a disallowed location.", [asset.name])

	metadata := {"location": asset_location}
}

#################

# Rule Utilities

#################

# Determine the overlap between locations under test and constraint

# By default (allowlist), we violate if there isn't overlap

target_location_match_count(mode) = 0 {
	mode != "denylist"
}

target_location_match_count(mode) = 1 {
	mode == "denylist"
}

#ENDINLINE

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-storage-logging validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_storage_logging_template.yaml] [] []  []} {{{{GCPStorageLoggingConstraint []} 0xc0006eac30}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint
	asset := input.asset
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := object.get(bucket, "logging", "default")
	destination_bucket := object.get(destination, "logBucket", "")
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
Type of &{0xc000123310 0xc0006ebb90 false} is *client.Backend
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
Type of &{0xc000931280 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000623980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000623960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006239a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000623940 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000623e20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000623e00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000623e40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000623de0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00097bf20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00097bf00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00097bf40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00097bee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a023a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a02380 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a023c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a02360 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000775a20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000775a00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000775a40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007759e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000616240 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000616220 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006162c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006161e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b0e020 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b0e000 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b0e040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0010b9fe0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b0e4c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b0e4a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b0e4e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000b0e480 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========GCP ValidateConstraint==========
2022/10/16 17:34:22 spec.match.target is deprecated and will be removed in a future release. Use spec.match.ancestries instead
2022/10/16 17:34:22 spec.match.exclude is deprecated and will be removed in a future release. Use spec.match.excludedAncestries instead
========== CFCLIENT ==========
&{0xc000931280 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[cfgcpstorageloggingconstraint:0xc000a304e0 cfhttpsendv1:0xc0009f2f60 gcpbigquerydatasetlocationconstraintv1:0xc0007823f0 gcpstorageloggingconstraint:0xc000acd830] map[{constraints.gatekeeper.sh CFGCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/CFGCPStorageLoggingConstraint/require-storage-logging:0xc000c5c670] {constraints.gatekeeper.sh CFHttpSendV1}:map[] {constraints.gatekeeper.sh GCPBigQueryDatasetLocationConstraintV1}:map[] {constraints.gatekeeper.sh GCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/GCPStorageLoggingConstraint/require-storage-logging-xx:0xc000c5c678]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {k8srequiredlabels      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/k8srequiredlabels_template.yaml] [] []  []} {{{{K8sRequiredLabels []} 0xc0006eb378}} [{admission.k8s.gatekeeper.sh package k8srequiredlabels

violation[{"msg": msg, "details": {"missing_labels": missing}}] {
  provided := {label | input.review.object.metadata.labels[label]}
  required := {label | label := input.parameters.labels[_]}
  missing := required - provided
  count(missing) > 0
  msg := sprintf("you must provide labels: %v", [missing])
}
 []}]} {false []}}
Type of &{0xc000419220 0xc000c5c720 false} is *client.Backend
Type of &{0xc000b11640 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc000b11640 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[k8srequiredlabels:0xc000a616e0] map[{constraints.gatekeeper.sh K8sRequiredLabels}:map[/cluster/constraints.gatekeeper.sh/K8sRequiredLabels/namespace-cost-center-label:0xc00011eec0]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {tfcomputeinstancemachinetypeallowlistconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/tf_compute_instance_machine_type.yaml] [] []  []} {{{{TFComputeInstanceMachineTypeAllowlistConstraintV1 []} 0xc0006ebac8}} [{validation.resourcechange.terraform.cloud.google.com #
# Copyright 2019 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.terraform.TFComputeInstanceMachineTypeAllowlistConstraintV1

violation[{
	"msg": message,
	"details": metadata,
}] {
  resource := input.review
  resource.type == "google_compute_instance"

  action_types := {x | x := resource.change.actions[_]}
  validated_action_types := {"create", "update"}
  count(action_types & validated_action_types) >=1

  instance := resource.change.after

  allowlist := object.get(input.parameters, "allowlist", [])
  allowed_machine_types := {n | n = allowlist[_]}

  machine_type := instance.machine_type

  is_machine_type_allowlisted := count({machine_type} - allowed_machine_types) == 0

  is_machine_type_allowlisted == false

  message := sprintf("Compute instance %s has interface has invalid machine_type: %s", [resource.address, machine_type])
  metadata := {"resource": resource.name}

}
 []}]} {false []}}
Type of &{0xc000d08280 0xc00011f030 false} is *client.Backend
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
Type of &{0xc000a7bb60 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000357d00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000357d20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c30100 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c30120 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TFComputeInstanceMachineTypeAllowlistConstraintV1 metadata:map[annotations:map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/constraints/tf_compute_instance_mt_constraint.yaml] name:must-have-machine-type-e2-medium] spec:map[match:map[addresses:[**]] parameters:map[allowlist:[e2-medium]] severity:medium]]
INCLUDES
[**]
FOUND
true
ERR
<nil>
========== CFCLIENT ==========
&{0xc000a7bb60 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[tfcomputeinstancemachinetypeallowlistconstraintv1:0xc000bd9e60] map[{constraints.gatekeeper.sh TFComputeInstanceMachineTypeAllowlistConstraintV1}:map[/cluster/constraints.gatekeeper.sh/TFComputeInstanceMachineTypeAllowlistConstraintV1/must-have-machine-type-e2-medium:0xc00042fa78]] [inventory]}
========== TEMPLATES ==========

Type of &{0xc0004d1270 0xc00042fb38 false} is *client.Backend
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
Type of &{0xc000bc1220 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc000bc1220 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]}
==========TF HandleReview==========
map[address:google_compute_instance.foobar change:map[actions:[create] after:map[advanced_machine_features:[] allow_stopping_for_update:<nil> attached_disk:[] boot_disk:[map[auto_delete:true disk_encryption_key_raw:<nil> initialize_params:[map[image:https://www.googleapis.com/compute/v1/projects/debian-cloud/global/images/debian-9-stretch-v20220118]] mode:READ_WRITE]] can_ip_forward:false deletion_protection:false description:<nil> desired_status:<nil> enable_display:<nil> hostname:<nil> labels:map[my_key:my_value my_other_key:my_other_value] machine_type:e2-medium metadata:map[baz:qux foo:bar startup-script:echo Hello] metadata_startup_script:<nil> name:meep-merp network_interface:[map[access_config:[] alias_ip_range:[] ipv6_access_config:[] network:default nic_type:<nil> queue_count:<nil>]] resource_policies:<nil> scratch_disk:[] service_account:[] shielded_instance_config:[] tags:[bar foo] timeouts:<nil> zone:us-central1-a] after_unknown:map[] before:<nil>] mode:managed name:foobar provider_name:registry.terraform.io/hashicorp/google type:google_compute_instance]
==========TF HandleReview==========
map[address:google_compute_instance.foobar change:map[actions:[create] after:map[advanced_machine_features:[] allow_stopping_for_update:<nil> attached_disk:[] boot_disk:[map[auto_delete:true disk_encryption_key_raw:<nil> initialize_params:[map[image:https://www.googleapis.com/compute/v1/projects/debian-cloud/global/images/debian-9-stretch-v20220118]] mode:READ_WRITE]] can_ip_forward:false deletion_protection:false description:<nil> desired_status:<nil> enable_display:<nil> hostname:<nil> labels:map[my_key:my_value my_other_key:my_other_value] machine_type:e2-medium metadata:map[baz:qux foo:bar startup-script:echo Hello] metadata_startup_script:<nil> name:meep-merp network_interface:[map[access_config:[] alias_ip_range:[] ipv6_access_config:[] network:default nic_type:<nil> queue_count:<nil>]] resource_policies:<nil> scratch_disk:[] service_account:[] shielded_instance_config:[] tags:[bar foo] timeouts:<nil> zone:us-central1-a] after_unknown:map[] before:<nil>] mode:managed name:foobar provider_name:registry.terraform.io/hashicorp/google type:google_compute_instance]
=== RUN   TestReviewTFResourceChange/test_base_invalid_machine_type
TESTING CONFIGURATION
constraints.gatekeeper.sh/v1beta1, Kind=K8sRequiredLabels
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=CFGCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=GCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1beta1, Kind=TFComputeInstanceMachineTypeAllowlistConstraintV1
CONSTRAINT GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {cfhttpsendv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:cf-http-send-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/invalid_templates/cf_http_send_v1.yaml] [] []  []} {{{{CFHttpSendV1 []} 0xc000e1ebc8}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.cf.HttpSendV1

deny[{
	"msg": message,
	"details": metadata,
}] {
	response := http.send({
		"method": "GET",
		"url": "https://compute.googleapis.com/compute/v1/projects",
		"headers": {"Accept": "application/json", "Content-Type": "application/json"},
	})

	message := sprintf("I'm doing something forbidden! %s", [input.asset.name])
	metadata := {}
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {cfgcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/cf_gcp_storage_logging_template.yaml] [] []  []} {{{{CFGCPStorageLoggingConstraint []} 0xc000e1eec8}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

violation[{
	"msg": message,
	"details": metadata,
}] {
	asset := input.review
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := get_default(bucket, "logging", "default")
	destination_bucket := get_default(destination, "logBucket", "")
}

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
 	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
 []}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpbigquerydatasetlocationconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-bigquery-dataset-location-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_bq_dataset_location_v1.yaml] [] []  []} {{{{GCPBigQueryDatasetLocationConstraintV1 []} 0xc000f29110}} [{validation.gcp.forsetisecurity.org #

# Copyright 2019 Google LLC

#

# Licensed under the Apache License, Version 2.0 (the "License");

# you may not use this file except in compliance with the License.

# You may obtain a copy of the License at

#

#      http://www.apache.org/licenses/LICENSE-2.0

#

# Unless required by applicable law or agreed to in writing, software

# distributed under the License is distributed on an "AS IS" BASIS,

# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

# See the License for the specific language governing permissions and

# limitations under the License.

#

package templates.gcp.GCPBigQueryDatasetLocationConstraintV1

import data.lib.validator.gcp.lib as lib

############################################

# Find BigQuery Dataset Location Violations

############################################

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint

	lib.get_constraint_params(constraint, params)

	# Verify that resource is BigQuery dataset

	asset := input.asset

	asset.asset_type == "bigquery.googleapis.com/Dataset"

	# Check if resource is in exempt list

	exempt_list := params.exemptions

	matches := {asset.name} & cast_set(exempt_list)

	count(matches) == 0

	# Check that location is in allowlist/denylist

	target_locations := params.locations

	asset_location := asset.resource.data.location

	location_matches := {asset_location} & cast_set(target_locations)

	target_location_match_count(params.mode, desired_count)

	count(location_matches) == desired_count

	message := sprintf("%v is in a disallowed location.", [asset.name])

	metadata := {"location": asset_location}
}

#################

# Rule Utilities

#################

# Determine the overlap between locations under test and constraint

# By default (allowlist), we violate if there isn't overlap

target_location_match_count(mode) = 0 {
	mode != "denylist"
}

target_location_match_count(mode) = 1 {
	mode == "denylist"
}

#ENDINLINE

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-storage-logging validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_storage_logging_template.yaml] [] []  []} {{{{GCPStorageLoggingConstraint []} 0xc000f29fa8}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint
	asset := input.asset
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := object.get(bucket, "logging", "default")
	destination_bucket := object.get(destination, "logBucket", "")
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
Type of &{0xc0006b6730 0xc000e1e540 false} is *client.Backend
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
Type of &{0xc000e6a0c0 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c31c40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c31c20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c31c60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c31c00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00015f6c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00015f680 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00015f700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00015f5e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000e6b480 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000e6b460 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000e6b4a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000e6b440 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000e6b920 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000e6b900 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000e6b940 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000e6b8e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000940060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000940040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000940080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000940020 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000940720 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000940700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000940740 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009406e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000cad9a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000cad980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000cad9c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000cad960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004800c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000480060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000480100 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000480040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========GCP ValidateConstraint==========
2022/10/16 17:34:23 spec.match.target is deprecated and will be removed in a future release. Use spec.match.ancestries instead
2022/10/16 17:34:23 spec.match.exclude is deprecated and will be removed in a future release. Use spec.match.excludedAncestries instead
========== CFCLIENT ==========
&{0xc000e6a0c0 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[cfgcpstorageloggingconstraint:0xc00067f470 cfhttpsendv1:0xc000852000 gcpbigquerydatasetlocationconstraintv1:0xc00067ee40 gcpstorageloggingconstraint:0xc000d21b60] map[{constraints.gatekeeper.sh CFGCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/CFGCPStorageLoggingConstraint/require-storage-logging:0xc000e1e020] {constraints.gatekeeper.sh CFHttpSendV1}:map[] {constraints.gatekeeper.sh GCPBigQueryDatasetLocationConstraintV1}:map[] {constraints.gatekeeper.sh GCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/GCPStorageLoggingConstraint/require-storage-logging-xx:0xc000e1e028]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {k8srequiredlabels      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/k8srequiredlabels_template.yaml] [] []  []} {{{{K8sRequiredLabels []} 0xc000e1e710}} [{admission.k8s.gatekeeper.sh package k8srequiredlabels

violation[{"msg": msg, "details": {"missing_labels": missing}}] {
  provided := {label | input.review.object.metadata.labels[label]}
  required := {label | label := input.parameters.labels[_]}
  missing := required - provided
  count(missing) > 0
  msg := sprintf("you must provide labels: %v", [missing])
}
 []}]} {false []}}
Type of &{0xc000040410 0xc000e1e0d0 false} is *client.Backend
Type of &{0xc000abcba0 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc000abcba0 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[k8srequiredlabels:0xc000e0e150] map[{constraints.gatekeeper.sh K8sRequiredLabels}:map[/cluster/constraints.gatekeeper.sh/K8sRequiredLabels/namespace-cost-center-label:0xc0006eb368]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {tfcomputeinstancemachinetypeallowlistconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/tf_compute_instance_machine_type.yaml] [] []  []} {{{{TFComputeInstanceMachineTypeAllowlistConstraintV1 []} 0xc000e1e478}} [{validation.resourcechange.terraform.cloud.google.com #
# Copyright 2019 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.terraform.TFComputeInstanceMachineTypeAllowlistConstraintV1

violation[{
	"msg": message,
	"details": metadata,
}] {
  resource := input.review
  resource.type == "google_compute_instance"

  action_types := {x | x := resource.change.actions[_]}
  validated_action_types := {"create", "update"}
  count(action_types & validated_action_types) >=1

  instance := resource.change.after

  allowlist := object.get(input.parameters, "allowlist", [])
  allowed_machine_types := {n | n = allowlist[_]}

  machine_type := instance.machine_type

  is_machine_type_allowlisted := count({machine_type} - allowed_machine_types) == 0

  is_machine_type_allowlisted == false

  message := sprintf("Compute instance %s has interface has invalid machine_type: %s", [resource.address, machine_type])
  metadata := {"resource": resource.name}

}
 []}]} {false []}}
Type of &{0xc000123d10 0xc0006eb410 false} is *client.Backend
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
Type of &{0xc000e05920 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000e6b720 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000e6b740 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000e6bc20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000e6bc40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TFComputeInstanceMachineTypeAllowlistConstraintV1 metadata:map[annotations:map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/constraints/tf_compute_instance_mt_constraint.yaml] name:must-have-machine-type-e2-medium] spec:map[match:map[addresses:[**]] parameters:map[allowlist:[e2-medium]] severity:medium]]
INCLUDES
[**]
FOUND
true
ERR
<nil>
========== CFCLIENT ==========
&{0xc000e05920 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[tfcomputeinstancemachinetypeallowlistconstraintv1:0xc000651d70] map[{constraints.gatekeeper.sh TFComputeInstanceMachineTypeAllowlistConstraintV1}:map[/cluster/constraints.gatekeeper.sh/TFComputeInstanceMachineTypeAllowlistConstraintV1/must-have-machine-type-e2-medium:0xc000730e28]] [inventory]}
========== TEMPLATES ==========

Type of &{0xc0006f1130 0xc000730ed0 false} is *client.Backend
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
Type of &{0xc0009003c0 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc0009003c0 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]}
==========TF HandleReview==========
map[address:google_compute_instance.foobar change:map[actions:[create] after:map[advanced_machine_features:[] allow_stopping_for_update:<nil> attached_disk:[] boot_disk:[map[auto_delete:true disk_encryption_key_raw:<nil> initialize_params:[map[image:https://www.googleapis.com/compute/v1/projects/debian-cloud/global/images/debian-9-stretch-v20220118]] mode:READ_WRITE]] can_ip_forward:false deletion_protection:false description:<nil> desired_status:<nil> enable_display:<nil> hostname:<nil> labels:map[my_key:my_value my_other_key:my_other_value] machine_type:e2-high metadata:map[baz:qux foo:bar startup-script:echo Hello] metadata_startup_script:<nil> name:meep-merp network_interface:[map[access_config:[] alias_ip_range:[] ipv6_access_config:[] network:default nic_type:<nil> queue_count:<nil>]] resource_policies:<nil> scratch_disk:[] service_account:[] shielded_instance_config:[] tags:[bar foo] timeouts:<nil> zone:us-central1-a] after_unknown:map[] before:<nil>] mode:managed name:foobar provider_name:registry.terraform.io/hashicorp/google type:google_compute_instance]
==========TF HandleReview==========
map[address:google_compute_instance.foobar change:map[actions:[create] after:map[advanced_machine_features:[] allow_stopping_for_update:<nil> attached_disk:[] boot_disk:[map[auto_delete:true disk_encryption_key_raw:<nil> initialize_params:[map[image:https://www.googleapis.com/compute/v1/projects/debian-cloud/global/images/debian-9-stretch-v20220118]] mode:READ_WRITE]] can_ip_forward:false deletion_protection:false description:<nil> desired_status:<nil> enable_display:<nil> hostname:<nil> labels:map[my_key:my_value my_other_key:my_other_value] machine_type:e2-high metadata:map[baz:qux foo:bar startup-script:echo Hello] metadata_startup_script:<nil> name:meep-merp network_interface:[map[access_config:[] alias_ip_range:[] ipv6_access_config:[] network:default nic_type:<nil> queue_count:<nil>]] resource_policies:<nil> scratch_disk:[] service_account:[] shielded_instance_config:[] tags:[bar foo] timeouts:<nil> zone:us-central1-a] after_unknown:map[] before:<nil>] mode:managed name:foobar provider_name:registry.terraform.io/hashicorp/google type:google_compute_instance]
==========TF HandleViolation==========
&{Compute instance google_compute_instance.foobar has interface has invalid machine_type: e2-high map[details:map[resource:foobar]] 0xc000f01630 map[address:google_compute_instance.foobar change:map[actions:[create] after:map[advanced_machine_features:[] allow_stopping_for_update:<nil> attached_disk:[] boot_disk:[map[auto_delete:true disk_encryption_key_raw:<nil> initialize_params:[map[image:https://www.googleapis.com/compute/v1/projects/debian-cloud/global/images/debian-9-stretch-v20220118]] mode:READ_WRITE]] can_ip_forward:false deletion_protection:false description:<nil> desired_status:<nil> enable_display:<nil> hostname:<nil> labels:map[my_key:my_value my_other_key:my_other_value] machine_type:e2-high metadata:map[baz:qux foo:bar startup-script:echo Hello] metadata_startup_script:<nil> name:meep-merp network_interface:[map[access_config:[] alias_ip_range:[] ipv6_access_config:[] network:default nic_type:<nil> queue_count:<nil>]] resource_policies:<nil> scratch_disk:[] service_account:[] shielded_instance_config:[] tags:[bar foo] timeouts:<nil> zone:us-central1-a] after_unknown:map[] before:<nil>] mode:managed name:foobar provider_name:registry.terraform.io/hashicorp/google type:google_compute_instance] map[address:google_compute_instance.foobar change:map[actions:[create] after:map[advanced_machine_features:[] allow_stopping_for_update:<nil> attached_disk:[] boot_disk:[map[auto_delete:true disk_encryption_key_raw:<nil> initialize_params:[map[image:https://www.googleapis.com/compute/v1/projects/debian-cloud/global/images/debian-9-stretch-v20220118]] mode:READ_WRITE]] can_ip_forward:false deletion_protection:false description:<nil> desired_status:<nil> enable_display:<nil> hostname:<nil> labels:map[my_key:my_value my_other_key:my_other_value] machine_type:e2-high metadata:map[baz:qux foo:bar startup-script:echo Hello] metadata_startup_script:<nil> name:meep-merp network_interface:[map[access_config:[] alias_ip_range:[] ipv6_access_config:[] network:default nic_type:<nil> queue_count:<nil>]] resource_policies:<nil> scratch_disk:[] service_account:[] shielded_instance_config:[] tags:[bar foo] timeouts:<nil> zone:us-central1-a] after_unknown:map[] before:<nil>] mode:managed name:foobar provider_name:registry.terraform.io/hashicorp/google type:google_compute_instance] deny}
map[address:google_compute_instance.foobar change:map[actions:[create] after:map[advanced_machine_features:[] allow_stopping_for_update:<nil> attached_disk:[] boot_disk:[map[auto_delete:true disk_encryption_key_raw:<nil> initialize_params:[map[image:https://www.googleapis.com/compute/v1/projects/debian-cloud/global/images/debian-9-stretch-v20220118]] mode:READ_WRITE]] can_ip_forward:false deletion_protection:false description:<nil> desired_status:<nil> enable_display:<nil> hostname:<nil> labels:map[my_key:my_value my_other_key:my_other_value] machine_type:e2-high metadata:map[baz:qux foo:bar startup-script:echo Hello] metadata_startup_script:<nil> name:meep-merp network_interface:[map[access_config:[] alias_ip_range:[] ipv6_access_config:[] network:default nic_type:<nil> queue_count:<nil>]] resource_policies:<nil> scratch_disk:[] service_account:[] shielded_instance_config:[] tags:[bar foo] timeouts:<nil> zone:us-central1-a] after_unknown:map[] before:<nil>] mode:managed name:foobar provider_name:registry.terraform.io/hashicorp/google type:google_compute_instance]
=== RUN   TestReviewTFResourceChange/test_with_no_machine_type
TESTING CONFIGURATION
constraints.gatekeeper.sh/v1beta1, Kind=K8sRequiredLabels
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=CFGCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=GCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1beta1, Kind=TFComputeInstanceMachineTypeAllowlistConstraintV1
CONSTRAINT GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {cfhttpsendv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:cf-http-send-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/invalid_templates/cf_http_send_v1.yaml] [] []  []} {{{{CFHttpSendV1 []} 0xc000286cc8}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.cf.HttpSendV1

deny[{
	"msg": message,
	"details": metadata,
}] {
	response := http.send({
		"method": "GET",
		"url": "https://compute.googleapis.com/compute/v1/projects",
		"headers": {"Accept": "application/json", "Content-Type": "application/json"},
	})

	message := sprintf("I'm doing something forbidden! %s", [input.asset.name])
	metadata := {}
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {cfgcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/cf_gcp_storage_logging_template.yaml] [] []  []} {{{{CFGCPStorageLoggingConstraint []} 0xc000287178}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

violation[{
	"msg": message,
	"details": metadata,
}] {
	asset := input.review
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := get_default(bucket, "logging", "default")
	destination_bucket := get_default(destination, "logBucket", "")
}

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
 	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
 []}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpbigquerydatasetlocationconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-bigquery-dataset-location-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_bq_dataset_location_v1.yaml] [] []  []} {{{{GCPBigQueryDatasetLocationConstraintV1 []} 0xc000c5d8b8}} [{validation.gcp.forsetisecurity.org #

# Copyright 2019 Google LLC

#

# Licensed under the Apache License, Version 2.0 (the "License");

# you may not use this file except in compliance with the License.

# You may obtain a copy of the License at

#

#      http://www.apache.org/licenses/LICENSE-2.0

#

# Unless required by applicable law or agreed to in writing, software

# distributed under the License is distributed on an "AS IS" BASIS,

# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

# See the License for the specific language governing permissions and

# limitations under the License.

#

package templates.gcp.GCPBigQueryDatasetLocationConstraintV1

import data.lib.validator.gcp.lib as lib

############################################

# Find BigQuery Dataset Location Violations

############################################

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint

	lib.get_constraint_params(constraint, params)

	# Verify that resource is BigQuery dataset

	asset := input.asset

	asset.asset_type == "bigquery.googleapis.com/Dataset"

	# Check if resource is in exempt list

	exempt_list := params.exemptions

	matches := {asset.name} & cast_set(exempt_list)

	count(matches) == 0

	# Check that location is in allowlist/denylist

	target_locations := params.locations

	asset_location := asset.resource.data.location

	location_matches := {asset_location} & cast_set(target_locations)

	target_location_match_count(params.mode, desired_count)

	count(location_matches) == desired_count

	message := sprintf("%v is in a disallowed location.", [asset.name])

	metadata := {"location": asset_location}
}

#################

# Rule Utilities

#################

# Determine the overlap between locations under test and constraint

# By default (allowlist), we violate if there isn't overlap

target_location_match_count(mode) = 0 {
	mode != "denylist"
}

target_location_match_count(mode) = 1 {
	mode == "denylist"
}

#ENDINLINE

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-storage-logging validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_storage_logging_template.yaml] [] []  []} {{{{GCPStorageLoggingConstraint []} 0xc000c5cbd0}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint
	asset := input.asset
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := object.get(bucket, "logging", "default")
	destination_bucket := object.get(destination, "logBucket", "")
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
Type of &{0xc000b3d040 0xc000c5dbb8 false} is *client.Backend
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
Type of &{0xc000b0e540 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c31260 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c31240 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c31280 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c31220 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c31700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c316e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c31720 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c316c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00090b640 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00090b620 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00090b660 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00090b600 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00090bac0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00090baa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00090bae0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00090ba80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000e3ae80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000e3ae60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000e3aea0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000e3ae40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000e3ba20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000e3ba00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000e3ba40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000e3b9e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008cb6e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008cb6c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008cb700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008cb6a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008cbb80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008cbb60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008cbba0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008cbb40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========GCP ValidateConstraint==========
2022/10/16 17:34:23 spec.match.target is deprecated and will be removed in a future release. Use spec.match.ancestries instead
2022/10/16 17:34:23 spec.match.exclude is deprecated and will be removed in a future release. Use spec.match.excludedAncestries instead
========== CFCLIENT ==========
&{0xc000b0e540 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[cfgcpstorageloggingconstraint:0xc0009076b0 cfhttpsendv1:0xc00091ad50 gcpbigquerydatasetlocationconstraintv1:0xc0005f3230 gcpstorageloggingconstraint:0xc000715110] map[{constraints.gatekeeper.sh CFGCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/CFGCPStorageLoggingConstraint/require-storage-logging:0xc000015e20] {constraints.gatekeeper.sh CFHttpSendV1}:map[] {constraints.gatekeeper.sh GCPBigQueryDatasetLocationConstraintV1}:map[] {constraints.gatekeeper.sh GCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/GCPStorageLoggingConstraint/require-storage-logging-xx:0xc000015e28]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {k8srequiredlabels      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/k8srequiredlabels_template.yaml] [] []  []} {{{{K8sRequiredLabels []} 0xc000c5d318}} [{admission.k8s.gatekeeper.sh package k8srequiredlabels

violation[{"msg": msg, "details": {"missing_labels": missing}}] {
  provided := {label | input.review.object.metadata.labels[label]}
  required := {label | label := input.parameters.labels[_]}
  missing := required - provided
  count(missing) > 0
  msg := sprintf("you must provide labels: %v", [missing])
}
 []}]} {false []}}
Type of &{0xc000752410 0xc000015ed0 false} is *client.Backend
Type of &{0xc00075e020 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc00075e020 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[k8srequiredlabels:0xc0006385a0] map[{constraints.gatekeeper.sh K8sRequiredLabels}:map[/cluster/constraints.gatekeeper.sh/K8sRequiredLabels/namespace-cost-center-label:0xc000f01ce0]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {tfcomputeinstancemachinetypeallowlistconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/tf_compute_instance_machine_type.yaml] [] []  []} {{{{TFComputeInstanceMachineTypeAllowlistConstraintV1 []} 0xc000c5daf0}} [{validation.resourcechange.terraform.cloud.google.com #
# Copyright 2019 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.terraform.TFComputeInstanceMachineTypeAllowlistConstraintV1

violation[{
	"msg": message,
	"details": metadata,
}] {
  resource := input.review
  resource.type == "google_compute_instance"

  action_types := {x | x := resource.change.actions[_]}
  validated_action_types := {"create", "update"}
  count(action_types & validated_action_types) >=1

  instance := resource.change.after

  allowlist := object.get(input.parameters, "allowlist", [])
  allowed_machine_types := {n | n = allowlist[_]}

  machine_type := instance.machine_type

  is_machine_type_allowlisted := count({machine_type} - allowed_machine_types) == 0

  is_machine_type_allowlisted == false

  message := sprintf("Compute instance %s has interface has invalid machine_type: %s", [resource.address, machine_type])
  metadata := {"resource": resource.name}

}
 []}]} {false []}}
Type of &{0xc000b3caa0 0xc000f01e88 false} is *client.Backend
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
Type of &{0xc00075fde0 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c9d9a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c9d9c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c9df20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000c9df40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TFComputeInstanceMachineTypeAllowlistConstraintV1 metadata:map[annotations:map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/constraints/tf_compute_instance_mt_constraint.yaml] name:must-have-machine-type-e2-medium] spec:map[match:map[addresses:[**]] parameters:map[allowlist:[e2-medium]] severity:medium]]
INCLUDES
[**]
FOUND
true
ERR
<nil>
========== CFCLIENT ==========
&{0xc00075fde0 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[tfcomputeinstancemachinetypeallowlistconstraintv1:0xc00059d620] map[{constraints.gatekeeper.sh TFComputeInstanceMachineTypeAllowlistConstraintV1}:map[/cluster/constraints.gatekeeper.sh/TFComputeInstanceMachineTypeAllowlistConstraintV1/must-have-machine-type-e2-medium:0xc000e831c8]] [inventory]}
========== TEMPLATES ==========

Type of &{0xc0004d1e00 0xc000e83270 false} is *client.Backend
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
Type of &{0xc000cad0e0 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc000cad0e0 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]}
==========TF HandleReview==========
map[address:google_compute_instance.foobar change:map[actions:[create] after:map[advanced_machine_features:[] allow_stopping_for_update:<nil> attached_disk:[] boot_disk:[map[auto_delete:true disk_encryption_key_raw:<nil> initialize_params:[map[image:https://www.googleapis.com/compute/v1/projects/debian-cloud/global/images/debian-9-stretch-v20220118]] mode:READ_WRITE]] can_ip_forward:false deletion_protection:false description:<nil> desired_status:<nil> enable_display:<nil> hostname:<nil> labels:map[my_key:my_value my_other_key:my_other_value] machine_type: metadata:map[baz:qux foo:bar startup-script:echo Hello] metadata_startup_script:<nil> name:meep-merp network_interface:[map[access_config:[] alias_ip_range:[] ipv6_access_config:[] network:default nic_type:<nil> queue_count:<nil>]] resource_policies:<nil> scratch_disk:[] service_account:[] shielded_instance_config:[] tags:[bar foo] timeouts:<nil> zone:us-central1-a] after_unknown:map[] before:<nil>] mode:managed name:foobar provider_name:registry.terraform.io/hashicorp/google type:google_compute_instance]
==========TF HandleReview==========
map[address:google_compute_instance.foobar change:map[actions:[create] after:map[advanced_machine_features:[] allow_stopping_for_update:<nil> attached_disk:[] boot_disk:[map[auto_delete:true disk_encryption_key_raw:<nil> initialize_params:[map[image:https://www.googleapis.com/compute/v1/projects/debian-cloud/global/images/debian-9-stretch-v20220118]] mode:READ_WRITE]] can_ip_forward:false deletion_protection:false description:<nil> desired_status:<nil> enable_display:<nil> hostname:<nil> labels:map[my_key:my_value my_other_key:my_other_value] machine_type: metadata:map[baz:qux foo:bar startup-script:echo Hello] metadata_startup_script:<nil> name:meep-merp network_interface:[map[access_config:[] alias_ip_range:[] ipv6_access_config:[] network:default nic_type:<nil> queue_count:<nil>]] resource_policies:<nil> scratch_disk:[] service_account:[] shielded_instance_config:[] tags:[bar foo] timeouts:<nil> zone:us-central1-a] after_unknown:map[] before:<nil>] mode:managed name:foobar provider_name:registry.terraform.io/hashicorp/google type:google_compute_instance]
==========TF HandleViolation==========
&{Compute instance google_compute_instance.foobar has interface has invalid machine_type:  map[details:map[resource:foobar]] 0xc000f01e98 map[address:google_compute_instance.foobar change:map[actions:[create] after:map[advanced_machine_features:[] allow_stopping_for_update:<nil> attached_disk:[] boot_disk:[map[auto_delete:true disk_encryption_key_raw:<nil> initialize_params:[map[image:https://www.googleapis.com/compute/v1/projects/debian-cloud/global/images/debian-9-stretch-v20220118]] mode:READ_WRITE]] can_ip_forward:false deletion_protection:false description:<nil> desired_status:<nil> enable_display:<nil> hostname:<nil> labels:map[my_key:my_value my_other_key:my_other_value] machine_type: metadata:map[baz:qux foo:bar startup-script:echo Hello] metadata_startup_script:<nil> name:meep-merp network_interface:[map[access_config:[] alias_ip_range:[] ipv6_access_config:[] network:default nic_type:<nil> queue_count:<nil>]] resource_policies:<nil> scratch_disk:[] service_account:[] shielded_instance_config:[] tags:[bar foo] timeouts:<nil> zone:us-central1-a] after_unknown:map[] before:<nil>] mode:managed name:foobar provider_name:registry.terraform.io/hashicorp/google type:google_compute_instance] map[address:google_compute_instance.foobar change:map[actions:[create] after:map[advanced_machine_features:[] allow_stopping_for_update:<nil> attached_disk:[] boot_disk:[map[auto_delete:true disk_encryption_key_raw:<nil> initialize_params:[map[image:https://www.googleapis.com/compute/v1/projects/debian-cloud/global/images/debian-9-stretch-v20220118]] mode:READ_WRITE]] can_ip_forward:false deletion_protection:false description:<nil> desired_status:<nil> enable_display:<nil> hostname:<nil> labels:map[my_key:my_value my_other_key:my_other_value] machine_type: metadata:map[baz:qux foo:bar startup-script:echo Hello] metadata_startup_script:<nil> name:meep-merp network_interface:[map[access_config:[] alias_ip_range:[] ipv6_access_config:[] network:default nic_type:<nil> queue_count:<nil>]] resource_policies:<nil> scratch_disk:[] service_account:[] shielded_instance_config:[] tags:[bar foo] timeouts:<nil> zone:us-central1-a] after_unknown:map[] before:<nil>] mode:managed name:foobar provider_name:registry.terraform.io/hashicorp/google type:google_compute_instance] deny}
map[address:google_compute_instance.foobar change:map[actions:[create] after:map[advanced_machine_features:[] allow_stopping_for_update:<nil> attached_disk:[] boot_disk:[map[auto_delete:true disk_encryption_key_raw:<nil> initialize_params:[map[image:https://www.googleapis.com/compute/v1/projects/debian-cloud/global/images/debian-9-stretch-v20220118]] mode:READ_WRITE]] can_ip_forward:false deletion_protection:false description:<nil> desired_status:<nil> enable_display:<nil> hostname:<nil> labels:map[my_key:my_value my_other_key:my_other_value] machine_type: metadata:map[baz:qux foo:bar startup-script:echo Hello] metadata_startup_script:<nil> name:meep-merp network_interface:[map[access_config:[] alias_ip_range:[] ipv6_access_config:[] network:default nic_type:<nil> queue_count:<nil>]] resource_policies:<nil> scratch_disk:[] service_account:[] shielded_instance_config:[] tags:[bar foo] timeouts:<nil> zone:us-central1-a] after_unknown:map[] before:<nil>] mode:managed name:foobar provider_name:registry.terraform.io/hashicorp/google type:google_compute_instance]
=== RUN   TestReviewTFResourceChange/test_unaffected_resource_type
TESTING CONFIGURATION
constraints.gatekeeper.sh/v1beta1, Kind=K8sRequiredLabels
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=CFGCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=GCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1beta1, Kind=TFComputeInstanceMachineTypeAllowlistConstraintV1
CONSTRAINT GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {cfhttpsendv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:cf-http-send-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/invalid_templates/cf_http_send_v1.yaml] [] []  []} {{{{CFHttpSendV1 []} 0xc0006ea770}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.cf.HttpSendV1

deny[{
	"msg": message,
	"details": metadata,
}] {
	response := http.send({
		"method": "GET",
		"url": "https://compute.googleapis.com/compute/v1/projects",
		"headers": {"Accept": "application/json", "Content-Type": "application/json"},
	})

	message := sprintf("I'm doing something forbidden! %s", [input.asset.name])
	metadata := {}
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {cfgcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/cf_gcp_storage_logging_template.yaml] [] []  []} {{{{CFGCPStorageLoggingConstraint []} 0xc0006eaa70}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

violation[{
	"msg": message,
	"details": metadata,
}] {
	asset := input.review
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := get_default(bucket, "logging", "default")
	destination_bucket := get_default(destination, "logBucket", "")
}

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
 	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
 []}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpbigquerydatasetlocationconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-bigquery-dataset-location-v1 validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_bq_dataset_location_v1.yaml] [] []  []} {{{{GCPBigQueryDatasetLocationConstraintV1 []} 0xc000c5c4a0}} [{validation.gcp.forsetisecurity.org #

# Copyright 2019 Google LLC

#

# Licensed under the Apache License, Version 2.0 (the "License");

# you may not use this file except in compliance with the License.

# You may obtain a copy of the License at

#

#      http://www.apache.org/licenses/LICENSE-2.0

#

# Unless required by applicable law or agreed to in writing, software

# distributed under the License is distributed on an "AS IS" BASIS,

# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

# See the License for the specific language governing permissions and

# limitations under the License.

#

package templates.gcp.GCPBigQueryDatasetLocationConstraintV1

import data.lib.validator.gcp.lib as lib

############################################

# Find BigQuery Dataset Location Violations

############################################

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint

	lib.get_constraint_params(constraint, params)

	# Verify that resource is BigQuery dataset

	asset := input.asset

	asset.asset_type == "bigquery.googleapis.com/Dataset"

	# Check if resource is in exempt list

	exempt_list := params.exemptions

	matches := {asset.name} & cast_set(exempt_list)

	count(matches) == 0

	# Check that location is in allowlist/denylist

	target_locations := params.locations

	asset_location := asset.resource.data.location

	location_matches := {asset_location} & cast_set(target_locations)

	target_location_match_count(params.mode, desired_count)

	count(location_matches) == desired_count

	message := sprintf("%v is in a disallowed location.", [asset.name])

	metadata := {"location": asset_location}
}

#################

# Rule Utilities

#################

# Determine the overlap between locations under test and constraint

# By default (allowlist), we violate if there isn't overlap

target_location_match_count(mode) = 0 {
	mode != "denylist"
}

target_location_match_count(mode) = 1 {
	mode == "denylist"
}

#ENDINLINE

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
========== TEMPLATE ==========
&{{ } {gcpstorageloggingconstraint      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/originalName:gcp-storage-logging validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/gcp_storage_logging_template.yaml] [] []  []} {{{{GCPStorageLoggingConstraint []} 0xc000c5cef0}} [{validation.gcp.forsetisecurity.org #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.gcp.GCPStorageLoggingConstraint

deny[{
	"msg": message,
	"details": metadata,
}] {
	constraint := input.constraint
	asset := input.asset
	asset.asset_type == "storage.googleapis.com/Bucket"

	bucket := asset.resource.data
	destination := destination_bucket(bucket)
	destination == ""

	message := sprintf("%v does not have the required logging destination.", [asset.name])
	metadata := {
		"destination_bucket": destination,
		"resource": asset.name,
	}
}

###########################
# Rule Utilities
###########################
destination_bucket(bucket) = destination_bucket {
	destination := object.get(bucket, "logging", "default")
	destination_bucket := object.get(destination, "logBucket", "")
}

violation[{"msg": message, "details": metadata}] {
	deny[{"details": metadata, "msg": message}] with input as {"asset": input.review, "constraint": {"spec": {"parameters": input.parameters}}}
}
 [#
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# Function to fetch the constraint spec
# Usage:
# get_constraint_params(constraint, params)

get_constraint_params(constraint) = params {
	params := constraint.spec.parameters
}

# Function to fetch constraint info
# Usage:
# get_constraint_info(constraint, info)

get_constraint_info(constraint) = info {
	info := {
		"name": constraint.metadata.name,
		"kind": constraint.kind,
	}
}
 #
# Copyright 2018 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package lib.validator.gcp.lib

# has_field returns whether an object has a field
has_field(object, field) {
	object[field]
}

# False is a tricky special case, as false responses would create an undefined document unless
# they are explicitly tested for
has_field(object, field) {
	object[field] == false
}

has_field(object, field) = false {
	not object[field]
	not object[field] == false
}

# get_default returns the value of an object's field or the provided default value.
# It avoids creating an undefined state when trying to access an object attribute that does
# not exist
get_default(object, field, _default) = output {
	has_field(object, field)
	output = object[field]
}

get_default(object, field, _default) = output {
	has_field(object, field) == false
	output = _default
}
]}]} {false []}}
Type of &{0xc0006b6cd0 0xc000c5c440 false} is *client.Backend
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP Library==========
==========GCP GetName==========
==========GCP GetName==========
Type of &{0xc0009dfa60 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006458e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006458c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000645900 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006458a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000645d60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000645d40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000645d80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000645d20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0ca00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0c9e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0ca20 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0c9c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0cea0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0ce80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0cec0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a0ce60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000912060 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000912040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000912080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000912020 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000912720 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000912700 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000912740 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009126e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a84080 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a84040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a840a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a84000 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[ancestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a84680 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} exclude:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a84660 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAncestries:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a846a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} target:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a84640 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END GCP SCHEMA==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP GetName==========
==========GCP ValidateConstraint==========
==========GCP ValidateConstraint==========
2022/10/16 17:34:23 spec.match.target is deprecated and will be removed in a future release. Use spec.match.ancestries instead
2022/10/16 17:34:23 spec.match.exclude is deprecated and will be removed in a future release. Use spec.match.excludedAncestries instead
========== CFCLIENT ==========
&{0xc0009dfa60 map[validation.gcp.forsetisecurity.org:0x2789288] {{0 0} 0 0 0 0} map[cfgcpstorageloggingconstraint:0xc00090f9b0 cfhttpsendv1:0xc00063f2f0 gcpbigquerydatasetlocationconstraintv1:0xc000a31890 gcpstorageloggingconstraint:0xc000eaaf90] map[{constraints.gatekeeper.sh CFGCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/CFGCPStorageLoggingConstraint/require-storage-logging:0xc0006ea010] {constraints.gatekeeper.sh CFHttpSendV1}:map[] {constraints.gatekeeper.sh GCPBigQueryDatasetLocationConstraintV1}:map[] {constraints.gatekeeper.sh GCPStorageLoggingConstraint}:map[/cluster/constraints.gatekeeper.sh/GCPStorageLoggingConstraint/require-storage-logging-xx:0xc0006ea050]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {k8srequiredlabels      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/k8srequiredlabels_template.yaml] [] []  []} {{{{K8sRequiredLabels []} 0xc000c5d638}} [{admission.k8s.gatekeeper.sh package k8srequiredlabels

violation[{"msg": msg, "details": {"missing_labels": missing}}] {
  provided := {label | input.review.object.metadata.labels[label]}
  required := {label | label := input.parameters.labels[_]}
  missing := required - provided
  count(missing) > 0
  msg := sprintf("you must provide labels: %v", [missing])
}
 []}]} {false []}}
Type of &{0xc000ebc550 0xc0006ea120 false} is *client.Backend
Type of &{0xc000b59200 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc000b59200 map[admission.k8s.gatekeeper.sh:0x2789288] {{0 0} 0 0 0 0} map[k8srequiredlabels:0xc000d78f30] map[{constraints.gatekeeper.sh K8sRequiredLabels}:map[/cluster/constraints.gatekeeper.sh/K8sRequiredLabels/namespace-cost-center-label:0xc000c5d058]] [inventory]}
========== TEMPLATES ==========

========== TEMPLATE ==========
&{{ } {tfcomputeinstancemachinetypeallowlistconstraintv1      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[] map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/templates/tf_compute_instance_machine_type.yaml] [] []  []} {{{{TFComputeInstanceMachineTypeAllowlistConstraintV1 []} 0xc000c5c368}} [{validation.resourcechange.terraform.cloud.google.com #
# Copyright 2019 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

package templates.terraform.TFComputeInstanceMachineTypeAllowlistConstraintV1

violation[{
	"msg": message,
	"details": metadata,
}] {
  resource := input.review
  resource.type == "google_compute_instance"

  action_types := {x | x := resource.change.actions[_]}
  validated_action_types := {"create", "update"}
  count(action_types & validated_action_types) >=1

  instance := resource.change.after

  allowlist := object.get(input.parameters, "allowlist", [])
  allowed_machine_types := {n | n = allowlist[_]}

  machine_type := instance.machine_type

  is_machine_type_allowlisted := count({machine_type} - allowed_machine_types) == 0

  is_machine_type_allowlisted == false

  message := sprintf("Compute instance %s has interface has invalid machine_type: %s", [resource.address, machine_type])
  metadata := {"resource": resource.name}

}
 []}]} {false []}}
Type of &{0xc000040be0 0xc000c5d100 false} is *client.Backend
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
Type of &{0xc000d86720 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009df640 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009df680 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dfa40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0009dfa80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TFComputeInstanceMachineTypeAllowlistConstraintV1 metadata:map[annotations:map[validation.gcp.forsetisecurity.org/yamlpath:../../test/cf/constraints/tf_compute_instance_mt_constraint.yaml] name:must-have-machine-type-e2-medium] spec:map[match:map[addresses:[**]] parameters:map[allowlist:[e2-medium]] severity:medium]]
INCLUDES
[**]
FOUND
true
ERR
<nil>
========== CFCLIENT ==========
&{0xc000d86720 map[validation.resourcechange.terraform.cloud.google.com:0x2789288] {{0 0} 0 0 0 0} map[tfcomputeinstancemachinetypeallowlistconstraintv1:0xc000db1800] map[{constraints.gatekeeper.sh TFComputeInstanceMachineTypeAllowlistConstraintV1}:map[/cluster/constraints.gatekeeper.sh/TFComputeInstanceMachineTypeAllowlistConstraintV1/must-have-machine-type-e2-medium:0xc00042fc30]] [inventory]}
========== TEMPLATES ==========

Type of &{0xc000b3c3c0 0xc00042fd08 false} is *client.Backend
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM GetName==========
==========ARM Library==========
==========ARM GetName==========
==========ARM GetName==========
Type of &{0xc000765b00 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]} is *client.Client
========== CFCLIENT ==========
&{0xc000765b00 map[arm.policy.azure.com:0x2789288] {{0 0} 0 0 0 0} map[] map[] [inventory]}
==========TF HandleReview==========
map[address:google_kms_key_ring.test change:map[actions:[create] after:map[location:global name:keyring-example timeouts:<nil>] after_unknown:map[id:true project:true self_link:true] before:<nil>] mode:managed name:test provider_name:google type:google_kms_key_ring]
==========TF HandleReview==========
map[address:google_kms_key_ring.test change:map[actions:[create] after:map[location:global name:keyring-example timeouts:<nil>] after_unknown:map[id:true project:true self_link:true] before:<nil>] mode:managed name:test provider_name:google type:google_kms_key_ring]
--- PASS: TestReviewTFResourceChange (0.34s)
    --- PASS: TestReviewTFResourceChange/test_base_valid_scenario (0.08s)
    --- PASS: TestReviewTFResourceChange/test_base_invalid_machine_type (0.09s)
    --- PASS: TestReviewTFResourceChange/test_with_no_machine_type (0.08s)
    --- PASS: TestReviewTFResourceChange/test_unaffected_resource_type (0.08s)
PASS
ok  	github.com/GoogleCloudPlatform/config-validator/pkg/gcv	(cached)
=== RUN   TestFixLegacyMatcher
=== RUN   TestFixLegacyMatcher/organization/*
=== RUN   TestFixLegacyMatcher/folder/*
=== RUN   TestFixLegacyMatcher/project/*
=== RUN   TestFixLegacyMatcher/organization/*/folder/*
=== RUN   TestFixLegacyMatcher/organization/*/project/*
=== RUN   TestFixLegacyMatcher/organization/*/folder/*/project/*
--- PASS: TestFixLegacyMatcher (0.00s)
    --- PASS: TestFixLegacyMatcher/organization/* (0.00s)
    --- PASS: TestFixLegacyMatcher/folder/* (0.00s)
    --- PASS: TestFixLegacyMatcher/project/* (0.00s)
    --- PASS: TestFixLegacyMatcher/organization/*/folder/* (0.00s)
    --- PASS: TestFixLegacyMatcher/organization/*/project/* (0.00s)
    --- PASS: TestFixLegacyMatcher/organization/*/folder/*/project/* (0.00s)
=== RUN   TestNewConfiguration
TESTING CONFIGURATION
constraints.gatekeeper.sh/v1beta1, Kind=K8sRequiredLabels
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=CFGCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1alpha1, Kind=GCPStorageLoggingConstraint
CONSTRAINT GROUP
constraints.gatekeeper.sh/v1beta1, Kind=TFComputeInstanceMachineTypeAllowlistConstraintV1
CONSTRAINT GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1alpha1, Kind=ConstraintTemplate
TEMPLATE GROUP
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
--- PASS: TestNewConfiguration (0.06s)
=== RUN   TestLegacyTemplateConversion
=== RUN   TestLegacyTemplateConversion/legacy_template_with_schema
=== RUN   TestLegacyTemplateConversion/legacy_template_no_schema
--- PASS: TestLegacyTemplateConversion (0.01s)
    --- PASS: TestLegacyTemplateConversion/legacy_template_with_schema (0.00s)
    --- PASS: TestLegacyTemplateConversion/legacy_template_no_schema (0.01s)
=== RUN   TestLegacyConstraintConversion
--- PASS: TestLegacyConstraintConversion (0.00s)
=== RUN   TestLocalPath
=== RUN   TestLocalPath/no_predicates
=== RUN   TestLocalPath/yaml_only
=== RUN   TestLocalPath/rego_only
=== RUN   TestLocalPath/no_files
=== RUN   TestLocalPath/single_file
=== RUN   TestLocalPath/dir_/_file_does_not_exist
--- PASS: TestLocalPath (0.00s)
    --- PASS: TestLocalPath/no_predicates (0.00s)
    --- PASS: TestLocalPath/yaml_only (0.00s)
    --- PASS: TestLocalPath/rego_only (0.00s)
    --- PASS: TestLocalPath/no_files (0.00s)
    --- PASS: TestLocalPath/single_file (0.00s)
    --- PASS: TestLocalPath/dir_/_file_does_not_exist (0.00s)
=== RUN   TestGCSPath
    file_test.go:139: GCS unit testing is skipped by default since it requries a functioning client to work.
--- SKIP: TestGCSPath (0.00s)
PASS
ok  	github.com/GoogleCloudPlatform/config-validator/pkg/gcv/configs	(cached)
=== RUN   TestCategorizeYAMLFile
=== RUN   TestCategorizeYAMLFile/empty_file
=== RUN   TestCategorizeYAMLFile/invalid_yaml
=== RUN   TestCategorizeYAMLFile/invalid_template_kind
=== RUN   TestCategorizeYAMLFile/invalid_template_api_version
=== RUN   TestCategorizeYAMLFile/invalid_template_api_version_(using_constraint_kind)
=== RUN   TestCategorizeYAMLFile/invalid_template_invalid_target
=== RUN   TestCategorizeYAMLFile/invalid_template_no_generated_kind
=== RUN   TestCategorizeYAMLFile/legacy_template_without_target_list
=== RUN   TestCategorizeYAMLFile/constraint_template
=== RUN   TestCategorizeYAMLFile/invalid_constraint_uses_template_kind
=== RUN   TestCategorizeYAMLFile/invalid_constraint_uses_template_api_version
=== RUN   TestCategorizeYAMLFile/invalid_constraint_uses_invalid_api_version
=== RUN   TestCategorizeYAMLFile/invalid_constraint_no_kind
=== RUN   TestCategorizeYAMLFile/invalid_constraint_no_metadata
=== RUN   TestCategorizeYAMLFile/invalid_constraint_no_api_version
=== RUN   TestCategorizeYAMLFile/parse_constraint
--- PASS: TestCategorizeYAMLFile (0.00s)
    --- PASS: TestCategorizeYAMLFile/empty_file (0.00s)
    --- PASS: TestCategorizeYAMLFile/invalid_yaml (0.00s)
    --- PASS: TestCategorizeYAMLFile/invalid_template_kind (0.00s)
    --- PASS: TestCategorizeYAMLFile/invalid_template_api_version (0.00s)
    --- PASS: TestCategorizeYAMLFile/invalid_template_api_version_(using_constraint_kind) (0.00s)
    --- PASS: TestCategorizeYAMLFile/invalid_template_invalid_target (0.00s)
    --- PASS: TestCategorizeYAMLFile/invalid_template_no_generated_kind (0.00s)
    --- PASS: TestCategorizeYAMLFile/legacy_template_without_target_list (0.00s)
    --- PASS: TestCategorizeYAMLFile/constraint_template (0.00s)
    --- PASS: TestCategorizeYAMLFile/invalid_constraint_uses_template_kind (0.00s)
    --- PASS: TestCategorizeYAMLFile/invalid_constraint_uses_template_api_version (0.00s)
    --- PASS: TestCategorizeYAMLFile/invalid_constraint_uses_invalid_api_version (0.00s)
    --- PASS: TestCategorizeYAMLFile/invalid_constraint_no_kind (0.00s)
    --- PASS: TestCategorizeYAMLFile/invalid_constraint_no_metadata (0.00s)
    --- PASS: TestCategorizeYAMLFile/invalid_constraint_no_api_version (0.00s)
    --- PASS: TestCategorizeYAMLFile/parse_constraint (0.00s)
PASS
ok  	github.com/GoogleCloudPlatform/config-validator/pkg/gcv/oldconfigs	(cached)
?   	github.com/GoogleCloudPlatform/config-validator/pkg/multierror	[no test files]
?   	github.com/GoogleCloudPlatform/config-validator/pkg/targettesting	[no test files]
=== RUN   TestTargetHandler
==========TF GetName==========
========== newConstraintTemplate ==========
validation.resourcechange.terraform.cloud.google.com

package testconstraint

violation[{"msg": msg}] {
	input.parameters.kind == "VirtualMachine" 
    input.parameters.type == "Microsoft.Compute/virtualMachines"
	msg := input.parameters.msg
}

TESTING CONFIGURATION
templates.gatekeeper.sh/v1beta1, Kind=ConstraintTemplate
TEMPLATE GROUP
BETA VERSION
=== RUN   TestTargetHandler/matching_constraints
==========TESTING: Basic==========
=== RUN   TestTargetHandler/matching_constraints/Basic
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007fd000 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007fd020 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007fd320 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007fd340 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TestConstraint metadata:map[name:testconstraint] spec:map[parameters:map[kind:VirtualMachine msg:it matched type:Microsoft.Compute/virtualMachines]]]
INCLUDES
[]
FOUND
false
ERR
<nil>
========== REVIEW OBJ ==========
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TF HandleReview==========
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TF HandleViolation==========
&{it matched map[details:map[]] 0xc000521a98 map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type] map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type] deny}
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TESTING: Basic 2 (wildcard)==========
=== RUN   TestTargetHandler/matching_constraints/Basic_2_(wildcard)
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ac7ca0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ac7cc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ac7fa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000ac7fc0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TestConstraint metadata:map[name:testconstraint] spec:map[match:map[] parameters:map[kind:VirtualMachine msg:it matched type:Microsoft.Compute/virtualMachines]]]
INCLUDES
[]
FOUND
false
ERR
<nil>
========== REVIEW OBJ ==========
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TF HandleReview==========
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TF HandleViolation==========
&{it matched map[details:map[]] 0xc0002947d0 map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type] map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type] deny}
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TESTING: Only match once.==========
=== RUN   TestTargetHandler/matching_constraints/Only_match_once.
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00029fa60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00029fa80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00029fd80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00029fda0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TestConstraint metadata:map[name:testconstraint] spec:map[match:map[addresses:[** *.*]] parameters:map[kind:VirtualMachine msg:it matched type:Microsoft.Compute/virtualMachines]]]
INCLUDES
[** *.*]
FOUND
true
ERR
<nil>
========== REVIEW OBJ ==========
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TF HandleReview==========
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TF HandleViolation==========
&{it matched map[details:map[]] 0xc000520e80 map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type] map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type] deny}
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TESTING: Match on exact ID==========
=== RUN   TestTargetHandler/matching_constraints/Match_on_exact_ID
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00026de40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00026de60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005ac140 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005ac160 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TestConstraint metadata:map[name:testconstraint] spec:map[match:map[addresses:[google_compute_global_forwarding_rule.test]] parameters:map[kind:VirtualMachine msg:it matched type:Microsoft.Compute/virtualMachines]]]
INCLUDES
[google_compute_global_forwarding_rule.test]
FOUND
true
ERR
<nil>
========== REVIEW OBJ ==========
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TF HandleReview==========
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TF HandleViolation==========
&{it matched map[details:map[]] 0xc000bb7760 map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type] map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type] deny}
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TESTING: Does not match address for nested module==========
=== RUN   TestTargetHandler/matching_constraints/Does_not_match_address_for_nested_module
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004ed180 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004ed1a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004ed4a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0004ed4c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TestConstraint metadata:map[name:testconstraint] spec:map[match:map[addresses:[google_compute_global_forwarding_rule.test]] parameters:map[kind:VirtualMachine msg:it matched type:Microsoft.Compute/virtualMachines]]]
INCLUDES
[google_compute_global_forwarding_rule.test]
FOUND
true
ERR
<nil>
========== REVIEW OBJ ==========
map[address:module.abc.google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TF HandleReview==========
map[address:module.abc.google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TESTING: name wildcard match==========
=== RUN   TestTargetHandler/matching_constraints/name_wildcard_match
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000618880 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006189e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000618ce0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000618d00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TestConstraint metadata:map[name:testconstraint] spec:map[match:map[addresses:[google_compute_global_forwarding_rule.*]] parameters:map[kind:VirtualMachine msg:it matched type:Microsoft.Compute/virtualMachines]]]
INCLUDES
[google_compute_global_forwarding_rule.*]
FOUND
true
ERR
<nil>
========== REVIEW OBJ ==========
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TF HandleReview==========
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TF HandleViolation==========
&{it matched map[details:map[]] 0xc000542e58 map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type] map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type] deny}
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TESTING: module wildcard match==========
=== RUN   TestTargetHandler/matching_constraints/module_wildcard_match
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00052c4a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00052c4c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00052c7a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00052c7c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TestConstraint metadata:map[name:testconstraint] spec:map[match:map[addresses:[**.google_compute_global_forwarding_rule.*]] parameters:map[kind:VirtualMachine msg:it matched type:Microsoft.Compute/virtualMachines]]]
INCLUDES
[**.google_compute_global_forwarding_rule.*]
FOUND
true
ERR
<nil>
========== REVIEW OBJ ==========
map[address:module.abc.google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TF HandleReview==========
map[address:module.abc.google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TF HandleViolation==========
&{it matched map[details:map[]] 0xc000015bd0 map[address:module.abc.google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type] map[address:module.abc.google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type] deny}
map[address:module.abc.google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TESTING: root wildcard match==========
=== RUN   TestTargetHandler/matching_constraints/root_wildcard_match
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007dc020 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007dc040 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b20e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008b2100 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TestConstraint metadata:map[name:testconstraint] spec:map[match:map[addresses:[**.google_compute_global_forwarding_rule.*]] parameters:map[kind:VirtualMachine msg:it matched type:Microsoft.Compute/virtualMachines]]]
INCLUDES
[**.google_compute_global_forwarding_rule.*]
FOUND
true
ERR
<nil>
========== REVIEW OBJ ==========
map[address:root.google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TF HandleReview==========
map[address:root.google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TF HandleViolation==========
&{it matched map[details:map[]] 0xc000542e90 map[address:root.google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type] map[address:root.google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type] deny}
map[address:root.google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TESTING: root doesn't match module==========
=== RUN   TestTargetHandler/matching_constraints/root_doesn't_match_module
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0002a5fe0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000922a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000092980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0000929a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TestConstraint metadata:map[name:testconstraint] spec:map[match:map[addresses:[module.one.google_compute_global_forwarding_rule.*]] parameters:map[kind:VirtualMachine msg:it matched type:Microsoft.Compute/virtualMachines]]]
INCLUDES
[module.one.google_compute_global_forwarding_rule.*]
FOUND
true
ERR
<nil>
========== REVIEW OBJ ==========
map[address:root.google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TF HandleReview==========
map[address:root.google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TESTING: exclude all==========
=== RUN   TestTargetHandler/matching_constraints/exclude_all
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00029e780 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00029e7a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00029eaa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00029eac0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TestConstraint metadata:map[name:testconstraint] spec:map[match:map[excludedAddresses:[** *.*]] parameters:map[kind:VirtualMachine msg:it matched type:Microsoft.Compute/virtualMachines]]]
INCLUDES
[]
FOUND
false
ERR
<nil>
========== REVIEW OBJ ==========
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TF HandleReview==========
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TESTING: exclude on exact ID==========
=== RUN   TestTargetHandler/matching_constraints/exclude_on_exact_ID
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00029e6a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00029e6c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00029e9c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00029e9e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TestConstraint metadata:map[name:testconstraint] spec:map[match:map[excludedAddresses:[google_compute_global_forwarding_rule.test]] parameters:map[kind:VirtualMachine msg:it matched type:Microsoft.Compute/virtualMachines]]]
INCLUDES
[]
FOUND
false
ERR
<nil>
========== REVIEW OBJ ==========
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TF HandleReview==========
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TESTING: exclude does not match org for nested module==========
=== RUN   TestTargetHandler/matching_constraints/exclude_does_not_match_org_for_nested_module
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005672c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005672e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005675e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000567600 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TestConstraint metadata:map[name:testconstraint] spec:map[match:map[excludedAddresses:[google_compute_global_forwarding_rule.test]] parameters:map[kind:VirtualMachine msg:it matched type:Microsoft.Compute/virtualMachines]]]
INCLUDES
[]
FOUND
false
ERR
<nil>
========== REVIEW OBJ ==========
map[address:module.abc.google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TF HandleReview==========
map[address:module.abc.google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TF HandleViolation==========
&{it matched map[details:map[]] 0xc000520380 map[address:module.abc.google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type] map[address:module.abc.google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type] deny}
map[address:module.abc.google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TESTING: exclude name wildcard match==========
=== RUN   TestTargetHandler/matching_constraints/exclude_name_wildcard_match
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000788c80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000788ca0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000788f80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000788fa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TestConstraint metadata:map[name:testconstraint] spec:map[match:map[excludedAddresses:[google_compute_global_forwarding_rule.*]] parameters:map[kind:VirtualMachine msg:it matched type:Microsoft.Compute/virtualMachines]]]
INCLUDES
[]
FOUND
false
ERR
<nil>
========== REVIEW OBJ ==========
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TF HandleReview==========
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TESTING: exclude module wildcard match==========
=== RUN   TestTargetHandler/matching_constraints/exclude_module_wildcard_match
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007b4480 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007b44a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077c1c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00077c1e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TestConstraint metadata:map[name:testconstraint] spec:map[match:map[excludedAddresses:[**.google_compute_global_forwarding_rule.*]] parameters:map[kind:VirtualMachine msg:it matched type:Microsoft.Compute/virtualMachines]]]
INCLUDES
[]
FOUND
false
ERR
<nil>
========== REVIEW OBJ ==========
map[address:module.abc.google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TF HandleReview==========
map[address:module.abc.google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:registry.terraform.io/hashicorp/google type:test-asset-type]
==========TESTING: nested spaces==========
=== RUN   TestTargetHandler/matching_constraints/nested_spaces
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00086c640 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00086c660 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00086c960 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00086c980 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TestConstraint metadata:map[name:testconstraint] spec:map[match:map[addresses:[**.* *.*]] parameters:map[kind:VirtualMachine msg:it matched type:Microsoft.Compute/virtualMachines]]]
INCLUDES
[**.* *.*]
FOUND
true
ERR
<nil>
==========TESTING: nested special characters==========
=== RUN   TestTargetHandler/matching_constraints/nested_special_characters
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000794100 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000794120 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000794460 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000794480 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TestConstraint metadata:map[name:testconstraint] spec:map[match:map[addresses:[**$$]] parameters:map[kind:VirtualMachine msg:it matched type:Microsoft.Compute/virtualMachines]]]
INCLUDES
[**$$]
FOUND
true
ERR
<nil>
==========TESTING: exclude error - nested spaces==========
=== RUN   TestTargetHandler/matching_constraints/exclude_error_-_nested_spaces
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000176f80 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000176fa0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001772a0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0001772c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TestConstraint metadata:map[name:testconstraint] spec:map[match:map[excludedAddresses:[**. * *.*]] parameters:map[kind:VirtualMachine msg:it matched type:Microsoft.Compute/virtualMachines]]]
INCLUDES
[]
FOUND
false
ERR
<nil>
==========TESTING: exclude error - nested special characters==========
=== RUN   TestTargetHandler/matching_constraints/exclude_error_-_nested_special_characters
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000afc660 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000afc680 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008561c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0008561e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TestConstraint metadata:map[name:testconstraint] spec:map[match:map[excludedAddresses:[**$$]] parameters:map[kind:VirtualMachine msg:it matched type:Microsoft.Compute/virtualMachines]]]
INCLUDES
[]
FOUND
false
ERR
<nil>
==========TESTING: provider contains google==========
=== RUN   TestTargetHandler/matching_constraints/provider_contains_google
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007345c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007345e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007348e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000734900 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TestConstraint metadata:map[name:testconstraint] spec:map[parameters:map[kind:VirtualMachine msg:it matched type:Microsoft.Compute/virtualMachines]]]
INCLUDES
[]
FOUND
false
ERR
<nil>
========== REVIEW OBJ ==========
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:google type:test-asset-type]
==========TF HandleReview==========
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:google type:test-asset-type]
==========TF HandleViolation==========
&{it matched map[details:map[]] 0xc000294ed8 map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:google type:test-asset-type] map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:google type:test-asset-type] deny}
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:google type:test-asset-type]
==========TESTING: provider doesn't contain google==========
=== RUN   TestTargetHandler/matching_constraints/provider_doesn't_contain_google
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00031f7e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00029e000 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00029e300 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc00029e320 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TestConstraint metadata:map[name:testconstraint] spec:map[parameters:map[kind:VirtualMachine msg:it matched type:Microsoft.Compute/virtualMachines]]]
INCLUDES
[]
FOUND
false
ERR
<nil>
========== REVIEW OBJ ==========
map[address:whatever_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:whatever type:test-asset-type]
==========TF HandleReview==========
map[address:whatever_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:whatever type:test-asset-type]
==========TF HandleViolation==========
&{it matched map[details:map[]] 0xc000115210 map[address:whatever_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:whatever type:test-asset-type] map[address:whatever_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:whatever type:test-asset-type] deny}
map[address:whatever_compute_global_forwarding_rule.test change:map[] name:test-name provider_name:whatever type:test-asset-type]
==========TESTING: provider block missing==========
=== RUN   TestTargetHandler/matching_constraints/provider_block_missing
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005f8be0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005f8c00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005f8ee0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005f8f00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF ValidateConstraint==========
map[apiVersion:constraints.gatekeeper.sh/v1beta1 kind:TestConstraint metadata:map[name:testconstraint] spec:map[parameters:map[kind:VirtualMachine msg:it matched type:Microsoft.Compute/virtualMachines]]]
INCLUDES
[]
FOUND
false
ERR
<nil>
========== REVIEW OBJ ==========
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name type:test-asset-type]
==========TF HandleReview==========
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name type:test-asset-type]
==========TF HandleViolation==========
&{it matched map[details:map[]] 0xc00021bb90 map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name type:test-asset-type] map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name type:test-asset-type] deny}
map[address:google_compute_global_forwarding_rule.test change:map[] name:test-name type:test-asset-type]
==========TESTING: Bad target type==========
=== RUN   TestTargetHandler/matching_constraints/Bad_target_type
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005e7600 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0005e7620 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a681c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a681e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TESTING: Bad target item type==========
=== RUN   TestTargetHandler/matching_constraints/Bad_target_item_type
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007bdc40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007bdc60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a26160 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000a26180 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TESTING: Bad exclude type==========
=== RUN   TestTargetHandler/matching_constraints/Bad_exclude_type
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000739ce0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000739d00 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006c21c0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0006c21e0 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TESTING: Bad exclude item type==========
=== RUN   TestTargetHandler/matching_constraints/Bad_exclude_item_type
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF Library==========
==========TF GetName==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000689e40 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc000689e60 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF SCHEMA==========
{  <nil>  object false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] <nil> [] [] [] <nil> map[addresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007be160 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>} excludedAddresses:{  <nil>  array false   <nil> <nil> false <nil> false <nil> <nil>  <nil> <nil> false <nil> [] <nil> <nil> [] 0xc0007be180 [] [] [] <nil> map[] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}] <nil> map[] map[] <nil> map[] <nil> <nil> <nil> false false [] <nil> <nil>}
==========END TF SCHEMA==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
==========TF GetName==========
--- PASS: TestTargetHandler (0.28s)
    --- PASS: TestTargetHandler/matching_constraints (0.27s)
        --- PASS: TestTargetHandler/matching_constraints/Basic (0.02s)
        --- PASS: TestTargetHandler/matching_constraints/Basic_2_(wildcard) (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/Only_match_once. (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/Match_on_exact_ID (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/Does_not_match_address_for_nested_module (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/name_wildcard_match (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/module_wildcard_match (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/root_wildcard_match (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/root_doesn't_match_module (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/exclude_all (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/exclude_on_exact_ID (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/exclude_does_not_match_org_for_nested_module (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/exclude_name_wildcard_match (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/exclude_module_wildcard_match (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/nested_spaces (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/nested_special_characters (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/exclude_error_-_nested_spaces (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/exclude_error_-_nested_special_characters (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/provider_contains_google (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/provider_doesn't_contain_google (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/provider_block_missing (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/Bad_target_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/Bad_target_item_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/Bad_exclude_type (0.01s)
        --- PASS: TestTargetHandler/matching_constraints/Bad_exclude_item_type (0.01s)
PASS
ok  	github.com/GoogleCloudPlatform/config-validator/pkg/tftarget	0.296s
